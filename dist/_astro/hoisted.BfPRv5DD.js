import"./Footer.astro_astro_type_script_index_0_lang.CYGdQqJr.js";import"https://unpkg.com/@supabase/supabase-js@2";console.log("Order flow test page loaded");function e(t){const n=document.getElementById("test-results");if(n){const a=document.createElement("p");a.textContent=`[${new Date().toLocaleTimeString()}] ${t}`,n.appendChild(a),n.scrollTop=n.scrollHeight}}function o(){const t=document.getElementById("status-text"),n=document.getElementById("user-info"),a=document.getElementById("auth-manager-status"),s=window.globalAuthManager||window.simpleAuthManager;if(s)if(a.textContent="✅ Available",s.isUserLoggedIn()){const d=s.getCurrentUser();t.textContent="✅ Authenticated",n.textContent=d?`${d.email} (${d.full_name||"No name"})`:"User data missing"}else t.textContent="❌ Not authenticated",n.textContent="No user logged in";else a.textContent="⚠️ Not available",t.textContent="⚠️ Auth manager not loaded",n.textContent="Manager not loaded"}document.getElementById("test-product-redirect-btn")?.addEventListener("click",()=>{e("Testing product redirect to cart...");const t=window.globalAuthManager||window.simpleAuthManager;t&&t.isUserLoggedIn()?(e("✅ User authenticated, would redirect to cart"),e("Would redirect to: /cart?product=test-product&price=1000")):(e("❌ User not authenticated, would redirect to login"),e("Would redirect to: /login?redirect=/cart?product=test-product&price=1000"))});document.getElementById("test-cart-access-btn")?.addEventListener("click",()=>{e("Testing cart page access...");const t=window.globalAuthManager||window.simpleAuthManager;t&&t.isUserLoggedIn()?(e("✅ User can access cart page"),e("AuthGuard would allow access")):(e("❌ User cannot access cart page"),e("AuthGuard would redirect to login"))});document.getElementById("test-plan-selection-btn")?.addEventListener("click",()=>{e("Testing plan selection...");const t=window.globalAuthManager||window.simpleAuthManager;t&&t.isUserLoggedIn()?(e("✅ User can select plans and add to cart"),e("Product page would show authenticated options")):(e("❌ User cannot select plans"),e("Product page would show login prompt"))});document.getElementById("simulate-login-btn")?.addEventListener("click",()=>{e("Simulating login...");const t={id:"test-user-123",email:"test@example.com",full_name:"Test User",phone:"123-456-7890",company_name:"Test Company",role:"customer"};window.dispatchEvent(new CustomEvent("user-logged-in",{detail:t})),e("✅ Login event triggered for: "+t.email),setTimeout(()=>{o(),e("Status updated after login event")},100)});document.addEventListener("DOMContentLoaded",()=>{e("Page loaded, checking authentication..."),setTimeout(()=>{o(),e("Initial authentication check complete")},500)});window.addEventListener("user-logged-in",t=>{e("User logged in event received: "+t.detail.email),o()});window.addEventListener("user-logged-out",()=>{e("User logged out event received"),o()});e("Order flow test page script initialized");
