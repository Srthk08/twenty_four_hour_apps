const a=document.querySelectorAll(".filter-btn"),u=document.querySelectorAll(".product-card");a.forEach(t=>{t.addEventListener("click",()=>{a.forEach(e=>{e.classList.remove("active"),e.classList.add("bg-white","text-gray-700","border"),e.classList.remove("bg-primary-600","bg-blue-600","text-white"),e.style.color="#374151",e.style.backgroundColor="#ffffff",e.style.background="#ffffff"}),t.classList.add("active"),t.style.color="#3b82f6",t.style.backgroundColor="#ffffff",t.style.background="#ffffff";const o=t.dataset.filter;u.forEach(e=>{const r=e.dataset.category,s=e.dataset.productSlug;let i=!1;o==="all"?i=!0:o==="web"?i=s==="restaurant-website":o==="restaurant"?i=r===o&&s!=="restaurant-website"&&s!=="order-menu-system":o==="order-menu-system"?i=s==="order-menu-system":i=r===o,i?(e.style.display="block",e.classList.add("animate-fade-in")):e.style.display="none"})})});const c=new IntersectionObserver(t=>{t.forEach(o=>{o.isIntersecting&&(o.target.classList.add("animate-fade-in"),c.unobserve(o.target))})},{rootMargin:"100px 0px",threshold:.05});document.querySelectorAll(".product-card").forEach(t=>{c.observe(t)});document.addEventListener("DOMContentLoaded",()=>{document.body.classList.add("page-loaded");const t=document.querySelectorAll(".filter-btn"),o=document.querySelector(".filter-section");o&&(o.style.display="block",o.style.visibility="visible",o.style.opacity="1"),t.forEach(r=>{r.style.display="inline-block",r.style.visibility="visible",r.style.opacity="1",r.classList.contains("active")?(r.style.color="#3b82f6",r.style.backgroundColor="#ffffff",r.style.background="#ffffff"):(r.style.color="#374151",r.style.backgroundColor="#ffffff",r.style.background="#ffffff"),r.classList.remove("bg-primary-600","bg-blue-600","text-white")});const e=document.querySelectorAll('.product-card img[loading="lazy"]');e.length>0&&Array.from(e).slice(0,3).forEach(r=>{r.loading="eager"})});document.addEventListener("DOMContentLoaded",function(){const t=document.querySelectorAll(".product-view-btn"),o=["restaurant-menu-system","android-tv-app","streaming-mobile-app","restaurant-website"];t.forEach(e=>{e.addEventListener("click",function(r){r.preventDefault();const s=this.getAttribute("data-product-slug");if(this.getAttribute("data-product-name"),console.log("Product clicked:",s),o.includes(s)){console.log("ðŸš« Blocked product detected - showing dialog without login requirement"),window.showProductDialog?window.showProductDialog():(console.log("Dialog not available - redirecting to contact"),window.location.href="/contact");return}const n=f();if(console.log("Is admin:",n),n){console.log("Admin user - allowing access"),window.location.href=`/products/${s}`;return}const l=window.globalAuthManager||window.simpleAuthManager;if(!(l&&l.isUserLoggedIn())){console.log("âŒ User not logged in - authentication required, redirecting to login");const d=`/login?redirect=/products/${s}`;document.body.style.transition="opacity 0.3s ease-out",document.body.style.opacity="0",setTimeout(()=>{window.location.href=d},200);return}if(s==="order-menu-system"){console.log("Order Menu System - allowing access for logged-in user"),window.location.href=`/products/${s}`;return}console.log("Non-admin user - showing dialog"),window.showProductDialog?window.showProductDialog():(console.log("Dialog not available - redirecting to contact"),window.location.href="/contact")})})});function f(){try{if(window.globalAuthManager&&window.globalAuthManager.isUserLoggedIn()){const e=window.globalAuthManager.getCurrentUser();if(e&&e.role==="admin")return!0}if(window.simpleAuthManager&&window.simpleAuthManager.isUserLoggedIn()){const e=window.simpleAuthManager.getCurrentUser();if(e&&e.role==="admin")return!0}const t=sessionStorage.getItem("simple-auth-session");if(t)try{const e=JSON.parse(t);if(e.user&&e.user.role==="admin")return!0}catch(e){console.log("Session data parse error:",e)}const o=localStorage.getItem("simple-auth-session");if(o)try{const e=JSON.parse(o);if(e.user&&e.user.role==="admin")return!0}catch(e){console.log("Local session data parse error:",e)}return!1}catch(t){return console.error("Error checking admin status:",t),!1}}
