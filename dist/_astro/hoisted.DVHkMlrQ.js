import"./ProductDialog.astro_astro_type_script_index_0_lang.BMBe0S5g.js";import"https://unpkg.com/@supabase/supabase-js@2";import"./AuthGuard.astro_astro_type_script_index_0_lang.DULNhCHQ.js";class d{constructor(){this.orders=[],this.init()}init(){this.loadOrders(),this.renderOrders()}loadOrders(){const e=localStorage.getItem("project-requirements"),o=localStorage.getItem("order-menu-requirements"),n=localStorage.getItem("user-orders");console.log("Loading orders from multiple sources..."),console.log("Project requirements:",e),console.log("Order menu requirements:",o),console.log("User orders:",n),this.orders=[];const r=window.globalAuthManager?.getCurrentUser()||window.simpleAuthManager?.getCurrentUser();if(console.log("Current user:",r),!r){console.log("No current user found");return}if(e)try{JSON.parse(e).forEach(t=>{this.orders.push({...t,orderId:`PROJ-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,orderDate:t.timestamp||new Date().toISOString(),total:this.extractPrice(t.productPrice)||0,projectName:t.productName||"Custom Project",description:t.productDescription||"Professional digital solution",requirements:t,status:"completed"})})}catch(s){console.error("Error parsing project requirements:",s)}if(o)try{JSON.parse(o).forEach(t=>{this.orders.push({...t,orderId:`MENU-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,orderDate:t.timestamp||new Date().toISOString(),total:this.extractPrice(t.productPrice)||0,projectName:t.productName||"Order Menu System",description:t.productDescription||"Complete order management system",requirements:t,status:"completed"})})}catch(s){console.error("Error parsing order menu requirements:",s)}if(n)try{const t=JSON.parse(n).filter(c=>c.userId===r.email);this.orders.push(...t)}catch(s){console.error("Error parsing user orders:",s)}console.log("Total orders loaded:",this.orders.length)}extractPrice(e){if(!e)return 0;const o=e.match(/â‚¹?([\d,]+)/);return o?parseInt(o[1].replace(/,/g,"")):0}renderOrders(){const e=document.getElementById("loading-orders"),o=document.getElementById("empty-orders"),n=document.getElementById("orders-list");if(console.log("Rendering orders. Orders count:",this.orders.length),e?.classList.add("hidden"),this.orders.length===0){console.log("No orders found, showing empty state"),o?.classList.remove("hidden"),n?.classList.add("hidden");return}console.log("Orders found, showing orders list"),o?.classList.add("hidden"),n?.classList.remove("hidden"),this.renderOrdersList()}renderOrdersList(){const e=document.getElementById("orders-list");e&&(e.innerHTML="",this.orders.forEach((o,n)=>{const r=this.createOrderElement(o,n);e.appendChild(r)}))}createOrderElement(e,o){const n=document.getElementById("order-template");if(!n)return document.createElement("div");const r=n.cloneNode(!0);r.classList.remove("hidden"),r.id=`order-${o}`,r.querySelector(".order-project-name").textContent=e.projectName||"Custom Project",r.querySelector(".order-project-description").textContent=e.description||"Professional digital solution",r.querySelector(".order-total").textContent=`â‚¹${e.total?.toLocaleString()||"0"}`,r.querySelector(".order-date").textContent=this.formatDate(e.orderDate),r.querySelector(".order-id").textContent=e.orderId||`ORD-${Date.now()}`,r.querySelector(".order-custom-name").textContent=e.requirements?.projectName||"-",r.querySelector(".order-contact-person").textContent=e.requirements?.contactPerson||"-",r.querySelector(".order-restaurant-name").textContent=e.requirements?.restaurantName||"-",r.querySelector(".order-cuisine-type").textContent=e.requirements?.cuisineType||"-",r.querySelector(".order-email").textContent=e.requirements?.email||"-",r.querySelector(".order-phone").textContent=e.requirements?.phone||"-",e.requirements?.primaryColor&&(r.querySelector(".order-primary-color").style.backgroundColor=e.requirements.primaryColor),e.requirements?.secondaryColor&&(r.querySelector(".order-secondary-color").style.backgroundColor=e.requirements.secondaryColor),e.requirements?.accentColor&&(r.querySelector(".order-accent-color").style.backgroundColor=e.requirements.accentColor),e.requirements?.textColor&&(r.querySelector(".order-text-color").style.backgroundColor=e.requirements.textColor);const s=r.querySelector(".order-features");e.features&&e.features.length>0&&(s.innerHTML=e.features.map(a=>`<span class="inline-block bg-primary-100 text-primary-800 text-xs px-2 py-1 rounded-full mr-2 mb-1">${a}</span>`).join(""));const t=r.querySelector(".order-logo-status");e.logo&&(t.innerHTML='<span class="text-green-600">âœ“ Logo uploaded</span>');const c=r.querySelector(".order-additional-requirements");return e.requirements?.additionalRequirements&&(c.textContent=e.requirements.additionalRequirements),r}formatDate(e){return e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"}}document.addEventListener("DOMContentLoaded",()=>{new d,new URLSearchParams(window.location.search).get("order")==="success"&&(l(),window.history.replaceState({},document.title,window.location.pathname))});function l(){const i=document.createElement("div");i.className="fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 transform transition-all duration-300",i.innerHTML=`
      <div class="flex items-center space-x-2">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
        </svg>
        <span>Order placed successfully! ðŸŽ‰</span>
      </div>
    `,document.body.appendChild(i),setTimeout(()=>{i.remove()},5e3)}document.addEventListener("DOMContentLoaded",function(){const i=new URLSearchParams(window.location.search),e=i.get("order"),o=i.get("product");if(e==="success"){console.log("âœ… Order success detected, redirecting to congratulations page..."),window.location.href="/order-success?product="+(o||"order-menu-system");return}});
