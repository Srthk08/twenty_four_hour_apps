import{_ as R}from"./preload-helper.CLcXU_4U.js";import{supabase as B}from"./supabase.B9-RI-CL.js";import"./ProductDialog.astro_astro_type_script_index_0_lang.C1LHbjNP.js";import"https://unpkg.com/@supabase/supabase-js@2";import"./index.BymsOcZI.js";class D{constructor(){this.orders=[],this.supportTickets=[],this.payments=[],this.users=[],this.loadFromStorage(),this.syncWithSimpleAuth()}static getInstance(){return D.instance||(D.instance=new D),D.instance}loadFromStorage(){try{const e=localStorage.getItem("shared-orders"),t=localStorage.getItem("shared-tickets"),a=localStorage.getItem("shared-payments"),r=localStorage.getItem("shared-users");e&&(this.orders=JSON.parse(e)),t&&(this.supportTickets=JSON.parse(t)),a&&(this.payments=JSON.parse(a)),r&&(this.users=JSON.parse(r))}catch(e){console.error("Error loading shared data:",e)}}saveToStorage(){try{localStorage.setItem("shared-orders",JSON.stringify(this.orders)),localStorage.setItem("shared-tickets",JSON.stringify(this.supportTickets)),localStorage.setItem("shared-payments",JSON.stringify(this.payments)),localStorage.setItem("shared-users",JSON.stringify(this.users))}catch(e){console.error("Error saving shared data:",e)}}syncWithSimpleAuth(){try{const e=localStorage.getItem("simple-auth-users");e&&(JSON.parse(e).forEach(a=>{if(!this.users.find(o=>o.email===a.email)){const o={id:a.id||`user-${Date.now()}`,email:a.email,fullName:a.fullName||"User",phone:a.phone,companyName:a.companyName,role:"customer",status:"active",avatarUrl:a.avatarUrl,lastLoginAt:a.lastLoginAt,loginCount:a.loginCount||1,createdAt:a.createdAt||new Date().toISOString(),updatedAt:new Date().toISOString()};this.users.push(o)}}),this.saveToStorage())}catch(e){console.error("Error syncing with simple-auth:",e)}}createOrder(e){const t={...e,id:`order-${Date.now()}`,orderNumber:`ORD-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),timeline:[{id:`timeline-${Date.now()}`,status:e.status,message:"Order created",timestamp:new Date().toISOString(),updatedBy:"system"}]};return this.orders.push(t),this.saveToStorage(),t}updateOrderStatus(e,t,a){const r=this.orders.find(o=>o.id===e);return r?(r.status=t,r.updatedAt=new Date().toISOString(),r.timeline.push({id:`timeline-${Date.now()}`,status:t,message:a,timestamp:new Date().toISOString(),updatedBy:"admin"}),this.saveToStorage(),!0):!1}getOrders(){return[...this.orders]}getOrdersByStatus(e){return this.orders.filter(t=>t.status===e)}getOrdersByUser(e){return this.orders.filter(t=>t.userId===e)}createSupportTicket(e){const t={...e,id:`ticket-${Date.now()}`,ticketNumber:`TKT-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return this.supportTickets.push(t),this.saveToStorage(),t}updateTicketStatus(e,t,a){const r=this.supportTickets.find(o=>o.id===e);return r?(r.status=t,r.updatedAt=new Date().toISOString(),a&&(r.lastResponseAt=new Date().toISOString()),this.saveToStorage(),!0):!1}updateTicket(e,t){const a=this.supportTickets.find(r=>r.id===e);return a?(t.status&&(a.status=t.status),t.adminReply&&(a.adminReplies||(a.adminReplies=[]),a.adminReplies.push(t.adminReply),a.lastResponseAt=new Date().toISOString(),this.sendTicketUpdateNotification(a,t.adminReply,t.status)),a.updatedAt=new Date().toISOString(),this.saveToStorage(),!0):!1}sendTicketUpdateNotification(e,t,a){try{const r={to:e.customerEmail,subject:`Update on Your Support Ticket #${e.ticketNumber}`,message:this.createNotificationMessage(e,t,a),timestamp:new Date().toISOString(),ticketId:e.id,status:a||e.status};this.storeNotification(r),this.showBrowserNotification(e,t,a),this.sendRealEmailNotification(e,t,a),console.log(`Notification sent to ${e.customerEmail} for ticket #${e.ticketNumber}`)}catch(r){console.error("Error sending notification:",r)}}async sendRealEmailNotification(e,t,a){try{const{sendEmail:r,emailTemplates:o}=await R(async()=>{const{sendEmail:c,emailTemplates:u}=await import("./email-config.Bt3IG4FW.js");return{sendEmail:c,emailTemplates:u}},[]),n=o.supportTicketUpdate;let i=n.subject,s=n.body;const l={"{{ticketNumber}}":e.ticketNumber,"{{customerName}}":e.customerName,"{{subject}}":e.subject,"{{status}}":a||e.status,"{{adminReply}}":t.message,"{{replyDate}}":new Date(t.timestamp).toLocaleString(),"{{adminName}}":t.adminName};Object.entries(l).forEach(([c,u])=>{i=i.replace(c,u),s=s.replace(c,u)});const d=await r(e.customerEmail,i,s);console.log(d?"Real email sent successfully via configured email service":"Email service not configured, falling back to localStorage notifications")}catch(r){console.error("Error sending real email:",r)}}createNotificationMessage(e,t,a){let r=`Hello ${e.customerName},

`;return a&&a!==e.status&&(r+=`Your support ticket #${e.ticketNumber} status has been updated to: ${a.replace("_"," ").toUpperCase()}

`),r+=`Admin Reply:
${t.message}

`,r+=`Ticket Details:
`,r+=`Subject: ${e.subject}
`,r+=`Priority: ${e.priority}
`,r+=`Status: ${a||e.status}

`,r+=`You can view the full details and reply in your support dashboard.

`,r+=`Best regards,
DevExpress Support Team`,r}storeNotification(e){try{const t=JSON.parse(localStorage.getItem("user-notifications")||"[]");t.unshift(e),t.length>50&&t.splice(50),localStorage.setItem("user-notifications",JSON.stringify(t))}catch(t){console.error("Error storing notification:",t)}}showBrowserNotification(e,t,a){if("Notification"in window&&Notification.permission==="granted"){const r=`Ticket #${e.ticketNumber} Updated`,o=`Admin replied: ${t.message.substring(0,100)}${t.message.length>100?"...":""}`;new Notification(r,{body:o,icon:"/favicon.ico",tag:e.id})}}getUserNotifications(e){try{return JSON.parse(localStorage.getItem("user-notifications")||"[]").filter(a=>a.to===e)}catch(t){return console.error("Error getting notifications:",t),[]}}markNotificationAsRead(e){try{const t=JSON.parse(localStorage.getItem("user-notifications")||"[]"),a=t.find(r=>r.timestamp===e);a&&(a.read=!0,localStorage.setItem("user-notifications",JSON.stringify(t)))}catch(t){console.error("Error marking notification as read:",t)}}getTicketsByUser(e){return this.supportTickets.filter(t=>t.customerEmail===e)}getSupportTickets(){return[...this.supportTickets]}getTicketsByStatus(e){return this.supportTickets.filter(t=>t.status===e)}createPayment(e){const t={...e,id:`payment-${Date.now()}`,createdAt:new Date().toISOString()};return this.payments.push(t),this.saveToStorage(),t}updatePaymentStatus(e,t){const a=this.payments.find(r=>r.id===e);return a?(a.status=t,this.saveToStorage(),!0):!1}getPayments(){return[...this.payments]}getPaymentsByStatus(e){return this.payments.filter(t=>t.status===e)}createUser(e){const t={...e,id:`user-${Date.now()}`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return this.users.push(t),this.saveToStorage(),t}updateUser(e,t){const a=this.users.find(r=>r.id===e);return a?(Object.assign(a,t),a.updatedAt=new Date().toISOString(),this.saveToStorage(),!0):!1}getUsers(){return[...this.users]}getUserById(e){return this.users.find(t=>t.id===e)}getUserByEmail(e){return this.users.find(t=>t.email===e)}deleteUser(e){const t=this.users.findIndex(a=>a.id===e);return t!==-1?(this.users.splice(t,1),this.saveToStorage(),!0):!1}getStats(){const e=new Date,t=new Date(e.getTime()-7*24*60*60*1e3),a=new Date(e.getTime()-30*24*60*60*1e3);return{totalUsers:this.users.length,activeUsers:this.users.filter(r=>r.status==="active").length,totalOrders:this.orders.length,pendingOrders:this.orders.filter(r=>r.status==="pending").length,cartOrders:this.orders.filter(r=>r.status==="cart").length,completedOrders:this.orders.filter(r=>r.status==="completed").length,totalRevenue:this.payments.filter(r=>r.status==="completed").reduce((r,o)=>r+o.amount,0),monthlyRevenue:this.payments.filter(r=>r.status==="completed"&&new Date(r.createdAt)>=a).reduce((r,o)=>r+o.amount,0),weeklyRevenue:this.payments.filter(r=>r.status==="completed"&&new Date(r.createdAt)>=t).reduce((r,o)=>r+o.amount,0),openTickets:this.supportTickets.filter(r=>r.status==="open").length,highPriorityTickets:this.supportTickets.filter(r=>r.priority==="high"||r.priority==="urgent").length,pendingPayments:this.payments.filter(r=>r.status==="pending").length}}clearAllData(){this.orders=[],this.supportTickets=[],this.payments=[],this.users=[],this.saveToStorage()}exportOrdersToCSV(){if(this.orders.length===0)return"No orders to export";const e=["Order ID","Customer","Service","Status","Payment Status","Amount","Date"],t=this.orders.map(a=>[a.orderNumber,a.customerName,a.serviceName,a.status,a.paymentStatus,a.amount,new Date(a.createdAt).toLocaleDateString()]);return[e,...t].map(a=>a.join(",")).join(`
`)}}const T=D.getInstance();console.log("üöÄ Cart page script loaded");document.addEventListener("DOMContentLoaded",()=>{console.log("üöÄ DOM Content Loaded - Cart page initialization starting..."),["empty-cart","cart-items","cart-actions","project-requirements","cart-content"].forEach(e=>{const t=document.getElementById(e);console.log(`üîç Element ${e}:`,!!t)});try{console.log("üîç Creating Cart instance...");const e=window.globalAuthManager||window.simpleAuthManager;if(console.log("üîç Auth manager available:",!!e),e){const n=e.getCurrentUser();console.log("üîç Current user:",n?`${n.email} (${n.full_name||"No name"})`:"Not logged in")}const t=new K;console.log("‚úÖ Cart created, items count:",t.items.length),console.log("‚úÖ Cart initialized with",t.items.length,"items");const a=document.getElementById("cart-content");a&&(a.style.display="block",a.style.visibility="visible",console.log("‚úÖ Forced cart content to be visible")),document.getElementById("submit-requirements")?.addEventListener("click",n=>{n.preventDefault(),n.stopPropagation(),t.submitRequirements()}),document.getElementById("requirements-form")?.addEventListener("submit",n=>(n.preventDefault(),n.stopPropagation(),!1))}catch(e){console.error("‚ùå Error initializing cart:",e),alert("Error initializing cart: "+e.message)}});class K{constructor(){this.items=[],this.requirements={},this.currentSharedOrderId=null,this.isSubmitting=!1,this.debouncedSaveToSupabase=this.debounce(this.saveCartToSupabase.bind(this),1e3),this.init().catch(e=>{console.error("‚ùå Error initializing cart:",e)})}async init(){console.log("üöÄ Cart initialization started"),this.items=[],this.requirements={};const t=(window.globalAuthManager||window.simpleAuthManager)?.getCurrentUser();t?console.log("üë§ User authenticated:",t.email,"- loading user cart"):(console.log("üë§ No authenticated user - checking localStorage"),this.checkAndClearNewUserCart()),await this.loadCart(),console.log("üì¶ Cart loaded, items count:",this.items.length),this.items.length>0&&t&&(window.validateCartOwnership()||(console.log("üîÑ Cart ownership validation failed, clearing cart..."),this.items=[],this.requirements={},localStorage.removeItem("cart-items"),localStorage.removeItem("cart-requirements"),localStorage.removeItem("user-cart-data"),console.log("üì¶ Cart cleared after validation, items count:",this.items.length))),this.checkUrlParams(),this.populateFormFields(),console.log("üìù Form fields populated"),this.renderCart(),console.log("üé® Cart rendered"),this.bindEvents(),console.log("üîó Events bound, initialization complete")}checkAndClearNewUserCart(){if(console.log("üîç Checking if this is a new user session..."),sessionStorage.getItem("has-visited-cart"))console.log("üë§ Returning user session - keeping existing cart data");else{console.log("üÜï New user session detected - checking if cart should be cleared");const t=localStorage.getItem("cart-items");if(t)try{const a=JSON.parse(t);if(Array.isArray(a)&&a.length>0){console.log("üë§ Returning user with existing cart data - keeping cart"),sessionStorage.setItem("has-visited-cart","true");return}}catch{console.log("üîÑ Invalid cart data found - clearing it")}console.log("üÜï Truly new user - clearing any existing cart data"),localStorage.removeItem("cart-items"),localStorage.removeItem("cart-requirements"),localStorage.removeItem("user-cart-data"),localStorage.removeItem("cart-customizations"),sessionStorage.setItem("has-visited-cart","true"),console.log("‚úÖ Cart cleared for new user session")}}checkUrlParams(){console.log("üîç Checking URL parameters...");const e=new URLSearchParams(window.location.search),t=e.get("product"),a=e.get("price");console.log("üì¶ URL parameters found:",{product:t,price:a}),t&&a?(console.log("‚úÖ Product and price found, adding to cart..."),this.addProductFromUrl(t,parseInt(a)),window.history.replaceState({},document.title,window.location.pathname),console.log("‚úÖ URL parameters cleared")):console.log("‚ùå No product or price found in URL parameters")}addProductFromUrl(e,t){console.log("üõí Adding product from URL:",{productId:e,price:t}),this.items=[];const a={1:"Restaurant Menu System",2:"Android TV App",3:"Streaming Mobile App",4:"Restaurant Website","restaurant-menu":"Restaurant Menu System","android-tv":"Android TV App","mobile-streaming":"Mobile Streaming App","restaurant-menu-system":"Restaurant Menu System","android-tv-app":"Android TV App","streaming-mobile-app":"Streaming Mobile App","restaurant-website":"Restaurant Website"},r={1:"Digital menu system with QR code ordering, real-time updates, and analytics dashboard.",2:"Custom Android TV application with streaming capabilities and smart remote support.",3:"Cross-platform mobile app for video streaming with offline download support.",4:"Professional restaurant website with online ordering and reservation system.","restaurant-menu":"Digital menu system with QR code ordering, real-time updates, and analytics dashboard.","android-tv":"Custom Android TV application with streaming capabilities and smart remote support.","mobile-streaming":"Cross-platform mobile app for video streaming with offline download support.","restaurant-menu-system":"Digital menu system with QR code ordering, real-time updates, and analytics dashboard.","android-tv-app":"Custom Android TV application with streaming capabilities and smart remote support.","streaming-mobile-app":"Cross-platform mobile app for video streaming with offline download support.","restaurant-website":"Professional restaurant website with online ordering and reservation system."},o={id:e,name:a[e]||"Custom Product",description:r[e]||"Professional digital solution",price:t,quantity:1,customName:"",logo:null,color:"#3B82F6",features:[]};console.log("üì¶ Created cart item:",o),this.items.push(o),this.saveCart(),console.log("‚úÖ Product added to cart, items count:",this.items.length)}async loadCart(){this.items=[],this.requirements={};const t=(window.globalAuthManager||window.simpleAuthManager)?.getCurrentUser();if(console.log("üë§ Loading cart for user:",t?t.email:"anonymous"),t&&B)try{console.log("üîÑ Loading cart from Supabase for user:",t.email);const{data:r,error:o}=await B.from("cart_customizations").select("*").eq("user_email",t.email).eq("cart_status","active").order("created_at",{ascending:!1});if(o){console.error("‚ùå Error loading cart from Supabase:",o),this.items=[],this.clearUserCartFromLocalStorage(t.email);return}else if(r&&r.length>0){if(console.log("‚úÖ Loaded cart from Supabase:",r),console.log("üìä Cart data details:",{count:r.length,firstItem:r[0],basePrice:r[0]?.base_price,productName:r[0]?.product_name}),this.items=r.map(n=>({id:n.product_id,name:n.product_name,description:n.product_description,price:n.base_price,quantity:1,customName:n.custom_name||"",restaurantName:n.restaurant_name_customization||"",color:n.selected_color||"#3B82F6",features:n.selected_features||[],projectName:n.project_name||"",contactPerson:n.contact_person||"",cuisineType:n.cuisine_type||"",appName:n.app_name||"",productDescription:n.product_description_custom||"",email:n.contact_email||t.email,phone:n.contact_phone||"",primaryColor:n.primary_color||"#3B82F6",secondaryColor:n.secondary_color||"#A5CF6",accentColor:n.accent_color||"#F59E0B",textColor:n.text_color||"#1F2937",additionalRequirements:n.additional_requirements||""})),console.log("üîÑ Mapped cart items:",this.items),console.log("üí∞ First item price:",this.items[0]?.price),this.items.length>0){const n=this.items[0];this.requirements={projectName:n.projectName,contactPerson:n.contactPerson,restaurantName:n.restaurantName,cuisineType:n.cuisineType,appName:n.appName,productDescription:n.productDescription,email:n.email,phone:n.phone,primaryColor:n.primaryColor,secondaryColor:n.secondaryColor,accentColor:n.accentColor,textColor:n.textColor,additionalRequirements:n.additionalRequirements}}console.log("‚úÖ Cart loaded from Supabase with",this.items.length,"items");return}else{console.log("üîÑ No cart data found in Supabase for user:",t.email,"- starting with empty cart"),this.items=[],this.clearUserCartFromLocalStorage(t.email);return}}catch(r){console.error("‚ùå Error loading cart from Supabase:",r),this.items=[],this.clearUserCartFromLocalStorage(t.email);return}console.log("üîÑ Loading cart from localStorage for anonymous user");const a=localStorage.getItem("cart-items");if(a)try{const r=JSON.parse(a);Array.isArray(r)&&r.length>0?(this.items=r,console.log("‚úÖ Cart loaded from localStorage with",this.items.length,"items")):(this.items=[],console.log("üîÑ Invalid cart data in localStorage, starting with empty cart"))}catch(r){console.error("‚ùå Error parsing localStorage cart data:",r),this.items=[],localStorage.removeItem("cart-items")}else this.items=[],console.log("üîÑ No cart data in localStorage, starting with empty cart")}saveCart(){localStorage.setItem("cart-items",JSON.stringify(this.items)),console.log("üíæ Cart saved to localStorage, items count:",this.items.length),(window.globalAuthManager||window.simpleAuthManager)?.getCurrentUser()&&(console.log("üíæ Cart data will also be saved to Supabase for authenticated user"),this.debouncedSaveToSupabase())}clearUserCartFromLocalStorage(e){console.log("üßπ Clearing localStorage cart data for user:",e);const t=localStorage.getItem("cart-items");if(t)try{const a=JSON.parse(t);if(e){console.log("üßπ Clearing localStorage cart data for authenticated user"),localStorage.removeItem("cart-items"),this.items=[];return}a.length>0&&a[0].email&&a[0].email!==e&&(console.log("üßπ Clearing localStorage cart data from different user"),localStorage.removeItem("cart-items"),this.items=[])}catch(a){console.error("‚ùå Error checking localStorage cart data:",a),localStorage.removeItem("cart-items"),this.items=[]}localStorage.removeItem("cart-requirements"),localStorage.removeItem("user-cart-data"),this.items=[],this.requirements={}}populateFormFields(){if(this.items.length===0)return;const e=this.items[0];console.log("üîÑ Populating form fields with loaded data:",e);const t=document.getElementById("projectName");t&&e.projectName&&(t.value=e.projectName);const a=document.getElementById("contactPerson");a&&e.contactPerson&&(a.value=e.contactPerson);const r=document.getElementById("restaurantName");r&&e.restaurantName&&(r.value=e.restaurantName);const o=document.getElementById("cuisineType");o&&e.cuisineType&&(o.value=e.cuisineType);const n=document.getElementById("appName");n&&e.appName&&(n.value=e.appName);const i=document.getElementById("productDescription");i&&e.productDescription&&(i.value=e.productDescription);const s=document.getElementById("email");s&&e.email&&(s.value=e.email);const l=document.getElementById("phone");l&&e.phone&&(l.value=e.phone);const d=document.getElementById("additionalRequirements");d&&e.additionalRequirements&&(d.value=e.additionalRequirements),e.features&&Array.isArray(e.features)&&e.features.forEach(c=>{const u=document.querySelector(`input[data-feature="${c}"]`);u&&(u.checked=!0)}),this.requirements={projectName:e.projectName||"",contactPerson:e.contactPerson||"",restaurantName:e.restaurantName||"",cuisineType:e.cuisineType||"",appName:e.appName||"",productDescription:e.productDescription||"",email:e.email||"",phone:e.phone||"",primaryColor:e.primaryColor||"#3B82F6",secondaryColor:e.secondaryColor||"#A5CF6",accentColor:e.accentColor||"#F59E0B",textColor:e.textColor||"#1F2937",additionalRequirements:e.additionalRequirements||""},console.log("‚úÖ Form fields populated successfully")}addItem(e){this.items.length>0&&(this.items=[]),this.items.push({...e,quantity:1,customName:"",logo:null,color:"#3B82F6",features:[]}),this.saveCart(),this.renderCart()}removeItem(e){this.items=this.items.filter(t=>t.id!==e),this.saveCart(),this.renderCart()}updateItem(e,t){const a=this.items.find(r=>r.id===e);a&&(Object.assign(a,t),this.saveCart(),this.renderCart())}renderCart(){console.log("üé® renderCart called with items:",this.items.length);const e=document.getElementById("empty-cart"),t=document.getElementById("cart-items"),a=document.getElementById("cart-actions"),r=document.getElementById("project-requirements"),o=document.getElementById("cart-content");console.log("üîç DOM elements found:",{emptyCart:!!e,cartItems:!!t,cartActions:!!a,projectRequirements:!!r,cartContent:!!o}),this.items.length===0?(console.log("üì≠ Showing empty cart"),e?.classList.remove("hidden"),t?.classList.add("hidden"),a?.classList.add("hidden"),r?.classList.add("hidden")):(console.log("üì¶ Showing cart with items"),e?.classList.add("hidden"),t?.classList.remove("hidden"),a?.classList.remove("hidden"),r?.classList.add("hidden")),this.renderCartItems(),this.updateSummary()}renderCartItems(){const e=document.getElementById("cart-items");e&&(e.innerHTML="",this.items.forEach(t=>{const a=this.createCartItemElement(t);e.appendChild(a)}))}createCartItemElement(e){const t=document.getElementById("cart-item-template");if(!t)return document.createElement("div");const a=t.cloneNode(!0);a.classList.remove("hidden"),a.id=`cart-item-${e.id}`,a.querySelector(".product-name").textContent=e.name,a.querySelector(".product-description").textContent=e.description,a.querySelector(".product-price").textContent=`‚Çπ${e.price}`;const r=a.querySelector(".product-type-text"),o=a.querySelector(".product-type-badge");e.id==="restaurant-menu"||e.id==="restaurant-menu-system"||e.id==="restaurant-website"||e.id==="1"||e.id==="4"?(r.textContent="Restaurant Solution",o.className="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium product-type-badge bg-green-100 text-green-800"):e.id==="order-menu-system"||e.id==="5"?(r.textContent="Order Menu System",o.className="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium product-type-badge bg-blue-100 text-blue-800"):e.id==="android-tv"||e.id==="android-tv-app"||e.id==="2"?(r.textContent="Android TV App",o.className="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium product-type-badge bg-purple-100 text-purple-800"):e.id==="mobile-streaming"||e.id==="streaming-mobile-app"||e.id==="3"?(r.textContent="Mobile Streaming App",o.className="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium product-type-badge bg-orange-100 text-orange-800"):(r.textContent="Custom Product",o.className="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium product-type-badge bg-gray-100 text-gray-800");const n=a.querySelector("#restaurant-name-customization");e.id==="restaurant-menu"||e.id==="restaurant-menu-system"||e.id==="restaurant-website"||e.id==="1"||e.id==="4"?n?.classList.remove("hidden"):n?.classList.add("hidden");const i=a.querySelector(".product-name-input");i&&e.customName&&(i.value=e.customName);const s=a.querySelector(".restaurant-name-input");return s&&e.restaurantName&&(s.value=e.restaurantName),a.querySelectorAll(".color-option").forEach(c=>{c.dataset.color===e.color&&c.classList.add("border-2","border-gray-900")}),a.querySelectorAll(".feature-checkbox").forEach(c=>{e.features.includes(c.dataset.feature)&&(c.checked=!0)}),this.bindItemEvents(a,e),a}bindItemEvents(e,t){e.querySelector(".product-name-input")?.addEventListener("input",d=>{this.updateItem(t.id,{customName:d.target.value})}),e.querySelector(".restaurant-name-input")?.addEventListener("input",d=>{this.updateItem(t.id,{restaurantName:d.target.value})});const o=e.querySelector(".logo-upload"),n=e.querySelector(".logo-upload-btn"),i=e.querySelector(".logo-preview");n.addEventListener("click",()=>o.click()),o.addEventListener("change",d=>{const c=d.target.files[0];if(c){const u=new FileReader;u.onload=f=>{i.innerHTML=`<img src="${f.target.result}" class="w-full h-full object-cover rounded-lg">`,this.updateItem(t.id,{logo:f.target.result})},u.readAsDataURL(c)}});const s=e.querySelectorAll(".color-option");s.forEach(d=>{d.addEventListener("click",()=>{s.forEach(c=>c.classList.remove("border-2","border-gray-900")),d.classList.add("border-2","border-gray-900"),this.updateItem(t.id,{color:d.dataset.color})})});const l=e.querySelectorAll(".feature-checkbox");l.forEach(d=>{d.addEventListener("change",()=>{const c=Array.from(l).filter(u=>u.checked).map(u=>u.dataset.feature);this.updateItem(t.id,{features:c})})})}updateSummary(){console.log("üí∞ updateSummary called with items:",this.items);const e=this.items.reduce((d,c)=>d+c.price*c.quantity,0),t=this.items.reduce((d,c)=>d+c.features.length*500,0),a=Math.round((e+t)*.18),r=e+t+a;console.log("üí∞ Amount calculation:",{subtotal:e,featuresTotal:t,tax:a,total:r,itemsCount:this.items.length});const o=document.getElementById("subtotal"),n=document.getElementById("features-total"),i=document.getElementById("tax"),s=document.getElementById("total"),l=document.getElementById("final-amount");console.log("üí∞ Summary elements found:",{subtotalElement:!!o,featuresTotalElement:!!n,taxElement:!!i,totalElement:!!s,finalAmountElement:!!l}),o&&(o.textContent=`‚Çπ${e.toLocaleString()}`,console.log("‚úÖ Updated subtotal:",o.textContent)),n&&(n.textContent=`‚Çπ${t.toLocaleString()}`,console.log("‚úÖ Updated features total:",n.textContent)),i&&(i.textContent=`‚Çπ${a.toLocaleString()}`,console.log("‚úÖ Updated tax:",i.textContent)),s&&(s.textContent=`‚Çπ${r.toLocaleString()}`,console.log("‚úÖ Updated total:",s.textContent)),l&&(l.textContent=r.toLocaleString(),console.log("‚úÖ Updated final amount:",l.textContent))}bindEvents(){document.getElementById("delete-selected")?.addEventListener("click",()=>{this.deleteSelectedProject()}),document.getElementById("proceed-to-requirements")?.addEventListener("click",()=>{this.showProjectRequirements()}),document.getElementById("back-to-cart")?.addEventListener("click",()=>{this.backToCart()}),document.getElementById("back-to-requirements")?.addEventListener("click",()=>{this.backToRequirements()}),document.getElementById("final-payment")?.addEventListener("click",()=>{this.processFinalPayment()}),document.querySelectorAll('input[name="paymentMethod"]').forEach(e=>{e.addEventListener("change",t=>{this.switchPaymentMethod(t.target.value)})})}continueShopping(){this.items=[],this.saveCart(),window.location.href="/products"}deleteSelectedProject(){confirm("Are you sure you want to delete this project? You will be redirected to products page.")&&(this.items=[],this.saveCart(),window.location.href="/products")}async showProjectRequirements(){const e=document.getElementById("cart-actions"),t=document.getElementById("project-requirements");e&&e.classList.add("hidden"),t&&t.classList.remove("hidden"),this.prefillRequirementsForm(),this.showProjectTypeFields(),t?.scrollIntoView({behavior:"smooth"})}async submitRequirements(){console.log("üöÄ submitRequirements function called!");const e=document.getElementById("submit-requirements"),t=e.innerHTML;if(this.isSubmitting||e.disabled){console.log("‚ùå Form already being submitted, ignoring duplicate call");return}this.isSubmitting=!0;try{console.log("üöÄ Starting submitRequirements...");const a=document.getElementById("requirements-form"),r=this.items[0]&&(this.items[0].id==="order-menu-system"||this.items[0].id==="5");if(r){const l=["projectName","contactPerson","orderMenuRestaurantName","orderMenuHouseNumber","orderMenuAddressLine1","orderMenuCity","orderMenuState","orderMenuPincode","email","phone"];let d=!0;for(const c of l){const u=a.querySelector(`[name="${c}"]`);if(u&&!u.value.trim()){u.focus(),u.reportValidity(),d=!1;break}}if(!d){console.log("‚ùå Order Menu System form validation failed");return}}else{const l=a.querySelectorAll("#order-menu-fields [required], #restaurant-fields [required], #restaurant-cuisine-fields [required]"),d=[];if(l.forEach((c,u)=>{d[u]=c.required,c.required=!1}),!a.checkValidity()){console.log("‚ùå Form validation failed"),a.reportValidity(),l.forEach((c,u)=>{c.required=d[u]});return}l.forEach((c,u)=>{c.required=d[u]})}console.log("‚úÖ Form validation passed"),e.innerHTML=`
          <svg class="animate-spin -ml-1 mr-2 h-4 w-4 text-white inline" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          Saving & Processing...
        `,e.disabled=!0;const o=this.items[0];if(r){const l=this.collectMenuItems();console.log("üçΩÔ∏è Collected menu items for Order Menu System:",l),this.requirements={restaurantName:a.querySelector('[name="orderMenuRestaurantName"]')?.value||"",houseNumber:a.querySelector('[name="houseNumber"]')?.value||"",addressLine1:a.querySelector('[name="addressLine1"]')?.value||"",city:a.querySelector('[name="city"]')?.value||"",state:a.querySelector('[name="state"]')?.value||"",pincode:a.querySelector('[name="pincode"]')?.value||"",country:a.querySelector('[name="country"]')?.value||"India",email:a.querySelector('[name="email"]')?.value||"",phone:a.querySelector('[name="phone"]')?.value||"",additionalRequirements:a.querySelector('[name="additionalRequirements"]')?.value||""}}else this.requirements={projectName:a.querySelector('[name="projectName"]')?.value||"",contactPerson:a.querySelector('[name="contactPerson"]')?.value||"",restaurantName:a.querySelector('[name="restaurantName"]')?.value||"",cuisineType:a.querySelector('[name="cuisineType"]')?.value||"",appName:a.querySelector('[name="appName"]')?.value||"",productDescription:a.querySelector('[name="productDescription"]')?.value||"",email:a.querySelector('[name="email"]')?.value||"",phone:a.querySelector('[name="phone"]')?.value||"",additionalRequirements:a.querySelector('[name="additionalRequirements"]')?.value||""};console.log("üìù Collected form data:",this.requirements);let n=null;try{console.log("üîç Attempting to save to Supabase..."),n=await Promise.race([this.saveCartToSupabase(),new Promise((l,d)=>setTimeout(()=>d(new Error("Database timeout")),1e4))])}catch(l){console.warn("‚ö†Ô∏è Database save failed, but continuing:",l)}n?(console.log("‚úÖ Cart data saved successfully:",n),this.items.length>0&&(this.items[0].savedData=n,this.saveCart())):console.log("‚ö†Ô∏è No database save, but continuing with local data"),e.innerHTML=`
          <svg class="w-4 h-4 text-white inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
          </svg>
          Success! Redirecting...
        `,this.updateOrderReview();const i=document.getElementById("project-requirements"),s=document.getElementById("payment-section");if(console.log("üîÑ Showing payment page directly..."),console.log("üîç Project requirements element:",!!i),console.log("üîç Payment section element:",!!s),s&&(console.log("üîç Payment section parent:",s.parentElement),console.log("üîç Payment section offsetHeight:",s.offsetHeight),console.log("üîç Payment section offsetWidth:",s.offsetWidth),console.log("üîç Payment section computed style display:",window.getComputedStyle(s).display)),i&&(i.classList.add("hidden"),i.style.display="none",console.log("‚úÖ Hidden project requirements")),s){s.classList.remove("hidden"),s.style.setProperty("display","block","important"),s.style.setProperty("visibility","visible","important"),s.style.setProperty("opacity","1","important"),s.style.setProperty("position","relative","important"),s.style.setProperty("z-index","999","important"),s.style.setProperty("height","auto","important"),s.style.setProperty("width","100%","important"),s.style.setProperty("background-color","#ffffff","important"),console.log("‚úÖ Showed payment section with forced visibility");const l=document.getElementById("payment-loading"),d=document.getElementById("payment-content");l&&(l.classList.remove("hidden"),l.style.display="block"),d&&(d.style.display="none"),this.updatePaymentSummary(),setTimeout(()=>{l&&(l.classList.add("hidden"),l.style.display="none"),d&&(d.style.display="block"),r?(console.log("üçΩÔ∏è Order Menu System detected - payment link removed, showing payment section only."),s.scrollIntoView({behavior:"smooth"})):(s.scrollIntoView({behavior:"smooth"}),console.log("‚úÖ Scrolled to payment page"))},500)}else console.error("‚ùå Payment section element not found!"),alert("Error: Payment page not found. Please refresh the page and try again.");setTimeout(()=>{e.innerHTML=t,e.disabled=!1,this.isSubmitting=!1},2e3)}catch(a){console.error("‚ùå Error in submitRequirements:",a),e.innerHTML=`
          <svg class="w-4 h-4 text-white inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
          Error
        `,alert("Warning: Could not save to database, but you can still proceed with your order. Please contact support if this persists."),this.updateOrderReview();const r=document.getElementById("project-requirements"),o=document.getElementById("payment-section");if(r&&(r.classList.add("hidden"),r.style.display="none"),o){o.classList.remove("hidden"),o.style.setProperty("display","block","important"),o.style.setProperty("visibility","visible","important"),o.style.setProperty("opacity","1","important"),o.style.setProperty("position","relative","important"),o.style.setProperty("z-index","999","important"),o.style.setProperty("height","auto","important"),o.style.setProperty("width","100%","important"),o.style.setProperty("background-color","#ffffff","important");const n=document.getElementById("payment-loading"),i=document.getElementById("payment-content");n&&(n.classList.remove("hidden"),n.style.display="block"),i&&(i.style.display="none"),this.updatePaymentSummary(),setTimeout(()=>{n&&(n.classList.add("hidden"),n.style.display="none"),i&&(i.style.display="block"),o.scrollIntoView({behavior:"smooth"})},500)}setTimeout(()=>{e.innerHTML=t,e.disabled=!1,this.isSubmitting=!1},3e3)}}showProjectTypeFields(){if(this.items.length===0)return;const e=this.items[0];console.log("üîç Debug - Product ID:",e.id);const t=document.getElementById("app-name-fields"),a=document.getElementById("product-description-fields"),r=document.getElementById("restaurant-fields"),o=document.getElementById("restaurant-cuisine-fields");console.log("üîç Debug - Field elements found:",{appNameFields:!!t,productDescriptionFields:!!a,restaurantFields:!!r,restaurantCuisineFields:!!o});const n=document.getElementById("upload-label"),i=document.getElementById("upload-text"),s=document.getElementById("photos-label"),l=document.getElementById("photos-text");if(t?.classList.add("hidden"),a?.classList.add("hidden"),r?.classList.add("hidden"),o?.classList.add("hidden"),e.id==="restaurant-menu"||e.id==="restaurant-menu-system"||e.id==="restaurant-website"||e.id==="1"||e.id==="4"){console.log("üçï Showing restaurant fields for restaurant product:",e.id),r&&(r.classList.remove("hidden"),r.style.display="block"),o&&(o.classList.remove("hidden"),o.style.display="block"),console.log("üîç Debug - Restaurant fields visibility:",{restaurantFieldsHidden:r?.classList.contains("hidden"),restaurantCuisineFieldsHidden:o?.classList.contains("hidden"),restaurantFieldsDisplay:r?.style.display,restaurantCuisineFieldsDisplay:o?.style.display});const c=document.querySelector('input[name="restaurantName"]'),u=document.querySelector('select[name="cuisineType"]');c&&(c.required=!0),u&&(u.required=!0);const f=document.getElementById("logo-upload-section"),b=document.getElementById("photos-upload-section");f&&(f.classList.remove("hidden"),f.style.display="block"),b&&(b.classList.remove("hidden"),b.style.display="block");const w=document.querySelector('input[name="projectName"]'),h=document.querySelector('input[name="contactPerson"]'),g=document.querySelector('input[name="appName"]'),y=document.querySelector('textarea[name="productDescription"]');w&&(w.closest("div").classList.remove("hidden"),w.required=!0),h&&(h.closest("div").classList.remove("hidden"),h.required=!0),g&&(g.closest("div").classList.remove("hidden"),g.required=!0),y&&(y.closest("div").classList.remove("hidden"),y.required=!0),n&&(n.textContent="Restaurant Logo"),i&&(i.textContent="Upload logo or drag and drop"),s&&(s.textContent="Menu Photos (Required)"),l&&(l.textContent="Upload menu photos or drag and drop")}else if(e.id==="order-menu-system"||e.id==="5"){console.log("üçΩÔ∏è Showing Order Menu System fields for product:",e.id);const c=document.getElementById("order-menu-fields");c&&(c.classList.remove("hidden"),c.style.display="block"),N&&(N.classList.add("hidden"),N.style.display="none"),I&&(I.classList.add("hidden"),I.style.display="none");const u=document.getElementById("logo-upload-section"),f=document.getElementById("photos-upload-section");u&&(u.classList.add("hidden"),u.style.display="none"),f&&(f.classList.add("hidden"),f.style.display="none");const b=document.querySelector('input[name="orderMenuRestaurantName"]'),w=document.querySelector('input[name="orderMenuOwnerName"]'),h=document.querySelector('textarea[name="orderMenuAddress"]');b&&(b.required=!0),w&&(w.required=!0),h&&(h.required=!0);const g=document.querySelector('input[name="projectName"]'),y=document.querySelector('input[name="contactPerson"]'),C=document.querySelector('input[name="appName"]'),v=document.querySelector('textarea[name="productDescription"]');g&&(g.required=!0),y&&(y.required=!0),C&&(C.closest("div").classList.add("hidden"),C.required=!1),v&&(v.closest("div").classList.add("hidden"),v.required=!1),document.querySelectorAll(".non-order-menu-fields").forEach(S=>{S.classList.add("hidden"),S.style.display="none"});const N=document.getElementById("restaurant-fields"),I=document.getElementById("restaurant-cuisine-fields");N&&N.classList.add("hidden"),I&&I.classList.add("hidden"),document.querySelectorAll(".non-order-menu-fields").forEach(S=>{S.classList.remove("hidden"),S.style.display="block"})}else{console.log("üì± Showing non-restaurant fields for product:",e.id);const c=document.getElementById("order-menu-fields");c&&(c.classList.add("hidden"),c.style.display="none",console.log("üö´ Order Menu System fields hidden for non-Order Menu System product")),document.querySelectorAll("#order-menu-fields [required]").forEach(y=>{y.required=!1}),o&&(o.classList.add("hidden"),o.style.display="none",console.log("üö´ Cuisine type field hidden for non-restaurant product")),document.querySelectorAll(".non-order-menu-fields").forEach(y=>{y.classList.remove("hidden"),y.style.display="block"});const b=document.querySelector('input[name="projectName"]'),w=document.querySelector('input[name="contactPerson"]'),h=document.querySelector('input[name="appName"]'),g=document.querySelector('textarea[name="productDescription"]');b&&(b.closest("div").classList.remove("hidden"),b.required=!0),w&&(w.closest("div").classList.remove("hidden"),w.required=!0),h&&(h.closest("div").classList.remove("hidden"),h.required=!0),g&&(g.closest("div").classList.remove("hidden"),g.required=!0),e.id==="android-tv"||e.id==="android-tv-app"?(console.log("üì∫ Showing TV app fields"),n&&(n.textContent="App Icon"),i&&(i.textContent="Upload app icon or drag and drop"),s&&(s.textContent="App Screenshots (Optional)"),l&&(l.textContent="Upload app screenshots or drag and drop")):e.id==="mobile-streaming"||e.id==="streaming-mobile-app"?(console.log("üì± Showing mobile app fields"),n&&(n.textContent="App Icon"),i&&(i.textContent="Upload app icon or drag and drop"),s&&(s.textContent="App Screenshots (Optional)"),l&&(l.textContent="Upload app screenshots or drag and drop")):(n&&(n.textContent="App Icon"),i&&(i.textContent="Upload app icon or drag and drop"),s&&(s.textContent="App Screenshots (Optional)"),l&&(l.textContent="Upload app screenshots or drag and drop"))}const d=document.querySelector('input[name="appName"]');d&&(d.required=!0)}prefillRequirementsForm(){const t=(window.globalAuthManager||window.simpleAuthManager)?.getCurrentUser();if(!t)return;const a=document.querySelector('input[name="email"]'),r=document.querySelector('input[name="phone"]');a&&(a.value=t.email||""),r&&(r.value=t.phone||""),this.setupFileUploads()}setupFileUploads(){const e=document.getElementById("logo-upload");e&&e.addEventListener("change",a=>{const r=a.target.files[0];r&&(this.showUploadSuccess("logo-upload",r.name),this.items.length>0&&(this.items[0].logo=r,console.log("Logo stored:",r.name)))});const t=document.getElementById("menu-upload");t&&t.addEventListener("change",a=>{const r=Array.from(a.target.files);r.length>0&&(this.showUploadSuccess("photos-upload",`${r.length} files selected`),this.items.length>0&&(this.items[0].photos=r,console.log("Photos stored:",r.map(o=>o.name))))}),this.setupDragAndDrop()}setupFormChangeListeners(){console.log("üö´ Auto-save disabled to prevent duplicate entries")}setupDragAndDrop(){const e=document.querySelector("#logo-upload-section .border-dashed"),t=document.querySelector("#photos-upload-section .border-dashed");e&&(e.addEventListener("dragover",a=>{a.preventDefault(),e.classList.add("border-primary-400","bg-primary-50")}),e.addEventListener("dragleave",a=>{a.preventDefault(),e.classList.remove("border-primary-400","bg-primary-50")}),e.addEventListener("drop",a=>{a.preventDefault(),e.classList.remove("border-primary-400","bg-primary-50");const r=Array.from(a.dataTransfer.files);if(r.length>0){const o=r[0];document.getElementById("logo-upload").files=a.dataTransfer.files,this.showUploadSuccess("logo-upload",o.name),this.items.length>0&&(this.items[0].logo=o)}})),t&&(t.addEventListener("dragover",a=>{a.preventDefault(),t.classList.add("border-primary-400","bg-primary-50")}),t.addEventListener("dragleave",a=>{a.preventDefault(),t.classList.remove("border-primary-400","bg-primary-50")}),t.addEventListener("drop",a=>{a.preventDefault(),t.classList.remove("border-primary-400","bg-primary-50");const r=Array.from(a.dataTransfer.files);r.length>0&&(document.getElementById("menu-upload").files=a.dataTransfer.files,this.showUploadSuccess("photos-upload",`${r.length} files selected`),this.items.length>0&&(this.items[0].photos=r))}))}showUploadSuccess(e,t){const a=document.getElementById(e==="logo-upload"?"upload-status":"photos-status");a&&(a.textContent=`‚úì ${t}`,a.className="mt-3 text-sm font-medium text-green-600",a.classList.remove("hidden"),setTimeout(()=>{a.classList.add("hidden")},3e3))}backToCart(){const e=document.getElementById("project-requirements"),t=document.getElementById("cart-actions");e&&e.classList.add("hidden"),t&&t.classList.remove("hidden"),t?.scrollIntoView({behavior:"smooth"})}async saveCartToSupabase(){try{console.log("üîç Starting saveCartToSupabase...");const e=window.globalAuthManager||window.simpleAuthManager;console.log("üîç Auth manager found:",!!e);const t=e?.getCurrentUser();if(console.log("üîç Current user:",t),!t||this.items.length===0)return console.log("‚ùå No user or items found for Supabase save"),console.log("‚ùå User:",t),console.log("‚ùå Items length:",this.items.length),null;const a=this.items[0];if(console.log("üîç Debug - Item being saved:",a),console.log("üîç Debug - Current user:",t),!B)return console.error("‚ùå Supabase client not available"),null;const r=document.getElementById("requirements-form");let o={};const n=a&&(a.id==="order-menu-system"||a.id==="5");r&&(n?(o={projectName:r.querySelector('[name="projectName"]')?.value||"",contactPerson:r.querySelector('[name="contactPerson"]')?.value||"",restaurantName:r.querySelector('[name="orderMenuRestaurantName"]')?.value||"",ownerName:r.querySelector('[name="orderMenuOwnerName"]')?.value||"",houseNumber:r.querySelector('[name="houseNumber"]')?.value||"",addressLine1:r.querySelector('[name="addressLine1"]')?.value||"",city:r.querySelector('[name="city"]')?.value||"",state:r.querySelector('[name="state"]')?.value||"",pincode:r.querySelector('[name="pincode"]')?.value||"",country:r.querySelector('[name="country"]')?.value||"India",email:r.querySelector('[name="email"]')?.value||"",phone:r.querySelector('[name="phone"]')?.value||"",menuItems:this.collectMenuItems(),additionalRequirements:r.querySelector('[name="additionalRequirements"]')?.value||""},console.log("üçΩÔ∏è Form data collected for Order Menu System:",o)):o={projectName:r.querySelector('[name="projectName"]')?.value||"",contactPerson:r.querySelector('[name="contactPerson"]')?.value||"",restaurantName:r.querySelector('[name="restaurantName"]')?.value||"",cuisineType:r.querySelector('[name="cuisineType"]')?.value||r.querySelector('[name="emergencyCuisineType"]')?.value||"",appName:r.querySelector('[name="appName"]')?.value||"",email:r.querySelector('[name="email"]')?.value||"",phone:r.querySelector('[name="phone"]')?.value||"",additionalRequirements:r.querySelector('[name="additionalRequirements"]')?.value||""});const i=a.price,s=a.features.reduce((S,q)=>S+({responsive:500,seo:300,analytics:200}[q]||0),0),l=i+s,d=Math.round(l*.18),c=l+d,u=document.querySelector('input[name="restaurantLogo"]')?.files?.[0],f=document.querySelector('input[name="menuPhotos"]')?.files;let b="",w="",h=0,g="",y="",C=[],v=[],k=[],N=[],I=[];u&&(console.log("üì∏ Processing restaurant logo upload:",u.name),w=u.name,h=u.size,g=u.type,b=`pending_upload_${Date.now()}_${u.name}`,y=`hash_${u.name}_${u.size}_${Date.now()}`),f&&f.length>0&&(console.log("üì∏ Processing menu photos upload:",f.length,"files"),Array.from(f).forEach(S=>{v.push(S.name),k.push(S.size),N.push(S.type),C.push(`pending_upload_${Date.now()}_${S.name}`),I.push(`hash_${S.name}_${S.size}_${Date.now()}`)}));let p;if(n?p={user_email:t.email,user_id:t.id||null,product_id:"order-menu-system",product_name:"Order Menu System",base_price:a.price,total_amount:c,project_name:o.projectName||"",contact_person:o.contactPerson||"",restaurant_name:o.restaurantName||"",owner_name:o.ownerName||"",app_icon_url:null,app_icon_filename:null,app_icon_size:null,app_icon_type:null,house_flat_number:o.houseNumber||"",address_line_1:o.addressLine1||"",city:o.city||"",state:o.state||"",pincode:o.pincode||"",country:o.country||"India",restaurant_logo_url:b,restaurant_logo_filename:w,restaurant_logo_size:h,restaurant_logo_type:g,menu_photos_urls:C||[],contact_email:o.email||t.email,contact_phone:o.phone||t.phone||"",base_package_cost:999,gst_amount:180,total_amount:1179,app_screenshots:[],additional_requirements:o.additionalRequirements||"",cart_status:"pending"}:p={user_email:t.email,user_id:t.id||null,product_id:a.id,product_name:a.name,product_description:a.description,base_price:a.price,total_amount:c,custom_name:a.customName||"",restaurant_name_customization:a.restaurantName||"",selected_color:a.color||"#3B82F6",selected_features:a.features||[],project_name:o.projectName||"",contact_person:o.contactPerson||"",restaurant_name:o.restaurantName||"",cuisine_type:o.cuisineType||"",app_name:o.appName||"",product_description_custom:o.productDescription||"",contact_email:o.email||t.email,contact_phone:o.phone||t.phone||"",primary_color:primaryColor,secondary_color:secondaryColor,accent_color:accentColor,text_color:textColor,restaurant_logo_url:b,restaurant_logo_filename:w,restaurant_logo_size:h,restaurant_logo_type:g,restaurant_logo_hash:y,menu_photos_urls:C,menu_photos_filenames:v,menu_photos_sizes:k,menu_photos_types:N,menu_photos_hashes:I,additional_requirements:o.additionalRequirements||"",cart_status:"pending",is_checkout_initiated:!1},console.log("üîç Debug - Cart data being sent to Supabase:",p),console.log("üîç Debug - Form data collected:",o),console.log("üîç Debug - Current user:",t),n){console.log("üçΩÔ∏è Saving Order Menu System data to order_customizations table..."),console.log("üîç Cart data being inserted:",p);const S={project_name:p.project_name||o.projectName||"Default Project",restaurant_name:p.restaurant_name||o.restaurantName||"Default Restaurant",owner_name:p.owner_name||o.ownerName||"Default Owner",contact_person:p.contact_person||o.contactPerson||"Default Contact",email:p.contact_email||o.email||t.email,phone_number:p.contact_phone||o.phone||"",house_flat_number:p.house_flat_number||o.houseNumber||"",address_line_1:p.address_line_1||o.addressLine1||"",city:p.city||o.city||"",state:p.state||o.state||"",pincode:p.pincode||o.pincode||"",country:p.country||o.country||"India",restaurant_logo_url:p.restaurant_logo_url||null,menu_photos_urls:p.menu_photos_urls||[],additional_requirements:p.additional_requirements||o.additionalRequirements||"",base_package_cost:p.base_package_cost||999,gst_amount:p.gst_amount||180,total_amount:p.total_amount||1179};console.log("üîç Debug - Final insert data:",S);const{data:q,error:M}=await B.from("order_customizations").insert(S).select();if(M)return console.error("‚ùå Error saving Order Menu System customization:",M),console.error("‚ùå Error details:",JSON.stringify(M,null,2)),console.error("‚ùå Cart data that failed:",JSON.stringify(p,null,2)),console.error("‚ùå Insert data that failed:",JSON.stringify(S,null,2)),null;if(q&&q.length>0)console.log("‚úÖ Order customization saved successfully:",q[0]),p.customization_id=q[0].id;else return console.error("‚ùå No data returned from insert operation"),null}else{console.log("üîç Testing Supabase connection for standard cart...");const{data:S,error:q}=await B.from("cart_customizations").select("*").limit(1);if(q)return console.error("‚ùå Supabase connection test failed:",q),null;console.log("‚úÖ Supabase connection test successful"),console.log("üöÄ Attempting to save to Supabase using simple upsert function...");const{data:M,error:j}=await B.rpc("upsert_cart_customization",{p_user_email:t.email,p_user_id:t.id||null,p_product_id:a.id,p_product_name:a.name,p_product_description:a.description,p_base_price:a.price,p_total_amount:c,p_project_name:o.projectName||"",p_app_name:o.appName||"",p_contact_person:o.contactPerson||"",p_product_description_custom:o.productDescription||"",p_restaurant_name:o.restaurantName||"",p_cuisine_type:o.cuisineType||"",p_contact_email:o.email||t.email,p_contact_phone:o.phone||t.phone||"",p_restaurant_logo_url:b,p_restaurant_logo_filename:w,p_restaurant_logo_size:h,p_restaurant_logo_type:g,p_restaurant_logo_hash:y,p_menu_photos_urls:C,p_menu_photos_filenames:v,p_menu_photos_sizes:k,p_menu_photos_types:N,p_menu_photos_hashes:I,p_primary_color:primaryColor,p_secondary_color:secondaryColor,p_accent_color:accentColor,p_text_color:textColor,p_additional_requirements:o.additionalRequirements||""});if(j){console.error("‚ùå Upsert function failed, trying direct upsert:",j);let{data:A,error:E}=await B.from("cart_customizations").upsert([p],{onConflict:"user_email,product_id"}).select();if(E){console.warn("‚ö†Ô∏è Direct upsert failed, trying insert as fallback:",E);const L=await B.from("cart_customizations").insert([p]).select();L.error?(console.error("‚ùå Insert also failed:",L.error),E=L.error):(console.log("‚úÖ Insert successful as fallback"),A=L.data,E=null)}return E?(console.error("‚ùå All save methods failed:",E),null):(console.log("‚úÖ Cart saved successfully via fallback method"),A[0])}else{console.log("‚úÖ Cart saved successfully via upsert function"),console.log("üîç Upsert result:",M);const{data:A,error:E}=await B.from("cart_customizations").select("*").eq("id",M).single();return E?(console.error("‚ùå Failed to fetch saved cart:",E),null):A}}}catch(e){return console.error("‚ùå Error in saveCartToSupabase:",e),console.error("‚ùå Error stack:",e.stack),null}}async markOrderAsCompleted(e){try{console.log("üí≥ Marking order as completed:",e);const a=(window.globalAuthManager||window.simpleAuthManager)?.getCurrentUser();if(!a)return console.error("‚ùå No user found for order completion"),!1;const r=window.supabase?.createClient("https://lmrrdcaavwwletcjcpqv.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxtcnJkY2Fhdnd3bGV0Y2pjcHF2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU1MDQ0ODgsImV4cCI6MjA3MTA4MDQ4OH0.AU59Qfr6K9i880Gcn5y-3pjCf8PXsDIq4OI0-lPQVuQ"),{data:o,error:n}=await r.from("cart_customizations").update({cart_status:"completed",updated_at:new Date().toISOString()}).eq("id",e).eq("user_email",a.email);return n?(console.error("‚ùå Error marking order as completed:",n),!1):(console.log("‚úÖ Order marked as completed successfully"),!0)}catch(t){return console.error("‚ùå Error in markOrderAsCompleted:",t),!1}}async cancelOrder(e){try{console.log("‚ùå Cancelling order:",e);const a=(window.globalAuthManager||window.simpleAuthManager)?.getCurrentUser();if(!a)return console.error("‚ùå No user found for order cancellation"),!1;const r=window.supabase?.createClient("https://lmrrdcaavwwletcjcpqv.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxtcnJkY2Fhdnd3bGV0Y2pjcHF2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU1MDQ0ODgsImV4cCI6MjA3MTA4MDQ4OH0.AU59Qfr6K9i880Gcn5y-3pjCf8PXsDIq4OI0-lPQVuQ"),{data:o,error:n}=await r.from("cart_customizations").update({cart_status:"cancelled",updated_at:new Date().toISOString()}).eq("id",e).eq("user_email",a.email);return n?(console.error("‚ùå Error cancelling order:",n),!1):(console.log("‚úÖ Order cancelled successfully"),!0)}catch(t){return console.error("‚ùå Error in cancelOrder:",t),!1}}calculateTotal(){const e=this.items.reduce((r,o)=>r+o.price*o.quantity,0),t=this.items.reduce((r,o)=>{const n={responsive:500,seo:300,analytics:200};return r+o.features.reduce((i,s)=>i+(n[s]||0),0)},0),a=(e+t)*.18;return Math.round(e+t+a)}declineOrder(){confirm("Are you sure you want to decline this order? You will be redirected to products page.")&&(this.items=[],this.saveCart(),window.location.href="/products")}deleteItem(){confirm("Are you sure you want to delete this item? You will be redirected to products page.")&&(this.items=[],this.saveCart(),window.location.href="/products")}switchPaymentMethod(e){const t=document.getElementById("card-details"),a=document.getElementById("upi-details"),r=document.getElementById("netbanking-details");switch(t?.classList.add("hidden"),a?.classList.add("hidden"),r?.classList.add("hidden"),e){case"card":t?.classList.remove("hidden");break;case"upi":a?.classList.remove("hidden");break;case"netbanking":r?.classList.remove("hidden");break}}updateOrderReview(){console.log("üîÑ Updating order review with data:",this.requirements);try{const e=this.items[0];if(e&&(e.id==="order-menu-system"||e.id==="5")){const h=document.getElementById("review-order-menu-info");h&&h.classList.remove("hidden");const g=document.getElementById("review-restaurant-name"),y=document.getElementById("review-restaurant-address"),C=document.getElementById("review-contact-email"),v=document.getElementById("review-contact-phone");if(g&&(g.textContent=this.requirements.restaurantName||"-"),y){const k=[this.requirements.houseNumber,this.requirements.addressLine1,this.requirements.city,this.requirements.state,this.requirements.pincode,this.requirements.country].filter(Boolean).join(", ");y.textContent=k||"-"}C&&(C.textContent=this.requirements.email||"-"),v&&(v.textContent=this.requirements.phone||"-")}else{const h=document.getElementById("review-order-menu-info");h&&h.classList.add("hidden");const g=document.getElementById("review-project-name"),y=document.getElementById("review-contact-person"),C=document.getElementById("review-app-name");g&&(g.textContent=this.requirements.projectName||"-"),y&&(y.textContent=this.requirements.contactPerson||"-"),C&&(C.textContent=this.requirements.appName||"-");const v=document.getElementById("review-restaurant-info"),k=document.getElementById("review-cuisine-info"),N=document.getElementById("review-restaurant-name"),I=document.getElementById("review-cuisine-type");e&&(e.id==="restaurant-menu"||e.id==="restaurant-menu-system"||e.id==="restaurant-website"||e.id==="1"||e.id==="4")?(v&&v.classList.remove("hidden"),k&&k.classList.remove("hidden"),N&&(N.textContent=this.requirements.restaurantName||"-"),I&&(I.textContent=this.requirements.cuisineType||"-")):(v&&v.classList.add("hidden"),k&&k.classList.add("hidden"))}const a=document.getElementById("review-primary-color"),r=document.getElementById("review-secondary-color"),o=document.getElementById("review-accent-color"),n=document.getElementById("review-text-color");a&&(a.style.backgroundColor=primaryColor),r&&(r.style.backgroundColor=secondaryColor),o&&(o.style.backgroundColor=accentColor),n&&(n.style.backgroundColor=textColor);const i=document.getElementById("logo-upload")?.files[0],s=document.getElementById("menu-upload")?.files,l=document.getElementById("review-logo-status"),d=document.getElementById("review-photos-status");l&&(l.textContent=i?`‚úì ${i.name}`:"Not uploaded"),d&&(d.textContent=s&&s.length>0?`‚úì ${s.length} photos selected`:"Not uploaded");const c=document.getElementById("review-total");if(c){const h=this.calculateTotal();c.textContent=`‚Çπ${h.toLocaleString()}`}const u=document.getElementById("final-amount");if(u){const h=this.calculateTotal();u.textContent=h.toLocaleString()}const f=document.getElementById("review-email"),b=document.getElementById("review-phone");f&&(f.textContent=this.requirements.email||"-"),b&&(b.textContent=this.requirements.phone||"-");const w=document.getElementById("review-additional-requirements");w&&(w.textContent=this.requirements.additionalRequirements||"No additional requirements specified"),console.log("‚úÖ Order review updated successfully")}catch(e){console.error("‚ùå Error updating order review:",e)}}backToRequirements(){const e=document.getElementById("order-review"),t=document.getElementById("project-requirements");e&&e.classList.add("hidden"),t&&t.classList.remove("hidden"),t?.scrollIntoView({behavior:"smooth"})}async proceedToPayment(){await this.createOrder(),this.showPaymentSection()}showPaymentSection(){const e=document.getElementById("project-requirements"),t=document.getElementById("payment-section");e&&e.classList.add("hidden"),t&&t.classList.remove("hidden"),this.updatePaymentSummary(),t?.scrollIntoView({behavior:"smooth"})}updatePaymentSummary(){try{console.log("üîÑ Updating payment summary..."),console.log("üìù Requirements data:",this.requirements);const e=document.getElementById("payment-project-name"),t=document.getElementById("payment-contact-person"),a=document.getElementById("payment-app-name"),r=document.getElementById("payment-email"),o=document.getElementById("payment-phone"),n=document.getElementById("payment-total-amount");if(console.log("üîç Payment elements found:",{projectNameEl:!!e,contactPersonEl:!!t,appNameEl:!!a,emailEl:!!r,phoneEl:!!o,totalAmountEl:!!n}),e&&(e.textContent=this.requirements.projectName||"-",console.log("‚úÖ Updated project name:",this.requirements.projectName)),t&&(t.textContent=this.requirements.contactPerson||"-",console.log("‚úÖ Updated contact person:",this.requirements.contactPerson)),a&&(a.textContent=this.requirements.appName||"-",console.log("‚úÖ Updated app name:",this.requirements.appName)),r&&(r.textContent=this.requirements.email||"-",console.log("‚úÖ Updated email:",this.requirements.email)),o&&(o.textContent=this.requirements.phone||"-",console.log("‚úÖ Updated phone:",this.requirements.phone)),n){const s=this.calculateTotal();n.textContent=s.toLocaleString(),console.log("‚úÖ Updated total amount:",s)}const i=document.getElementById("final-amount");if(i){const s=this.calculateTotal();i.textContent=s.toLocaleString(),console.log("‚úÖ Updated final payment amount:",s)}console.log("‚úÖ Payment summary updated successfully")}catch(e){console.error("‚ùå Error updating payment summary:",e)}}processFinalPayment(){const e=document.querySelector('input[name="paymentMethod"]:checked')?.value;if(!e){alert("Please select a payment method");return}let t=!0,a="";switch(e){case"card":const r=document.querySelector('input[name="cardNumber"]').value,o=document.querySelector('input[name="cardholderName"]').value,n=document.querySelector('input[name="expiryDate"]').value,i=document.querySelector('input[name="cvv"]').value;(!r||!o||!n||!i)&&(t=!1,a="Please fill in all card details");break;case"upi":document.querySelector('input[name="upiId"]').value||(t=!1,a="Please enter your UPI ID");break;case"netbanking":document.querySelector('select[name="bank"]').value||(t=!1,a="Please select your bank");break}if(!t){alert(a);return}this.simulatePayment()}simulatePayment(){const e=document.getElementById("final-payment");e.innerHTML,e.innerHTML=`
        <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white inline" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
        </svg>
        Processing Payment...
      `,e.disabled=!0,setTimeout(()=>{this.saveOrderToHistory(),this.updateOrderStatusToConfirmed(),this.items=[],this.saveCart(),e.innerHTML=`
          <svg class="w-5 h-5 text-white inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
          </svg>
          Payment Successful!
        `,setTimeout(()=>{window.location.href="/orders?order=success"},2e3)},3e3)}saveOrderToHistory(){if(this.items.length===0)return;const t=(window.globalAuthManager||window.simpleAuthManager)?.getCurrentUser();if(!t)return;const a=this.items[0],r=this.calculateTotal(),o={userId:t.email,customerName:t.fullName||"User",customerEmail:t.email,serviceName:a.name,serviceType:"web_development",status:"cart",paymentStatus:"pending",amount:r,currency:"INR",requirements:{customName:a.customName||"",logo:a.logo||null,features:a.features||[],description:a.description}};try{const l=T.createOrder(o);console.log("Order saved to shared store:",l),this.currentSharedOrderId=l.id;const d=T.getOrders();console.log("All orders in shared store after creation:",d),console.log("Current shared order ID:",this.currentSharedOrderId)}catch(l){console.error("Error saving to shared store:",l)}const n={orderId:`ORD-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,userId:t.email,projectName:a.name,description:a.description,total:r,orderDate:new Date().toISOString(),requirements:{...this.requirements,primaryColor,secondaryColor,accentColor,textColor},features:a.features||[],logo:a.logo||null,color:a.color||"#3B82F6",customName:a.customName||""};let i=[];const s=localStorage.getItem("user-orders");s&&(i=JSON.parse(s)),i.push(n),localStorage.setItem("user-orders",JSON.stringify(i)),console.log("Order saved to user orders:",n)}async createOrder(){if(this.items.length===0)return;const t=(window.globalAuthManager||window.simpleAuthManager)?.getCurrentUser();if(!t)return;const a=this.items[0],r=this.calculateTotal(),o=document.getElementById("requirements-form");let n={};const i=a&&(a.id==="order-menu-system"||a.id==="5");o&&(i?n={projectName:o.querySelector('[name="projectName"]')?.value||"",contactPerson:o.querySelector('[name="contactPerson"]')?.value||"",restaurantName:o.querySelector('[name="orderMenuRestaurantName"]')?.value||"",ownerName:o.querySelector('[name="orderMenuOwnerName"]')?.value||"",houseNumber:o.querySelector('[name="houseNumber"]')?.value||"",addressLine1:o.querySelector('[name="addressLine1"]')?.value||"",city:o.querySelector('[name="city"]')?.value||"",state:o.querySelector('[name="state"]')?.value||"",pincode:o.querySelector('[name="pincode"]')?.value||"",country:o.querySelector('[name="country"]')?.value||"India",email:o.querySelector('[name="email"]')?.value||"",phone:o.querySelector('[name="phone"]')?.value||"",additionalRequirements:o.querySelector('[name="additionalRequirements"]')?.value||""}:n={projectName:o.querySelector('[name="projectName"]')?.value||"",contactPerson:o.querySelector('[name="contactPerson"]')?.value||"",restaurantName:o.querySelector('[name="restaurantName"]')?.value||"",cuisineType:o.querySelector('[name="cuisineType"]')?.value||"",appName:o.querySelector('[name="appName"]')?.value||"",productDescription:o.querySelector('[name="productDescription"]')?.value||"",email:o.querySelector('[name="email"]')?.value||"",phone:o.querySelector('[name="phone"]')?.value||"",additionalRequirements:o.querySelector('[name="additionalRequirements"]')?.value||""});try{const s=await this.saveCartToSupabase();s?(console.log("‚úÖ Cart customization saved to Supabase:",s),this.currentSharedOrderId=s.id):console.error("‚ùå Failed to save cart data to Supabase");const l={userId:t.email,customerName:t.fullName||"User",customerEmail:t.email,serviceName:a.name,serviceType:i?"order_menu_system":"web_development",status:"pending",paymentStatus:"pending",amount:r,currency:"INR",requirements:{...n,primaryColor,secondaryColor,accentColor,textColor,customName:a.customName||"",logo:a.logo||null,features:a.features||[],description:a.description}},d=T.createOrder(l);console.log("Order created in shared store:",d);const c=T.getOrders();console.log("All orders in shared store after creation:",c),console.log("Current shared order ID:",this.currentSharedOrderId)}catch(s){console.error("Error creating order:",s)}}updateOrderStatusToPending(){if(this.currentSharedOrderId)try{T.updateOrderStatus(this.currentSharedOrderId,"pending","Payment initiated"),console.log("Order status updated to pending")}catch(e){console.error("Error updating order status:",e)}}updateOrderStatusToConfirmed(){if(this.currentSharedOrderId)try{T.updateOrderStatus(this.currentSharedOrderId,"confirmed","Payment successful - Order confirmed"),console.log("Order status updated to confirmed")}catch(e){console.error("Error updating order status:",e)}}debounce(e,t){let a;return function(...o){const n=()=>{clearTimeout(a),e(...o)};clearTimeout(a),a=setTimeout(n,t)}}}function F(){document.getElementById("menu-items-container").insertAdjacentHTML("beforeend",`
      <div class="menu-item border border-gray-300 rounded-lg p-4 mb-4">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div>
            <label class="block text-sm font-medium text-white mb-2">Item Name</label>
            <input type="text" name="menuItemName[]" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500" placeholder="e.g., Margherita Pizza">
          </div>
          <div>
            <label class="block text-sm font-medium text-white mb-2">Price (‚Çπ)</label>
            <input type="number" name="menuItemPrice[]" step="0.01" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500" placeholder="299">
          </div>
          <div>
            <label class="block text-sm font-medium text-white mb-2">Quantity Available</label>
            <input type="number" name="menuItemQuantity[]" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500" placeholder="50">
          </div>
        </div>
        <button type="button" onclick="removeMenuItem(this)" class="mt-2 text-red-500 hover:text-red-700 text-sm font-medium">Remove Item</button>
      </div>
    `)}function U(m){m.closest(".menu-item").remove()}window.addMenuItem=F;window.removeMenuItem=U;window.markOrderAsCompleted=async function(m){return window.cart?await window.cart.markOrderAsCompleted(m):(console.error("‚ùå Cart not initialized"),!1)};window.cancelOrder=async function(m){return window.cart?await window.cart.cancelOrder(m):(console.error("‚ùå Cart not initialized"),!1)};window.handlePaymentSuccess=async function(m){console.log("üí≥ Payment successful for order:",m);const e=await window.markOrderAsCompleted(m);alert(e?"‚úÖ Payment successful! Your order has been completed.":"‚ùå Error updating order status. Please contact support.")};window.handlePaymentFailure=async function(m){console.log("‚ùå Payment failed for order:",m),alert("‚ùå Payment failed. Please try again or contact support.")};window.handleOrderCancellation=async function(m){console.log("‚ùå Order cancelled:",m);const e=await window.cancelOrder(m);alert(e?"‚ùå Order has been cancelled.":"‚ùå Error cancelling order. Please contact support.")};window.clearCartForNewUser=function(){console.log("üßπ Clearing cart for new user"),window.cart&&(window.cart.items=[],window.cart.requirements={},localStorage.removeItem("cart-items"),localStorage.removeItem("cart-requirements"),localStorage.removeItem("user-cart-data"),console.log("‚úÖ Cart cleared for new user"))};window.clearCartOnUserChange=function(){console.log("üßπ Clearing cart due to user change"),window.cart&&(window.cart.items=[],window.cart.requirements={},localStorage.removeItem("cart-items"),localStorage.removeItem("cart-requirements"),localStorage.removeItem("user-cart-data"),console.log("‚úÖ Cart cleared due to user change"))};window.debugCartState=function(){console.log("üîç Cart Debug State:"),console.log("- Cart instance:",!!window.cart),console.log("- Cart items count:",window.cart?window.cart.items.length:0),console.log("- Cart items:",window.cart?window.cart.items:[]),console.log("- localStorage cart-items:",localStorage.getItem("cart-items")),console.log("- localStorage cart-requirements:",localStorage.getItem("cart-requirements")),console.log("- localStorage user-cart-data:",localStorage.getItem("user-cart-data"));const e=(window.globalAuthManager||window.simpleAuthManager)?.getCurrentUser();if(console.log("- Current user:",e?e.email:"Not logged in"),window.cart&&window.cart.items.length>0){const t=window.cart.items[0];console.log("- First item email:",t.email),console.log("- First item name:",t.name)}};window.validateCartOwnership=function(){const e=(window.globalAuthManager||window.simpleAuthManager)?.getCurrentUser();if(!e)return!0;if(window.cart&&window.cart.items.length>0){const t=window.cart.items[0];if(t.email&&t.email!==e.email)return console.log("‚ö†Ô∏è Cart belongs to different user, clearing..."),window.clearCartForNewUser(),!1}return!0};const O={400001:{city:"Mumbai",state:"Maharashtra"},400002:{city:"Mumbai",state:"Maharashtra"},400003:{city:"Mumbai",state:"Maharashtra"},400004:{city:"Mumbai",state:"Maharashtra"},400005:{city:"Mumbai",state:"Maharashtra"},400006:{city:"Mumbai",state:"Maharashtra"},400007:{city:"Mumbai",state:"Maharashtra"},400008:{city:"Mumbai",state:"Maharashtra"},400009:{city:"Mumbai",state:"Maharashtra"},400010:{city:"Mumbai",state:"Maharashtra"},110001:{city:"New Delhi",state:"Delhi"},110002:{city:"New Delhi",state:"Delhi"},110003:{city:"New Delhi",state:"Delhi"},110004:{city:"New Delhi",state:"Delhi"},110005:{city:"New Delhi",state:"Delhi"},110006:{city:"New Delhi",state:"Delhi"},110007:{city:"New Delhi",state:"Delhi"},110008:{city:"New Delhi",state:"Delhi"},110009:{city:"New Delhi",state:"Delhi"},110010:{city:"New Delhi",state:"Delhi"},560001:{city:"Bangalore",state:"Karnataka"},560002:{city:"Bangalore",state:"Karnataka"},560003:{city:"Bangalore",state:"Karnataka"},560004:{city:"Bangalore",state:"Karnataka"},560005:{city:"Bangalore",state:"Karnataka"},560006:{city:"Bangalore",state:"Karnataka"},560007:{city:"Bangalore",state:"Karnataka"},560008:{city:"Bangalore",state:"Karnataka"},560009:{city:"Bangalore",state:"Karnataka"},560010:{city:"Bangalore",state:"Karnataka"},600001:{city:"Chennai",state:"Tamil Nadu"},600002:{city:"Chennai",state:"Tamil Nadu"},600003:{city:"Chennai",state:"Tamil Nadu"},600004:{city:"Chennai",state:"Tamil Nadu"},600005:{city:"Chennai",state:"Tamil Nadu"},600006:{city:"Chennai",state:"Tamil Nadu"},600007:{city:"Chennai",state:"Tamil Nadu"},600008:{city:"Chennai",state:"Tamil Nadu"},600009:{city:"Chennai",state:"Tamil Nadu"},600010:{city:"Chennai",state:"Tamil Nadu"},700001:{city:"Kolkata",state:"West Bengal"},700002:{city:"Kolkata",state:"West Bengal"},700003:{city:"Kolkata",state:"West Bengal"},700004:{city:"Kolkata",state:"West Bengal"},700005:{city:"Kolkata",state:"West Bengal"},700006:{city:"Kolkata",state:"West Bengal"},700007:{city:"Kolkata",state:"West Bengal"},700008:{city:"Kolkata",state:"West Bengal"},700009:{city:"Kolkata",state:"West Bengal"},700010:{city:"Kolkata",state:"West Bengal"},380001:{city:"Ahmedabad",state:"Gujarat"},380002:{city:"Ahmedabad",state:"Gujarat"},380003:{city:"Ahmedabad",state:"Gujarat"},380004:{city:"Ahmedabad",state:"Gujarat"},380005:{city:"Ahmedabad",state:"Gujarat"},380006:{city:"Ahmedabad",state:"Gujarat"},380007:{city:"Ahmedabad",state:"Gujarat"},380008:{city:"Ahmedabad",state:"Gujarat"},380009:{city:"Ahmedabad",state:"Gujarat"},380010:{city:"Ahmedabad",state:"Gujarat"},411001:{city:"Pune",state:"Maharashtra"},411002:{city:"Pune",state:"Maharashtra"},411003:{city:"Pune",state:"Maharashtra"},411004:{city:"Pune",state:"Maharashtra"},411005:{city:"Pune",state:"Maharashtra"},411006:{city:"Pune",state:"Maharashtra"},411007:{city:"Pune",state:"Maharashtra"},411008:{city:"Pune",state:"Maharashtra"},411009:{city:"Pune",state:"Maharashtra"},411010:{city:"Pune",state:"Maharashtra"},302001:{city:"Jaipur",state:"Rajasthan"},302002:{city:"Jaipur",state:"Rajasthan"},302003:{city:"Jaipur",state:"Rajasthan"},302004:{city:"Jaipur",state:"Rajasthan"},302005:{city:"Jaipur",state:"Rajasthan"},302006:{city:"Jaipur",state:"Rajasthan"},302007:{city:"Jaipur",state:"Rajasthan"},302008:{city:"Jaipur",state:"Rajasthan"},302009:{city:"Jaipur",state:"Rajasthan"},302010:{city:"Jaipur",state:"Rajasthan"},641001:{city:"Coimbatore",state:"Tamil Nadu"},641002:{city:"Coimbatore",state:"Tamil Nadu"},641003:{city:"Coimbatore",state:"Tamil Nadu"},641004:{city:"Coimbatore",state:"Tamil Nadu"},641005:{city:"Coimbatore",state:"Tamil Nadu"},625001:{city:"Madurai",state:"Tamil Nadu"},625002:{city:"Madurai",state:"Tamil Nadu"},625003:{city:"Madurai",state:"Tamil Nadu"},625004:{city:"Madurai",state:"Tamil Nadu"},625005:{city:"Madurai",state:"Tamil Nadu"},570001:{city:"Mysore",state:"Karnataka"},570002:{city:"Mysore",state:"Karnataka"},570003:{city:"Mysore",state:"Karnataka"},570004:{city:"Mysore",state:"Karnataka"},570005:{city:"Mysore",state:"Karnataka"},580001:{city:"Hubli",state:"Karnataka"},580002:{city:"Hubli",state:"Karnataka"},580003:{city:"Hubli",state:"Karnataka"},580004:{city:"Hubli",state:"Karnataka"},580005:{city:"Hubli",state:"Karnataka"},500001:{city:"Hyderabad",state:"Telangana"},500002:{city:"Hyderabad",state:"Telangana"},500003:{city:"Hyderabad",state:"Telangana"},500004:{city:"Hyderabad",state:"Telangana"},500005:{city:"Hyderabad",state:"Telangana"},500006:{city:"Hyderabad",state:"Telangana"},500007:{city:"Hyderabad",state:"Telangana"},500008:{city:"Hyderabad",state:"Telangana"},500009:{city:"Hyderabad",state:"Telangana"},500010:{city:"Hyderabad",state:"Telangana"},110001:{city:"Delhi",state:"Delhi"},110002:{city:"Delhi",state:"Delhi"},110003:{city:"Delhi",state:"Delhi"},110004:{city:"Delhi",state:"Delhi"},110005:{city:"Delhi",state:"Delhi"},110006:{city:"Delhi",state:"Delhi"},110007:{city:"Delhi",state:"Delhi"},110008:{city:"Delhi",state:"Delhi"},110009:{city:"Delhi",state:"Delhi"},110010:{city:"Delhi",state:"Delhi"},560001:{city:"Bangalore",state:"Karnataka"},560002:{city:"Bangalore",state:"Karnataka"},560003:{city:"Bangalore",state:"Karnataka"},560004:{city:"Bangalore",state:"Karnataka"},560005:{city:"Bangalore",state:"Karnataka"},560006:{city:"Bangalore",state:"Karnataka"},560007:{city:"Bangalore",state:"Karnataka"},560008:{city:"Bangalore",state:"Karnataka"},560009:{city:"Bangalore",state:"Karnataka"},560010:{city:"Bangalore",state:"Karnataka"},600001:{city:"Chennai",state:"Tamil Nadu"},600002:{city:"Chennai",state:"Tamil Nadu"},600003:{city:"Chennai",state:"Tamil Nadu"},600004:{city:"Chennai",state:"Tamil Nadu"},600005:{city:"Chennai",state:"Tamil Nadu"},600006:{city:"Chennai",state:"Tamil Nadu"},600007:{city:"Chennai",state:"Tamil Nadu"},600008:{city:"Chennai",state:"Tamil Nadu"},600009:{city:"Chennai",state:"Tamil Nadu"},600010:{city:"Chennai",state:"Tamil Nadu"},700001:{city:"Kolkata",state:"West Bengal"},700002:{city:"Kolkata",state:"West Bengal"},700003:{city:"Kolkata",state:"West Bengal"},700004:{city:"Kolkata",state:"West Bengal"},700005:{city:"Kolkata",state:"West Bengal"},700006:{city:"Kolkata",state:"West Bengal"},700007:{city:"Kolkata",state:"West Bengal"},700008:{city:"Kolkata",state:"West Bengal"},700009:{city:"Kolkata",state:"West Bengal"},700010:{city:"Kolkata",state:"West Bengal"}},J=["Mumbai","Delhi","Bangalore","Chennai","Kolkata","Hyderabad","Pune","Ahmedabad","Jaipur","Surat","Lucknow","Kanpur","Nagpur","Indore","Thane","Bhopal","Visakhapatnam","Pimpri-Chinchwad","Patna","Vadodara","Ghaziabad","Ludhiana","Agra","Nashik","Faridabad","Meerut","Rajkot","Kalyan-Dombivali","Vasai-Virar","Varanasi","Srinagar","Aurangabad","Navi Mumbai","Solapur","Vijayawada","Kolhapur","Amritsar","Sangli","Mira-Bhayandar","Alwar","Bharatpur","Kota","Udaipur","Jodhpur","Bikaner","Ajmer","Pali","Sikar","Bhilwara","Kishangarh","Beawar","Hanumangarh","Ganganagar","Chittorgarh","Banswara","Dungarpur","Pratapgarh","Rajsamand","Baran","Jhalawar","Bundi","Sawai Madhopur","Karauli","Dholpur","Tonk","Dausa","Jhunjhunu","Churu","Nagaur","Jalore","Sirohi","Jaisalmer","Barmer","Jalor","Bharatpur","Karauli","Dholpur","Sawai Madhopur","Baran","Jhalawar","Bundi","Kota","Bundi","Sawai Madhopur","Karauli","Dholpur","Tonk","Dausa","Sikar","Jhunjhunu","Churu","Nagaur","Jalore","Sirohi","Jaisalmer","Barmer","Jalor","Pali","Rajsamand","Bhilwara","Kishangarh","Beawar","Hanumangarh","Ganganagar","Chittorgarh","Banswara","Dungarpur","Pratapgarh","Rajsamand","Baran","Jhalawar","Bundi","Sawai Madhopur","Karauli","Dholpur","Tonk","Dausa","Kolhapur","Sangli","Satara","Pune","Nashik","Aurangabad","Jalgaon","Dhule","Nanded","Latur","Osmanabad","Beed","Jalna","Parbhani","Hingoli","Washim","Yavatmal","Amravati","Akola","Buldhana","Nandurbar","Ahmednagar","Solapur","Ratnagiri","Sindhudurg","Sangli","Satara","Kolhapur","Pune","Nashik","Aurangabad","Jalgaon","Dhule","Nanded","Latur","Osmanabad","Beed","Jalna","Parbhani","Hingoli","Washim","Yavatmal","Amravati","Akola","Buldhana","Nandurbar","Ahmednagar","Solapur","Ratnagiri","Sindhudurg","Chandrapur","Gadchiroli","Bhandara","Gondia","Wardha","Nagpur","Bhandara","Gondia","Wardha","Chandrapur","Gadchiroli","Bhandara","Gondia","Wardha","Nagpur","Bhandara","Gondia","Wardha","Chandrapur","Gadchiroli","Mysore","Hubli","Dharwad","Mangalore","Belgaum","Gulbarga","Davanagere","Bellary","Bijapur","Shimoga","Tumkur","Raichur","Bidar","Hospet","Gadag","Haveri","Bagalkot","Koppal","Chitradurga","Tumakuru","Chikmagalur","Hassan","Mandya","Mysore","Chamarajanagar","Kodagu","Mysore","Chamarajanagar","Kodagu","Mysore","Chamarajanagar","Kodagu","Mysore","Chamarajanagar","Kodagu","Mysore","Chamarajanagar","Kodagu","Mysore","Chamarajanagar","Kodagu","Mysore","Chamarajanagar","Kodagu","Mysore","Chamarajanagar","Kodagu","Mysore","Chamarajanagar","Kodagu","Mysore","Chamarajanagar","Kodagu","Mysore","Chamarajanagar","Kodagu","Mysore","Chamarajanagar","Kodagu","Mysore","Coimbatore","Madurai","Tiruchirappalli","Salem","Tirunelveli","Tiruppur","Erode","Vellore","Thoothukudi","Dindigul","Thanjavur","Ranipet","Sivakasi","Karur","Udhagamandalam","Hosur","Nagercoil","Kanchipuram","Cuddalore","Kumbakonam","Tiruvannamalai","Pollachi","Rajapalayam","Gudiyatham","Pudukkottai","Vaniyambadi","Ariyalur","Chengalpattu","Coimbatore","Cuddalore","Dharmapuri","Dindigul","Erode","Kallakurichi","Kanchipuram","Karur","Krishnagiri","Madurai","Mayiladuthurai","Nagapattinam","Namakkal","Nilgiris","Perambalur","Pudukkottai","Ramanathapuram","Ranipet","Salem","Sivaganga","Tenkasi","Thanjavur","Theni","Thoothukudi","Tiruchirappalli","Tirunelveli","Tirupathur","Tiruppur","Tiruvallur","Tiruvannamalai","Tiruvarur","Vellore","Viluppuram","Virudhunagar","Agra","Varanasi","Allahabad","Bareilly","Moradabad","Aligarh","Saharanpur","Noida","Firozabad","Banda","Etawah","Mirzapur","Mathura","Shahjahanpur","Rampur","Modinagar","Hapur","Etah","Mau","Ghaziabad","Sambhal","Amroha","Hardoi","Fatehpur","Raebareli","Orai","Sitapur","Bahraich","Gonda","Balrampur","Basti","Deoria","Gorakhpur","Kushinagar","Maharajganj","Siddharthnagar","Azamgarh","Ballia","Mau","Ghazipur","Chandauli","Jaunpur","Varanasi","Mirzapur","Sonbhadra","Banda","Chitrakoot","Hamirpur","Jalaun","Jhansi","Lalitpur","Mahoba","Agra","Aligarh","Etah","Firozabad","Hathras","Kasganj","Mathura","Mainpuri","Agra","Aligarh","Etah","Firozabad","Hathras","Kasganj","Mathura","Mainpuri","Agra","Aligarh","Surat","Vadodara","Rajkot","Bhavnagar","Junagadh","Gandhinagar","Nadiad","Morbi","Gandhidham","Bharuch","Veraval","Navsari","Bardoli","Palanpur","Godhra","Patan","Valsad","Anand","Mehsana","Surendranagar","Jamnagar","Porbandar","Ankleshwar","Vapi","Botad","Dahod","Narmada","Ahmedabad","Amreli","Anand","Banaskantha","Bharuch","Bhavnagar","Dahod","Dang","Gandhinagar","Jamnagar","Junagadh","Kheda","Kutch","Mehsana","Narmada","Navsari","Panchmahal","Patan","Porbandar","Rajkot","Sabarkantha","Surat","Surendranagar","Tapi","Vadodara","Valsad","Ahmedabad","Amreli","Anand","Banaskantha","Bharuch","Bhavnagar","Dahod","Patna","Gaya","Bhagalpur","Muzaffarpur","Darbhanga","Purnia","Arrah","Begusarai","Katihar","Munger","Chhapra","Bettiah","Saharsa","Sasaram","Hajipur","Dehri","Siwan","Motihari","Nawada","Bagaha","Buxar","Kishanganj","Sitamarhi","Madhubani","Samastipur","Vaishali","West Champaran","East Champaran","Sheikhpura","Lakhisarai","Kolkata","Asansol","Siliguri","Durgapur","Bardhaman","Malda","Bahrampur","Habra","Kharagpur","Shantipur","Dankuni","Dhulian","Ranaghat","Haldia","Raiganj","Krishnanagar","Nabadwip","Medinipur","Jalpaiguri","Balurghat","Basirhat","Bankura","Chakdaha","Darjeeling","Kalimpong","Kalyani","Katwa","Kharagpur","Krishnanagar","Malda","Bhopal","Indore","Gwalior","Jabalpur","Ujjain","Sagar","Dewas","Satna","Ratlam","Rewa","Murwara","Singrauli","Burhanpur","Khandwa","Chhindwara","Morena","Bhind","Guna","Shivpuri","Vidisha","Chhatarpur","Damoh","Panna","Tikamgarh","Niwari","Datia","Shivpuri","Guna","Ashoknagar","Guna","Visakhapatnam","Vijayawada","Guntur","Nellore","Kurnool","Tirupati","Kadapa","Anantapur","Chittoor","Ongole","Eluru","Machilipatnam","Tenali","Proddatur","Chilakaluripet","Kadiri","Adoni","Nandyal","Kavali","Tadipatri","Srikakulam","Vizianagaram","Parvathipuram","Bobbili","Salur","Tekkali","Palasa","Sompeta","Ichchapuram","Narasannapeta","Thiruvananthapuram","Kochi","Kozhikode","Thrissur","Palakkad","Malappuram","Kannur","Kasaragod","Kollam","Alappuzha","Pathanamthitta","Kottayam","Idukki","Ernakulam","Thrissur","Palakkad","Malappuram","Kozhikode","Wayanad","Kannur","Kasaragod","Thiruvananthapuram","Kollam","Alappuzha","Pathanamthitta","Kottayam","Idukki","Ernakulam","Thrissur","Palakkad","Chandigarh","Ludhiana","Amritsar","Jalandhar","Patiala","Bathinda","Mohali","Firozpur","Batala","Pathankot","Moga","Abohar","Malerkotla","Khanna","Phagwara","Muktsar","Barnala","Rajpura","Fazilka","Kapurthala","Sangrur","Sunam","Nabha","Rampura","Gurdaspur","Tarn Taran","Fatehgarh Sahib","Muktsar","Faridkot","Moga","Chandigarh","Faridabad","Gurgaon","Panipat","Ambala","Yamunanagar","Rohtak","Hisar","Karnal","Sonipat","Panchkula","Bhiwani","Sirsa","Bahadurgarh","Jind","Kaithal","Rewari","Palwal","Narnaul","Hansi","Fatehabad","Tohana","Narwana","Mandi Dabwali","Safidon","Pehowa","Samalkha","Shahbad","Hodal","Sohna","Bhubaneswar","Cuttack","Rourkela","Berhampur","Sambalpur","Puri","Baleshwar","Bhadrak","Baripada","Balangir","Jharsuguda","Bargarh","Angul","Dhenkanal","Jajpur","Jagatsinghpur","Kendrapara","Khordha","Nayagarh","Puri","Sundargarh","Kandhamal","Boudh","Deogarh","Jharsuguda","Sambalpur","Subarnapur","Bargarh","Balangir","Nuapada","Ranchi","Jamshedpur","Dhanbad","Bokaro","Deoghar","Phusro","Hazaribagh","Giridih","Koderma","Ramgarh","Chatra","Garhwa","Koderma","Lohardaga","Pakur","Palamu","Sahibganj","Seraikela Kharsawan","Simdega","West Singhbhum","East Singhbhum","Dumka","Godda","Jamtara","Khunti","Latehar","Palamu","Sahibganj","Seraikela Kharsawan","Simdega","Guwahati","Silchar","Dibrugarh","Jorhat","Nagaon","Tinsukia","Tezpur","Bongaigaon","Dhubri","Diphu","Goalpara","Hailakandi","Karimganj","Kokrajhar","Mangaldoi","Mariagaon","Nalbari","North Lakhimpur","Sibsagar","Tezpur","Tinsukia","Udalguri","Barpeta","Bongaigaon","Cachar","Chirang","Darrang","Dhemaji","Dhubri","Dibrugarh","Raipur","Bhilai","Bilaspur","Korba","Rajnandgaon","Durg","Raigarh","Jagdalpur","Ambikapur","Bhatapara","Bilaspur","Chirmiri","Dhamtari","Durg","Jagdalpur","Janjgir","Jashpur","Kabirdham","Kanker","Kondagaon","Korba","Koriya","Mahasamund","Mungeli","Narayanpur","Raigarh","Raipur","Rajnandgaon","Sukma","Surajpur","Shimla","Dharamshala","Solan","Mandi","Palampur","Kullu","Chamba","Baddi","Nahan","Paonta Sahib","Una","Bilaspur","Hamirpur","Kangra","Kinnaur","Lahaul and Spiti","Mandi","Shimla","Sirmaur","Solan","Kullu","Chamba","Una","Bilaspur","Hamirpur","Kangra","Kinnaur","Lahaul and Spiti","Mandi","Shimla","Dehradun","Haridwar","Roorkee","Kashipur","Rudrapur","Haldwani","Rishikesh","Kotdwar","Ramnagar","Pithoragarh","Almora","Nainital","Champawat","Bageshwar","Chamoli","Pauri Garhwal","Rudraprayag","Tehri Garhwal","Uttarkashi","Dehradun","Haridwar","Roorkee","Kashipur","Rudrapur","Haldwani","Rishikesh","Kotdwar","Ramnagar","Pithoragarh","Almora","Panaji","Margao","Vasco da Gama","Mapusa","Ponda","Mormugao","Sanquelim","Bicholim","Curchorem","Cuncolim","Canacona","Pernem","Quepem","Sanguem","Satari","Tiswadi","Bardez","Bicholim","Canacona","Curchorem","Chandigarh","Delhi","Puducherry","Daman","Diu","Dadra and Nagar Haveli","Lakshadweep","Andaman and Nicobar Islands"],z=["Maharashtra","Delhi","Karnataka","Tamil Nadu","West Bengal","Telangana","Gujarat","Rajasthan","Uttar Pradesh","Madhya Pradesh","Andhra Pradesh","Bihar","Punjab","Haryana","Kerala","Odisha","Jharkhand","Assam","Chhattisgarh","Himachal Pradesh","Uttarakhand","Tripura","Meghalaya","Manipur","Nagaland","Goa","Arunachal Pradesh","Mizoram","Sikkim","Jammu and Kashmir","Ladakh"];function _(){const m=document.getElementById("cart-pincode-input"),e=document.getElementById("cart-city-input"),t=document.getElementById("cart-state-input"),a=document.getElementById("cart-city-suggestions"),r=document.getElementById("cart-state-suggestions");m&&e&&t&&(console.log("Initializing cart pincode autocomplete..."),m.addEventListener("input",function(){const o=this.value.trim();if(console.log("Cart pincode entered:",o),o.length===6&&O[o]){console.log("Found cart pincode data:",O[o]),e.value=O[o].city,t.value=O[o].state;const n=document.getElementById("cart-country-select");n&&(n.value="India")}}),e.addEventListener("input",function(){const o=this.value.toLowerCase();if(o.length>0){const n=J.filter(i=>i.toLowerCase().includes(o));x(a,n,e)}else P(a)}),t.addEventListener("input",function(){const o=this.value.toLowerCase();if(o.length>0){const n=z.filter(i=>i.toLowerCase().includes(o));x(r,n,t)}else P(r)}),document.addEventListener("click",function(o){!e.contains(o.target)&&!a.contains(o.target)&&P(a),!t.contains(o.target)&&!r.contains(o.target)&&P(r)}))}document.addEventListener("DOMContentLoaded",function(){_(),setTimeout(_,500),setTimeout(_,1e3),setTimeout(_,2e3)});setTimeout(_,3e3);setTimeout(_,5e3);function H(){console.log("Reinitializing cart pincode autocomplete..."),_()}window.reinitializeCartPincodeAutocomplete=H;function x(m,e,t){if(e.length===0){P(m);return}m.innerHTML="",e.slice(0,5).forEach(a=>{const r=document.createElement("div");r.className="px-4 py-2 hover:bg-gray-100 cursor-pointer border-b border-gray-200 text-gray-900",r.textContent=a,r.addEventListener("click",function(){t.value=a,P(m)}),m.appendChild(r)}),m.classList.remove("hidden"),m.style.position="absolute",m.style.zIndex="10",m.style.width=t.offsetWidth+"px",m.style.top=t.offsetTop+t.offsetHeight+"px",m.style.left=t.offsetLeft+"px"}function P(m){m.classList.add("hidden")}
