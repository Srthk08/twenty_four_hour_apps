const c="https://lmrrdcaavwwletcjcpqv.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxtcnJkY2Fhdnd3bGV0Y2pjcHF2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU1MDQ0ODgsImV4cCI6MjA3MTA4MDQ4OH0.AU59Qfr6K9i880Gcn5y-3pjCf8PXsDIq4OI0-lPQVuQ";let t=null;function a(){return new Promise(e=>{window.supabase?(t=window.supabase.createClient(c,l),e(t)):setTimeout(()=>a().then(e),100)})}async function o(){try{console.log("AdminGuard: Checking admin access..."),t||await a();const{data:{user:e},error:i}=await t.auth.getUser();if(i){console.error("AdminGuard: Error getting user:",i),n("Authentication error. Please login again.");return}if(!e){console.log("AdminGuard: No user logged in"),n("Please login to access admin panel");return}console.log("AdminGuard: User found:",e.email);const{data:d,error:s}=await t.from("profiles").select("role").eq("id",e.id).single();if(s){console.error("AdminGuard: Error getting profile:",s),n("Error checking user permissions");return}if(d.role!=="admin"){console.log("AdminGuard: User does not have admin role. Role:",d.role),n("Access denied. Admin privileges required.");return}console.log("AdminGuard: Admin access granted for user:",e.email),r()}catch(e){console.error("AdminGuard: Error checking admin access:",e),n("Error checking admin access. Please try again.")}}function n(e){console.log("AdminGuard: Access denied -",e),document.getElementById("admin-guard").style.display="none",document.getElementById("admin-content").classList.add("hidden"),document.getElementById("access-denied").classList.remove("hidden"),document.getElementById("access-denied-message").textContent=e}function r(){console.log("AdminGuard: Showing admin content"),document.getElementById("admin-guard").style.display="none",document.getElementById("access-denied").classList.add("hidden"),document.getElementById("admin-content").classList.remove("hidden")}document.addEventListener("DOMContentLoaded",o);window.addEventListener("auth-state-changed",o);document.readyState==="loading"?document.addEventListener("DOMContentLoaded",o):o();setTimeout(()=>{const e=document.getElementById("admin-guard");e&&e.style.display!=="none"&&(console.warn("Admin access check timed out, showing content anyway"),r())},1e4);console.log("StandaloneAdminLayout loaded successfully");function m(){console.log("Fixing text visibility...");const e=document.createElement("style");e.textContent=".text-white { --tw-text-opacity: 1 !important; color: rgb(21 17 17) !important; }",document.head.appendChild(e)}document.addEventListener("DOMContentLoaded",m);document.addEventListener("DOMContentLoaded",function(){console.log("Checking Alpine.js availability..."),setTimeout(function(){window.Alpine?console.log("Alpine.js is loaded"):console.error("Alpine.js is not loaded after timeout")},1e3)});
