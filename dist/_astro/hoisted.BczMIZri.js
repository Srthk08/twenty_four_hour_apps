import"./Footer.astro_astro_type_script_index_0_lang.DjppUjiM.js";import"https://unpkg.com/@supabase/supabase-js@2";import"./AuthGuard.astro_astro_type_script_index_0_lang.D4Znhmp3.js";console.log("üöÄ Dashboard loaded - using global auth manager");async function u(){console.log("üîÑ Updating user info...");let e=null,s="";const t=window.globalAuthManager||window.simpleAuthManager;if(t&&t.isUserLoggedIn()&&t.currentUser)e=t.currentUser,s="auth-manager",console.log("‚úÖ Found user data in auth manager:",e.email);else if(window.supabase)try{const{data:{session:o},error:a}=await window.supabase.auth.getSession();!a&&o?.user&&(e=o.user,s="supabase-session",console.log("‚úÖ Found user data in Supabase session:",e.email))}catch(o){console.log("Error getting Supabase session:",o)}if(!e){const o=[{key:"simple-auth-session",storage:sessionStorage,path:"user"},{key:"simple-auth-user",storage:localStorage,path:null},{key:"simple-auth-session",storage:localStorage,path:"user"}];for(const a of o)try{const n=a.storage.getItem(a.key);if(n){const i=JSON.parse(n);if(e=a.path?i[a.path]:i,e&&e.email){s=a.key,console.log(`‚úÖ Found user data in ${a.key}:`,e.email);break}}}catch(n){console.log(`Error reading ${a.key}:`,n)}}if(!e){console.log("‚ùå No user data found, redirecting to login"),window.location.href="/login";return}const r=document.getElementById("user-welcome");if(r){const o=e.full_name||e.user_metadata?.full_name||e.email?.split("@")[0]||"User";r.textContent=o,console.log(`‚úÖ Updated welcome message with: ${o}`)}console.log(`‚úÖ User info updated from ${s}:`,e.email)}function l(){console.log("üöÄ Initializing dashboard...");const e=()=>{window.globalAuthManager||window.simpleAuthManager?(console.log("‚úÖ Auth manager ready, updating user info"),u()):(console.log("‚è≥ Auth manager not ready, retrying..."),setTimeout(e,200))};setTimeout(e,500)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",l):l();console.log("‚úÖ Dashboard script initialized with global auth manager");
