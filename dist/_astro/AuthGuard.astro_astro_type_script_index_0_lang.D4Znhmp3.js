async function o(){const t=document.getElementById("auth-guard");if(!t)return;const n=t.dataset.redirectTo||"/login";try{let e=window.globalAuthManager||window.simpleAuthManager;if(!e){setTimeout(o,100);return}if(e.isUserLoggedIn()){console.log("✅ User is authenticated, allowing access");return}else{if(console.log("❌ User not authenticated, redirecting to:",n),window.location.pathname==="/login"){console.log("Already on login page, not redirecting");return}window.location.pathname!=="/login"&&sessionStorage.setItem("login-redirect-url",window.location.pathname+window.location.search),window.location.href=n;return}}catch(e){console.error("Error checking authentication:",e),window.location.pathname!=="/login"&&(window.location.href=n)}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{setTimeout(o,500)}):setTimeout(o,500);window.addEventListener("user-logged-in",()=>{console.log("User logged in event received in AuthGuard")});window.addEventListener("user-logged-out",()=>{console.log("User logged out event received in AuthGuard"),o()});console.log("✅ AuthGuard initialized with global auth manager");
