import"./ProductDialog.astro_astro_type_script_index_0_lang.CpUg5vNK.js";import"https://unpkg.com/@supabase/supabase-js@2";document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll('a[href^="#"]').forEach(r=>{r.addEventListener("click",function(o){o.preventDefault();const e=this.getAttribute("href").substring(1),t=document.getElementById(e);t&&t.scrollIntoView({behavior:"smooth",block:"start"})})})});const i=document.querySelectorAll(".filter-btn"),c=document.querySelectorAll(".product-card");i.forEach(r=>{r.addEventListener("click",()=>{i.forEach(e=>{e.classList.remove("active"),e.classList.add("bg-white","text-gray-700","border"),e.classList.remove("bg-primary-600","bg-blue-600","text-white"),e.style.color="#374151",e.style.backgroundColor="#ffffff",e.style.background="#ffffff"}),r.classList.add("active"),r.style.color="#3b82f6",r.style.backgroundColor="#ffffff",r.style.background="#ffffff";const o=r.dataset.filter;c.forEach(e=>{const t=e.dataset.category,n=e.dataset.productSlug;let s=!1;o==="all"?s=!0:o==="web"?s=n==="restaurant-website":o==="restaurant"?s=t===o&&n!=="restaurant-website"&&n!=="order-menu-system":o==="order-menu-system"?s=n==="order-menu-system":s=t===o,s?(e.style.display="block",e.classList.add("animate-fade-in")):e.style.display="none"})})});const l=new IntersectionObserver(r=>{r.forEach(o=>{o.isIntersecting&&(o.target.classList.add("animate-fade-in"),l.unobserve(o.target))})},{rootMargin:"100px 0px",threshold:.05});document.querySelectorAll(".product-card").forEach(r=>{l.observe(r)});document.addEventListener("DOMContentLoaded",()=>{document.body.classList.add("page-loaded");const r=document.querySelectorAll(".filter-btn"),o=document.querySelector(".filter-section");o&&(o.style.display="block",o.style.visibility="visible",o.style.opacity="1"),r.forEach(t=>{t.style.display="inline-block",t.style.visibility="visible",t.style.opacity="1",t.classList.contains("active")?(t.style.color="#3b82f6",t.style.backgroundColor="#ffffff",t.style.background="#ffffff"):(t.style.color="#374151",t.style.backgroundColor="#ffffff",t.style.background="#ffffff"),t.classList.remove("bg-primary-600","bg-blue-600","text-white")});const e=document.querySelectorAll('.product-card img[loading="lazy"]');e.length>0&&Array.from(e).slice(0,3).forEach(t=>{t.loading="eager"})});document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".product-view-btn").forEach(o=>{o.addEventListener("click",function(e){e.preventDefault();const t=this.getAttribute("data-product-slug");this.getAttribute("data-product-name"),console.log("Product clicked:",t);const n=d();if(console.log("Is admin:",n),n){console.log("Admin user - allowing access"),window.location.href=`/products/${t}`;return}const s=window.globalAuthManager||window.simpleAuthManager;if(!(s&&s.isUserLoggedIn())){console.log("âŒ User not logged in - authentication required, redirecting to login");const a=`/login?redirect=/products/${t}`;document.body.style.transition="opacity 0.3s ease-out",document.body.style.opacity="0",setTimeout(()=>{window.location.href=a},200);return}if(t==="order-menu-system"){console.log("Order Menu System - allowing access for logged-in user"),window.location.href=`/products/${t}`;return}console.log("Non-admin user - showing dialog"),window.showProductDialog?window.showProductDialog():(console.log("Dialog not available - redirecting to contact"),window.location.href="/contact")})})});function d(){try{if(window.globalAuthManager&&window.globalAuthManager.isUserLoggedIn()){const e=window.globalAuthManager.getCurrentUser();if(e&&e.role==="admin")return!0}if(window.simpleAuthManager&&window.simpleAuthManager.isUserLoggedIn()){const e=window.simpleAuthManager.getCurrentUser();if(e&&e.role==="admin")return!0}const r=sessionStorage.getItem("simple-auth-session");if(r)try{const e=JSON.parse(r);if(e.user&&e.user.role==="admin")return!0}catch(e){console.log("Session data parse error:",e)}const o=localStorage.getItem("simple-auth-session");if(o)try{const e=JSON.parse(o);if(e.user&&e.user.role==="admin")return!0}catch(e){console.log("Local session data parse error:",e)}return!1}catch(r){return console.error("Error checking admin status:",r),!1}}
