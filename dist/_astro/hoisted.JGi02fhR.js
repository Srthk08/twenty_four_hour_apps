import"./ProductDialog.astro_astro_type_script_index_0_lang.CpUg5vNK.js";import"https://unpkg.com/@supabase/supabase-js@2";const v=document.getElementById("contact-form"),j=document.getElementById("success-message"),T=document.getElementById("error-message"),P=document.getElementById("error-text");function k(){const t=document.getElementById("first_name"),e=document.getElementById("last_name"),n=document.getElementById("email"),a=document.getElementById("phone"),r=document.getElementById("company");return{firstNameInput:t,lastNameInput:e,emailInput:n,phoneInput:a,companyInput:r}}function N(t){t&&(t.setAttribute("autocomplete","off"),t.setAttribute("data-orig-name",t.name||""),t.name=`${t.id}_noautofill`)}function V(t){if(!t)return;const e=t.getAttribute("data-orig-name");e&&(t.name=e)}function C(){const{firstNameInput:t,lastNameInput:e,emailInput:n,phoneInput:a,companyInput:r}=k();[t,e,n,a,r].forEach(l=>{l&&(l.value="",l.disabled=!0,N(l))});const o=v?.querySelector('button[type="submit"]');o&&(o.disabled=!0)}function S(){const{firstNameInput:t,lastNameInput:e,emailInput:n,phoneInput:a,companyInput:r}=k();[t,e,n,a,r].forEach(s=>{s&&(s.disabled=!1,V(s))});const o=document.getElementById("project_type"),l=document.getElementById("message");o&&(o.disabled=!1),l&&(l.disabled=!1,l.placeholder="Tell us about your project requirements...");const d=v?.querySelector('button[type="submit"]');d&&(d.disabled=!1);const i=document.getElementById("auth-message");i&&i.remove()}C();window.addEventListener("user-logged-in",()=>{S()});window.addEventListener("user-logged-out",()=>{C()});document.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>{const t=window.globalAuthManager||window.simpleAuthManager,e=sessionStorage.getItem("simple-auth-session"),n=e&&e!=="null"&&e!=="{}";(!t||!t.isUserLoggedIn()||!n)&&(console.log("üö´ User not authenticated - forcing form clear"),C(),window.clearForm())},100)});let m=null;const D=()=>{const t="https://lmrrdcaavwwletcjcpqv.supabase.co",e="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxtcnJkY2Fhdnd3bGV0Y2pjcHF2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU1MDQ0ODgsImV4cCI6MjA3MTA4MDQ4OH0.AU59Qfr6K9i880Gcn5y-3pjCf8PXsDIq4OI0-lPQVuQ";return window.supabase&&typeof window.supabase.createClient=="function"?(m=window.supabase.createClient(t,e),console.log("‚úÖ Supabase client initialized directly"),!0):window.supabase?(m=window.supabase,console.log("‚úÖ Using existing Supabase client"),!0):(console.error("‚ùå Supabase library not available"),!1)};D()?console.log("‚úÖ Supabase client ready:",!!m):console.error("‚ùå Failed to initialize Supabase client");window.clearForm=function(){console.log("üßπ Clearing contact form fields...");const e=document.getElementById("first_name"),n=document.getElementById("last_name"),a=document.getElementById("email"),r=document.getElementById("phone"),o=document.getElementById("company"),l=document.getElementById("project_type"),d=document.getElementById("message");e&&(e.value="",e.placeholder="Your first name",e.dispatchEvent(new Event("input",{bubbles:!0})),e.dispatchEvent(new Event("change",{bubbles:!0}))),n&&(n.value="",n.placeholder="Your last name",n.dispatchEvent(new Event("input",{bubbles:!0})),n.dispatchEvent(new Event("change",{bubbles:!0}))),a&&(a.value="",a.placeholder="your.email@example.com",a.dispatchEvent(new Event("input",{bubbles:!0})),a.dispatchEvent(new Event("change",{bubbles:!0}))),r&&(r.value="",r.placeholder="+1 (555) 123-4567",r.dispatchEvent(new Event("input",{bubbles:!0})),r.dispatchEvent(new Event("change",{bubbles:!0}))),o&&(o.value="",o.placeholder="Your company name",o.dispatchEvent(new Event("input",{bubbles:!0})),o.dispatchEvent(new Event("change",{bubbles:!0}))),l&&(l.value="",l.selectedIndex=0,l.dispatchEvent(new Event("input",{bubbles:!0})),l.dispatchEvent(new Event("change",{bubbles:!0}))),d&&(d.value="",d.placeholder="Tell us about your project...",d.dispatchEvent(new Event("input",{bubbles:!0})),d.dispatchEvent(new Event("change",{bubbles:!0}))),document.querySelectorAll("input, select, textarea").forEach(s=>{s.classList.remove("border-red-500"),s.classList.add("border-gray-300")}),console.log("‚úÖ Contact form cleared")};window.prefillForm=async function(){console.log("üîÑ Checking authentication status...");const e=window.globalAuthManager||window.simpleAuthManager,n=sessionStorage.getItem("simple-auth-session"),a=n&&n!=="null"&&n!=="{}";if(e&&e.isUserLoggedIn()&&a){console.log("‚úÖ User is logged in - enabling form"),S();const o=e.getCurrentUser();if(!o||!a){console.log("‚ö†Ô∏è User object is null or session invalid - clearing form"),C();return}if(o&&o.email){const l=document.getElementById("first_name"),d=document.getElementById("last_name"),i=document.getElementById("email"),s=document.getElementById("phone"),g=document.getElementById("company");if(o.full_name){const u=o.full_name.split(" ");l&&(l.value=u[0]||""),d&&u.length>1&&(d.value=u.slice(1).join(" "))}if(i&&(i.value=o.email||""),s&&o.phone){const u=o.phone.toString(),h=document.getElementById("phone_country_code");if(u.startsWith("+91"))h&&(h.value="+91"),s.value=u.substring(3).replace(/\D/g,"");else if(u.startsWith("+")){const I=u.match(/^(\+\d{1,4})(\d+)$/);I&&h?(h.value=I[1],s.value=I[2]):s.value=u.replace(/\D/g,"")}else s.value=u.replace(/\D/g,"")}g&&o.company_name&&(g.value=o.company_name)}}else{console.log("‚ùå User not logged in - clearing and disabling form"),C();const o=document.getElementById("contact-form");if(o){let l=document.getElementById("auth-message");l||(l=document.createElement("div"),l.id="auth-message",l.className="mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",o.insertBefore(l,o.firstChild)),l.innerHTML=`
          <div class="flex items-center">
            <svg class="w-5 h-5 text-blue-600 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            <div>
              <p class="text-blue-800 font-medium">Authentication Required</p>
              <p class="text-blue-700 text-sm">Please sign in to send us a message or view our products.</p>
              <div class="mt-2">
                <a href="/login" class="text-blue-600 hover:text-blue-800 font-medium text-sm mr-4">Sign In</a>
                <a href="/signup" class="text-blue-600 hover:text-blue-800 font-medium text-sm">Create Account</a>
              </div>
            </div>
          </div>
        `}}};function A(){const t=window.globalAuthManager||window.simpleAuthManager,e=sessionStorage.getItem("simple-auth-session"),n=e&&e!=="null"&&e!=="{}",a=t&&t.isUserLoggedIn()&&n;if(!a){console.log("üë§ User not logged in - clearing form and project details"),window.clearForm();const r=document.getElementById("project_type"),o=document.getElementById("message");r&&(r.value="",r.selectedIndex=0),o&&(o.value="",o.placeholder="Tell us about your project...")}return a}function O(){console.log("üîÑ Forcing form validation..."),document.querySelectorAll("input, select, textarea").forEach(e=>{e.value&&e.value.trim()&&(console.log(`üîç Forcing validation for field: ${e.id} = "${e.value}"`),e.dispatchEvent(new Event("input",{bubbles:!0})),e.dispatchEvent(new Event("change",{bubbles:!0})),e.dispatchEvent(new Event("blur",{bubbles:!0})),e.setCustomValidity&&e.setCustomValidity(""))}),console.log("‚úÖ Form validation forced")}function F(){const t=document.createElement("div");t.style.cssText=`
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    `;const e=document.createElement("div");e.style.cssText=`
      background: white;
      padding: 30px;
      border-radius: 10px;
      text-align: center;
      max-width: 400px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    `,e.innerHTML=`
      <h3 style="margin-bottom: 20px; color: #333;">Authentication Required</h3>
      <p style="margin-bottom: 30px; color: #666;">Please sign up or login to submit the contact form.</p>
      <div style="display: flex; gap: 15px; justify-content: center;">
        <button id="signup-btn" style="
          background: #3B82F6;
          color: white;
          border: none;
          padding: 12px 24px;
          border-radius: 6px;
          cursor: pointer;
          font-weight: 500;
        ">Sign Up</button>
        <button id="login-btn" style="
          background: #6B7280;
          color: white;
          border: none;
          padding: 12px 24px;
          border-radius: 6px;
          cursor: pointer;
          font-weight: 500;
        ">Login</button>
      </div>
    `,t.appendChild(e),document.body.appendChild(t),document.getElementById("signup-btn").addEventListener("click",()=>{document.body.removeChild(t),window.location.href="/signup"}),document.getElementById("login-btn").addEventListener("click",()=>{document.body.removeChild(t),window.location.href="/login"}),t.addEventListener("click",n=>{n.target===t&&document.body.removeChild(t)})}v?.addEventListener("submit",async t=>{if(t.preventDefault(),!A()){F();return}const e=document.getElementById("phone"),n=document.getElementById("phone_country_code"),a=document.getElementById("phone_country_code_custom"),r=e?.value?.trim()||"",o=n?.value||"+91",l=a?.value?.trim()||"";console.log("üîí Captured phone value early:",r),console.log("üîí Captured country code early:",o),console.log("üîí Captured custom country code early:",l),O();const d=new FormData(v),i=Object.fromEntries(d);if(r&&!i.phone&&(i.phone=r,console.log("üìû Restored phone value from early capture:",i.phone)),console.log("üìù Form data collected for validation:",i),console.log("üìù Phone input element value:",e?.value),e&&e.value.trim()){const p=e.value.replace(/\D/g,"");let c=o;if(c==="other"&&(c=l||a?.value?.trim()||"+91"),c==="+91"&&p.length!==10){showError("Please enter a valid 10-digit phone number for India"),e?.focus();return}}const s=[{id:"first_name",name:"First Name",value:i.first_name},{id:"last_name",name:"Last Name",value:i.last_name},{id:"email",name:"Email",value:i.email},{id:"project_type",name:"Project Type",value:i.project_type},{id:"message",name:"Message",value:i.message}];let g=!0;const u=[];for(const p of s){const c=document.getElementById(p.id),b=p.value?p.value.toString().trim():"";console.log(`üîç Validating ${p.name}: "${b}"`),b?c&&(c.classList.remove("border-red-500"),c.classList.add("border-gray-300")):(g=!1,u.push(p.name),c&&(c.classList.add("border-red-500"),c.classList.remove("border-gray-300")))}if(!g){showError(`Please fill in all required fields: ${u.join(", ")}`);return}console.log("‚úÖ All required fields are filled - proceeding with submission"),j?.classList.add("hidden"),T?.classList.add("hidden");const h=v.querySelector('button[type="submit"]'),I=h.textContent;h.disabled=!0,h.innerHTML=`
      <svg class="animate-spin h-5 w-5 text-white mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
      </svg>
    `;try{if(!m&&(console.log("üîÑ Supabase not available, trying to reinitialize..."),!D()))throw console.error("‚ùå Failed to initialize Supabase client"),new Error("Database connection not available. Please refresh the page and try again.");if(!m||typeof m.from!="function")throw console.error("‚ùå Supabase client is not properly initialized"),console.log("Supabase object:",m),console.log("Available methods:",m?Object.keys(m):"No supabase object"),new Error("Database connection not properly initialized. Please refresh the page and try again.");console.log("‚úÖ Supabase client verified and ready");const p=new FormData(v),c=Object.fromEntries(p);console.log("üìù Form data collected:",c);let b=null;try{const{data:{user:U}}=await m.auth.getUser();b=U,console.log("üë§ Current user:",b?b.email:"Not logged in")}catch{console.log("‚ÑπÔ∏è User not logged in, proceeding without authentication")}let y=r||c.phone||"",f=o||c.phone_country_code||"+91";f==="other"&&(f=l||a?.value?.trim()||c.phone_country_code_custom?.trim()||"+91"),f&&!f.startsWith("+")&&(f="+"+f.replace(/^\+/,"")),!y&&e&&(y=e.value?.trim()||"",console.log("üìû Phone from input element (final fallback):",y)),console.log("üìû Final phone number captured:",y),console.log("üìû Final country code:",f),console.log("üìû Phone input element exists:",!!e),console.log("üìû Phone input element current value:",e?.value),console.log("üìû Phone input element disabled:",e?.disabled);const w=y?y.replace(/\D/g,""):"",x=w&&w.length>0?`${f}${w}`:null;console.log("üìû Phone digits extracted:",w,"(length:",w.length,")"),console.log("üìû Formatted phone:",x),console.log("üìû Will save phone as:",x),e&&e.value&&!x&&console.warn("‚ö†Ô∏è Phone input has value but formatted phone is null!",{inputValue:e.value,phoneDigits:w,countryCode:f});const B={first_name:c.first_name,last_name:c.last_name,email:c.email,phone:x,company_name:c.company||null,project_type:c.project_type,project_details:c.message,message:c.message,user_id:b?b.id:null};console.log("üìù Sending contact data to Supabase:",B),console.log("üìù Phone field in contactData:",B.phone),console.log("üîç Testing Supabase connection...");const{data:q,error:_}=await m.from("contact_submissions").select("id").limit(1);if(_)throw console.error("‚ùå Supabase connection test failed:",_),new Error(`Database connection failed: ${_.message}`);console.log("‚úÖ Supabase connection test successful");const{data:E,error:M}=await m.from("contact_submissions").insert([B]).select();if(M)throw console.error("‚ùå Error saving contact message:",M),new Error(`Failed to save your message: ${M.message}`);console.log("‚úÖ Contact message saved successfully:",E),E&&E.length>0&&(console.log("üìû Phone number saved in database:",E[0].phone),console.log("üìû Full saved contact data:",E[0])),j?.classList.remove("hidden"),v.reset(),await prefillForm()}catch(p){console.error("Contact form error:",p),P&&(P.textContent=p.message||"An error occurred while sending your message."),T?.classList.remove("hidden")}finally{h.disabled=!1,h.innerHTML=I}});window.checkUserStatus=function(){console.log("üîç Checking user status..."),console.log("Global auth manager available:",!!window.globalAuthManager),console.log("Simple auth manager available:",!!window.simpleAuthManager),console.log("Supabase available:",!!window.supabase),window.globalAuthManager&&(console.log("User logged in (global):",window.globalAuthManager.isUserLoggedIn()),console.log("Current user (global):",window.globalAuthManager.getCurrentUser())),window.simpleAuthManager&&(console.log("User logged in (simple):",window.simpleAuthManager.isUserLoggedIn()),console.log("Current user (simple):",window.simpleAuthManager.getCurrentUser()))};window.reinitSupabase=function(){return console.log("üîÑ Reinitializing Supabase..."),D()?(console.log("‚úÖ Supabase reinitialized successfully"),!0):(console.log("‚ùå Failed to reinitialize Supabase"),!1)};window.testSupabaseConnection=async function(){if(!m)return console.log("‚ùå Supabase not initialized"),!1;try{const{data:t,error:e}=await m.from("contact_submissions").select("id").limit(1);return e?(console.error("‚ùå Supabase test failed:",e),!1):(console.log("‚úÖ Supabase test successful:",t),!0)}catch(t){return console.error("‚ùå Supabase test error:",t),!1}};function z(){const t=document.getElementById("phone_country_code"),e=document.getElementById("phone_country_code_custom"),n=document.getElementById("phone"),a=document.getElementById("phone-error");if(!t||!n)return;function r(){return t.value==="other"&&e?e.value.trim()||"+91":t.value}function o(){t.value==="other"?e&&(e.classList.remove("hidden"),e.required=!0,e.value="+"):e&&(e.classList.add("hidden"),e.required=!1,e.value="")}e&&e.addEventListener("input",function(i){let s=i.target.value;s.startsWith("+")||(s="+"+s.replace(/\+/g,"")),s=s.replace(/[^+0-9]/g,""),i.target.value=s});const l={"+91":10,"+1":10,"+44":10,"+61":9,"+86":11,"+81":10,"+49":11,"+33":9,"+971":9,"+966":9};function d(){const i=r(),s=n.value.replace(/\D/g,""),g=l[i]||15;return n.maxLength=g,n.pattern=`[0-9]{1,${g}}`,i==="+91"?s.length>0&&s.length!==10?(a?.classList.remove("hidden"),a.textContent="Please enter a valid 10-digit phone number",n.classList.add("border-red-500"),!1):(a?.classList.add("hidden"),n.classList.remove("border-red-500"),!0):s.length>0&&s.length>g?(a?.classList.remove("hidden"),a.textContent=`Please enter a valid phone number (max ${g} digits)`,n.classList.add("border-red-500"),!1):s.length>0&&s.length<5?(a?.classList.remove("hidden"),a.textContent="Please enter a valid phone number (at least 5 digits)",n.classList.add("border-red-500"),!1):(a?.classList.add("hidden"),n.classList.remove("border-red-500"),!0)}n.addEventListener("input",function(i){const s=i.target.value.replace(/\D/g,""),g=r(),u=l[g]||15;i.target.value=s.slice(0,u),d()}),t.addEventListener("change",function(){o(),n.value="";const i=r();n.placeholder=i==="+91"?"9876543210":"Enter phone number",d()}),o(),n.addEventListener("blur",d),e&&e.addEventListener("blur",d)}document.addEventListener("DOMContentLoaded",()=>{z(),["first_name","last_name","email","phone","company","project_type","message"].forEach(e=>{const n=document.getElementById(e);n&&(n.addEventListener("focus",()=>{A()||F()}),n.addEventListener("click",()=>{A()||F()}))})});function L(){console.log("üö´ FORCE CLEARING FORM - NO USER DETAILS ALLOWED WITHOUT LOGIN");const t=document.getElementById("first_name"),e=document.getElementById("last_name"),n=document.getElementById("email"),a=document.getElementById("phone"),r=document.getElementById("company"),o=document.getElementById("project_type"),l=document.getElementById("message");t&&(t.value="",t.disabled=!0),e&&(e.value="",e.disabled=!0),n&&(n.value="",n.disabled=!0),a&&(a.value="",a.disabled=!0),r&&(r.value="",r.disabled=!0),o&&(o.value="",o.disabled=!0),l&&(l.value="",l.disabled=!0,l.placeholder="Please sign in to send us a message.");const d=document.querySelector('button[type="submit"]');d&&(d.disabled=!0);const i=document.getElementById("contact-form");if(i){let s=document.getElementById("auth-message");s||(s=document.createElement("div"),s.id="auth-message",s.className="mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",i.insertBefore(s,i.firstChild)),s.innerHTML=`
        <div class="flex items-center">
          <svg class="w-5 h-5 text-red-600 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
          </svg>
          <div>
            <p class="text-red-800 font-medium">Authentication Required</p>
            <p class="text-red-700 text-sm">You must be logged in to access this form and view our products.</p>
            <div class="mt-2">
              <a href="/login" class="text-red-600 hover:text-red-800 font-medium text-sm mr-4">Sign In</a>
              <a href="/signup" class="text-red-600 hover:text-red-800 font-medium text-sm">Create Account</a>
            </div>
          </div>
        </div>
      `}}document.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>{const t=window.globalAuthManager||window.simpleAuthManager,e=sessionStorage.getItem("simple-auth-session"),n=e&&e!=="null"&&e!=="{}";t&&t.isUserLoggedIn()&&n?(console.log("‚úÖ User is logged in - enabling form"),S(),prefillForm()):(console.log("‚ùå User not logged in - clearing form"),L())},100)});window.addEventListener("user-logged-out",()=>{console.log("üë§ User logged out - FORCE CLEARING contact form"),sessionStorage.removeItem("simple-auth-session"),localStorage.removeItem("simple-auth-user"),L(),setTimeout(()=>{const t=window.globalAuthManager||window.simpleAuthManager,e=sessionStorage.getItem("simple-auth-session"),n=e&&e!=="null"&&e!=="{}";(!t||!t.isUserLoggedIn()||!n)&&L()},100)});window.addEventListener("user-logged-in",()=>{console.log("üë§ User logged in - pre-filling contact form"),setTimeout(()=>{prefillForm()},100)});window.addEventListener("load",()=>{console.log("üîÑ Window loaded - checking authentication status...");const t=()=>{const e=window.globalAuthManager||window.simpleAuthManager;if(e){console.log("‚úÖ Auth manager found on window load, checking user status...");const n=sessionStorage.getItem("simple-auth-session"),a=n&&n!=="null"&&n!=="{}";e.isUserLoggedIn()&&a?(console.log("üë§ User is logged in on window load - enabling form"),S(),prefillForm()):(console.log("üë§ User not logged in on window load - clearing form"),L())}else console.log("‚è≥ Auth manager not ready on window load, retrying in 100ms..."),setTimeout(t,100)};setTimeout(t,100)});document.addEventListener("visibilitychange",()=>{if(!document.hidden){console.log("üîÑ Page became visible - checking authentication");const t=window.globalAuthManager||window.simpleAuthManager,e=sessionStorage.getItem("simple-auth-session"),n=e&&e!=="null"&&e!=="{}";!t||!t.isUserLoggedIn()||!n?(console.log("üë§ User not logged in - FORCE CLEARING form"),L()):console.log("üë§ User is logged in - keeping form data")}});
