const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_astro/supabase.DO6XXPT9.js","_astro/index.BFAZBQoJ.js"])))=>i.map(i=>d[i]);
import{c as he,_ as Y}from"./index.BFAZBQoJ.js";import"./ProductDialog.astro_astro_type_script_index_0_lang.BQOC59sz.js";import"https://unpkg.com/@supabase/supabase-js@2";import"./AuthGuard.astro_astro_type_script_index_0_lang.DULNhCHQ.js";const ye="https://lmrrdcaavwwletcjcpqv.supabase.co",fe="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxtcnJkY2Fhdnd3bGV0Y2pjcHF2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU1MDQ0ODgsImV4cCI6MjA3MTA4MDQ4OH0.AU59Qfr6K9i880Gcn5y-3pjCf8PXsDIq4OI0-lPQVuQ",me=he(ye,fe),ve={"restaurant-website":"restaurant-website","streaming-mobile-app":"streaming-mobile-app","android-tv-app":"android-tv-app","restaurant-menu-system":"restaurant-menu-system","order-menu-system":"restaurant-menu-system"};async function be(e,t){try{if(console.log("💾 Saving customization form to Supabase...",{formData:e,productType:t}),t==="order-menu-system")return await we(e);const r={product_type:ve[t]||t,product_name:e.productName||e.product_name||"Unknown Product",product_price:e.productPrice||e.product_price||"₹0",project_name:e.projectName||e.project_name||"",contact_person:e.contactPerson||e.contact_person||"",app_name:e.appName||e.app_name||"",product_description:e.productDescription||e.product_description||"",restaurant_name:e.restaurantName||e.restaurant_name||null,cuisine_type:e.cuisineType||e.cuisine_type||null,logo_url:e.logoUrl||e.logo_url||null,logo_filename:e.logoFilename||e.logo_filename||null,logo_mime_type:e.logoMimeType||e.logo_mime_type||null,logo_size:e.logoSize||e.logo_size||null,contact_email:e.email||e.contact_email||e.contactEmail||"",contact_phone:e.phone||e.contact_phone||e.contactPhone||"",primary_color:e.primaryColor||e.primary_color||"#3B82F6",secondary_color:e.secondaryColor||e.secondary_color||"#10B981",accent_color:e.accentColor||e.accent_color||"#F59E0B",text_color:e.textColor||e.text_color||"#1F2937",additional_requirements:e.additionalRequirements||e.additional_requirements||"",menu_items:e.menuItems||e.menu_items||[],restaurant_address:e.restaurantAddress||e.restaurant_address||null,owner_name:e.ownerName||e.owner_name||null,status:"pending"};console.log("🧩 Inserting customization form for other products...");const{data:a,error:n}=await me.from("customization_forms").insert(r).select().single();return n?(console.error("❌ Error inserting customization form:",n),console.error("❌ Error details:",{message:n.message,details:n.details,hint:n.hint,code:n.code}),{success:!1,error:n.message,data:null}):(console.log("✅ Customization form inserted successfully:",a),{success:!0,error:null,data:a})}catch(o){return console.error("❌ Unexpected error saving customization form:",o),{success:!1,error:o.message,data:null}}}async function we(e){try{console.log("💾 Saving OMS customization form to Supabase...",{formData:e});const{data:t,error:o}=await me.rpc("upsert_oms_customization",{p_user_email:e.email||e.contact_email||e.contactEmail||"",p_project_name:e.projectName||e.project_name||"",p_restaurant_name:e.restaurantName||e.restaurant_name||"Default Restaurant",p_owner_name:e.ownerName||e.owner_name||e.contactPerson||e.contact_person||"",p_restaurant_address:e.restaurantAddress||e.restaurant_address||"Not provided",p_contact_person:e.contactPerson||e.contact_person||"",p_phone_number:e.phone||e.contact_phone||e.contactPhone||"",p_user_id:null,p_logo_url:e.logoUrl||e.logo_url||null,p_logo_filename:e.logoFilename||e.logo_filename||null,p_logo_size:e.logoSize||e.logo_size||null,p_menu_categories:e.menuCategories||e.menu_categories||[],p_menu_items:e.menuItems||e.menu_items||[],p_primary_color:e.primaryColor||e.primary_color||"#3B82F6",p_secondary_color:e.secondaryColor||e.secondary_color||"#10B981",p_accent_color:e.accentColor||e.accent_color||"#F59E0B",p_text_color:e.textColor||e.text_color||"#1F2937",p_additional_requirements:e.additionalRequirements||e.additional_requirements||""});if(o)return console.error("❌ Error inserting OMS customization:",o),console.error("❌ Error details:",{message:o.message,details:o.details,hint:o.hint,code:o.code}),{success:!1,error:o.message,data:null};if(t&&t.length>0){const r=t[0];return console.log("✅ OMS customization result:",r),r.is_duplicate?(console.log("⚠️ Duplicate data detected:",r.message),{success:!0,error:null,data:{id:r.data_id},isUpdate:!1,isDuplicate:!0,message:r.message}):(console.log("✅ OMS customization saved successfully, ID:",r.data_id),{success:!0,error:null,data:{id:r.data_id},isUpdate:!1,isDuplicate:!1,message:r.message})}else return console.error("❌ No data returned from OMS function"),{success:!1,error:"No data returned from OMS function",data:null}}catch(t){return console.error("❌ Unexpected error saving OMS customization form:",t),{success:!1,error:t.message,data:null}}}let E=[];console.log("Dashboard loaded - using global auth manager");async function _e(e){try{console.log("🔍 Fetching user profile from Supabase for user:",e);const{supabase:t}=await Y(async()=>{const{supabase:a}=await import("./supabase.DO6XXPT9.js");return{supabase:a}},__vite__mapDeps([0,1])),{data:o,error:r}=await t.from("profiles").select("*").eq("id",e).single();return r?(console.error("Error fetching user profile:",r),null):(console.log("✅ User profile fetched from Supabase:",o),o)}catch(t){return console.error("Error in fetchUserProfile:",t),null}}async function $(){console.log("🔄 Updating user info...");const e=window.globalAuthManager||window.simpleAuthManager;if(!e||!e.isUserLoggedIn()){console.log("❌ User not logged in - showing generic welcome message");const n=document.getElementById("user-welcome");n&&(n.textContent="Guest",console.log("👋 Welcome message updated to: Guest")),console.log("✅ Dashboard updated for guest user");return}let t=null,o="";const r=e.getCurrentUser();if(r&&r.email&&(t=r,o="auth-manager",console.log("✅ Found authenticated user data:",t.email)),!t){console.log("No auth manager data, checking storage...");const n=[{key:"simple-auth-session",storage:sessionStorage,path:"user"},{key:"simple-auth-user",storage:localStorage,path:null},{key:"simple-auth-session",storage:localStorage,path:"user"}];for(const s of n)try{const c=s.storage.getItem(s.key);if(c){const d=JSON.parse(c);if(t=s.path?d[s.path]:d,t&&t.email){o=s.key,console.log(`✅ Found user data in ${s.key}:`,t.email);break}}}catch(c){console.log(`Error reading ${s.key}:`,c)}}if(!t){console.log("❌ No authenticated user data found");const n=document.getElementById("user-welcome");n&&(n.textContent="Guest",console.log("👋 Welcome message updated to: Guest")),console.log("✅ Dashboard updated for guest user");return}if(t){if(t.user_metadata&&(t.full_name=t.user_metadata.full_name||t.full_name,t.phone=t.user_metadata.phone||t.phone,t.company_name=t.user_metadata.company_name||t.company_name),t.id&&(!t.full_name||t.full_name==="User"||!t.phone||t.phone==="Not set")){console.log("🔄 Incomplete user data, fetching from Supabase...");try{const n=await _e(t.id);n&&(t={...t,...n,email:t.email||n.email},console.log("✅ Enhanced user data with profile:",t))}catch(n){console.log("Error fetching profile data:",n)}}if(t.full_name=t.full_name||t.fullName||"User",t.phone=t.phone||"Not set",t.company_name=t.company_name||t.companyName||"Not set",!t.email){console.log("❌ No email found in authenticated user data");return}console.log("📋 Final normalized user data:",t)}const a=document.getElementById("user-welcome");if(a){const n=t.full_name||t.fullName||t.email?.split("@")[0]||"User";a.textContent=n,console.log("👋 Welcome message updated to:",n)}console.log(`✅ Dashboard updated successfully from ${o}`),setTimeout(()=>{console.log("🔄 Force update welcome message...");const n=document.getElementById("user-welcome");if(n){const s=t.full_name||t.fullName||t.email?.split("@")[0]||"User";n.textContent=s,console.log("Force updated welcome to:",n.textContent)}},100)}function Ee(){const e=new URLSearchParams(window.location.search),t=e.get("product"),o=e.get("price");if(console.log("🔍 Checking for product selection:",{productId:t,price:o}),t&&o){console.log("✅ Product selected, showing customization form");const a=[{id:"1",name:"Restaurant Menu System",description:"Digital menu system with QR code integration, online ordering, and real-time updates. Perfect for restaurants looking to modernize their customer experience.",price:25e3,type:"restaurant"},{id:"2",name:"Android TV App",description:"Custom Android TV applications with beautiful UI, content management, and remote control support. Perfect for streaming services and media companies.",price:55e3,type:"non-restaurant"},{id:"3",name:"Streaming Mobile App",description:"Mobile streaming applications for iOS and Android with custom features, user authentication, and content management.",price:35e3,type:"non-restaurant"},{id:"4",name:"Restaurant Website",description:"Professional restaurant website with online ordering, menu display, and customer management features.",price:2e4,type:"restaurant"},{id:"5",name:"Order Menu System",description:"Complete order management system with digital menu integration, real-time order tracking, and payment processing. Perfect for restaurants looking to streamline their ordering process.",price:999,type:"order-menu"}].find(n=>n.id===t);if(a){const n=document.getElementById("product-customization-form"),s=document.getElementById("order-menu-customization-form"),c=document.getElementById("recent-activity");n&&!n.classList.contains("hidden")&&(n.style.transition="opacity 0.3s ease-in-out, transform 0.3s ease-in-out",n.style.opacity="0",n.style.transform="translateY(-10px)",setTimeout(()=>n.classList.add("hidden"),300)),s&&!s.classList.contains("hidden")&&(s.style.transition="opacity 0.3s ease-in-out, transform 0.3s ease-in-out",s.style.opacity="0",s.style.transform="translateY(-10px)",setTimeout(()=>s.classList.add("hidden"),300)),c&&!c.classList.contains("hidden")&&(c.style.transition="opacity 0.3s ease-in-out, transform 0.3s ease-in-out",c.style.opacity="0",c.style.transform="translateY(-10px)",setTimeout(()=>c.classList.add("hidden"),300)),setTimeout(()=>{const d=a.type==="order-menu"?999:parseInt(o);if(a.type==="order-menu"){document.getElementById("order-menu-product-name").textContent=a.name;const l=document.getElementById("order-menu-customization-form");l.classList.remove("hidden"),l.style.transition="opacity 0.3s ease-in-out, transform 0.3s ease-in-out",l.style.opacity="0",l.style.transform="translateY(10px)",setTimeout(()=>{l.style.opacity="1",l.style.transform="translateY(0)",window.reinitializePincodeAutocomplete&&window.reinitializePincodeAutocomplete()},50)}else{document.getElementById("selected-product-name").textContent=a.name,document.getElementById("selected-product-price").textContent=`₹${d.toLocaleString()}`;const l=document.getElementById("cuisine-type-field"),i=document.getElementById("restaurant-name-field");a.type==="restaurant"?(l.classList.remove("hidden"),l.querySelector("select").required=!0,i.classList.remove("hidden"),i.querySelector("input").required=!0):(l.classList.add("hidden"),l.querySelector("select").required=!1,i.classList.add("hidden"),i.querySelector("input").required=!1);const g=document.getElementById("product-customization-form");g.classList.remove("hidden"),g.style.transition="opacity 0.3s ease-in-out, transform 0.3s ease-in-out",g.style.opacity="0",g.style.transform="translateY(10px)",setTimeout(()=>{g.style.opacity="1",g.style.transform="translateY(0)"},50)}},350),setTimeout(()=>Z(),500)}}}const ae=["Mumbai","Delhi","Bangalore","Hyderabad","Chennai","Kolkata","Pune","Ahmedabad","Jaipur","Surat","Lucknow","Kanpur","Nagpur","Indore","Thane","Bhopal","Visakhapatnam","Pimpri-Chinchwad","Patna","Vadodara","Ghaziabad","Ludhiana","Agra","Nashik","Faridabad","Meerut","Rajkot","Kalyan-Dombivali","Vasai-Virar","Varanasi","Srinagar","Aurangabad","Navi Mumbai","Solapur","Vijayawada","Kolhapur","Amritsar","Noida","Ranchi","Howrah","Coimbatore","Raipur","Jabalpur","Gwalior","Chandigarh","Tiruchirappalli","Mysore","Bhubaneswar","Kochi","Bhavnagar","Salem","Warangal","Guntur","Bhiwandi","Amravati","Nanded","Sangli","Malegaon","Ulhasnagar","Jalgaon","Latur","Ahmadnagar","Dhule","Ichalkaranji","Parbhani","Jalna","Bhusawal","Panvel","Satara","Beed","Yavatmal","Kamptee","Gondia","Barshi","Achalpur","Osmanabad","Nandurbar","Wardha","Udgir","Amalner","Akot","Pandharpur","Shirpur","Parli","Pathri","Sinnar","Shirur","Mangrulpir","Phaltan","Pulgaon","Pimpri","Pachora","Paratwada","Pusad","Purna","Rahuri","Rajura","Ramtek","Ratnagiri","Raver","Risod","Sailu","Sangamner","Sasvad","Satana","Shahpur","Shegaon","Shendurjana","Shirdi","Shrigonda","Shrirampur","Sillod","Soyagaon","Talegaon Dabhade","Talode","Tasgaon","Telhara","Tirora","Tuljapur","Tumsar","Uchgaon","Umarga","Umarkhed","Umred","Uran","Uran Islampur","Vadgaon Kasba","Vaijapur","Vasai","Virar","Vita","Wadgaon Road","Wai","Wani","Warora","Warud","Washim","Yawal","Yevla"],re=["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chhattisgarh","Goa","Gujarat","Haryana","Himachal Pradesh","Jharkhand","Karnataka","Kerala","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Punjab","Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura","Uttar Pradesh","Uttarakhand","West Bengal","Andaman and Nicobar Islands","Chandigarh","Dadra and Nagar Haveli and Daman and Diu","Delhi","Jammu and Kashmir","Ladakh","Lakshadweep","Puducherry"];function xe(){const e=document.getElementById("pincode-input"),t=document.getElementById("city-input"),o=document.getElementById("state-input"),r=document.getElementById("phone-input");if(e&&e.addEventListener("input",function(a){a.target.value=a.target.value.replace(/[^0-9]/g,""),a.target.value.length>6&&(a.target.value=a.target.value.slice(0,6));const n=document.getElementById("pincode-error");a.target.value.length>0&&a.target.value.length!==6?n.classList.remove("hidden"):n.classList.add("hidden")}),t){const a=document.getElementById("city-suggestions");t.addEventListener("input",function(n){const s=n.target.value.toLowerCase(),c=ae.filter(l=>l.toLowerCase().includes(s));s.length>0&&c.length>0?(a.innerHTML=c.map(l=>`<div class="px-4 py-2 hover:bg-gray-100 cursor-pointer border-b border-gray-100 last:border-b-0" data-value="${l}">${l}</div>`).join(""),a.classList.remove("hidden")):a.classList.add("hidden");const d=document.getElementById("city-error");n.target.value===""||!ae.includes(n.target.value)?d.classList.remove("hidden"):d.classList.add("hidden")}),a.addEventListener("click",function(n){n.target.dataset.value&&(t.value=n.target.dataset.value,a.classList.add("hidden"),document.getElementById("city-error").classList.add("hidden"))}),document.addEventListener("click",function(n){!t.contains(n.target)&&!a.contains(n.target)&&a.classList.add("hidden")})}if(o){const a=document.getElementById("state-suggestions");o.addEventListener("input",function(n){const s=n.target.value.toLowerCase(),c=re.filter(l=>l.toLowerCase().includes(s));s.length>0&&c.length>0?(a.innerHTML=c.map(l=>`<div class="px-4 py-2 hover:bg-gray-100 cursor-pointer border-b border-gray-100 last:border-b-0" data-value="${l}">${l}</div>`).join(""),a.classList.remove("hidden")):a.classList.add("hidden");const d=document.getElementById("state-error");n.target.value===""||!re.includes(n.target.value)?d.classList.remove("hidden"):d.classList.add("hidden")}),a.addEventListener("click",function(n){n.target.dataset.value&&(o.value=n.target.dataset.value,a.classList.add("hidden"),document.getElementById("state-error").classList.add("hidden"))}),document.addEventListener("click",function(n){!o.contains(n.target)&&!a.contains(n.target)&&a.classList.add("hidden")})}r&&r.addEventListener("input",function(a){let n=a.target.value;n.startsWith("+91")?(n="+91"+n.substring(3).replace(/[^0-9]/g,""),n.length>13&&(n=n.slice(0,13))):(n=n.replace(/[^0-9]/g,""),n.length>10&&(n=n.slice(0,10))),a.target.value=n;const s=document.getElementById("phone-error"),c=n.length===10||n.length===13&&n.startsWith("+91");n.length>0&&!c?s.classList.remove("hidden"):s.classList.add("hidden")})}function Le(){document.querySelectorAll("#order-menu-form input, #order-menu-form select, #order-menu-form textarea").forEach(o=>{o.addEventListener("input",ie),o.addEventListener("change",ie),o.addEventListener("focus",ie)});const t=document.getElementById("menu-photos-upload");t&&t.addEventListener("change",()=>{const o=document.getElementById("menu-photos-error");o&&o.classList.add("hidden")})}function ie(){const e=document.getElementById("validation-errors");e&&e.classList.add("hidden"),document.querySelectorAll("#pincode-error, #city-error, #state-error, #phone-error").forEach(o=>{o&&o.classList.add("hidden")})}function pe(){console.log("🔍 validateFormFields() called");const e=document.getElementById("pincode-input"),t=document.getElementById("city-input"),o=document.getElementById("state-input"),r=document.getElementById("phone-input"),a=document.querySelector('input[name="projectName"]'),n=document.querySelector('input[name="restaurantName"]'),s=document.querySelector('input[name="ownerName"]'),c=document.querySelector('input[name="contactPerson"]'),d=document.querySelector('input[name="email"]'),l=document.querySelector('input[name="houseNumber"]'),i=document.querySelector('input[name="addressLine1"]'),g=document.querySelector('select[name="country"]');console.log("🔍 Form fields found:"),console.log("  - projectName:",a?a.value:"not found"),console.log("  - restaurantName:",n?n.value:"not found"),console.log("  - ownerName:",s?s.value:"not found"),console.log("  - contactPerson:",c?c.value:"not found"),console.log("  - email:",d?d.value:"not found"),console.log("  - houseNumber:",l?l.value:"not found"),console.log("  - addressLine1:",i?i.value:"not found"),console.log("  - country:",g?g.value:"not found"),console.log("  - phone:",r?r.value:"not found"),console.log("  - city:",t?t.value:"not found"),console.log("  - state:",o?o.value:"not found"),console.log("  - pincode:",e?e.value:"not found");let h=!0,m=[];if((!a||!a.value.trim())&&(m.push("Project Name is required"),h=!1),(!n||!n.value.trim())&&(m.push("Restaurant Name is required"),h=!1),(!s||!s.value.trim())&&(m.push("Owner Name is required"),h=!1),(!c||!c.value.trim())&&(m.push("Contact Person is required"),h=!1),!d||!d.value.trim()?(m.push("Email is required"),h=!1):/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d.value)||(m.push("Please enter a valid email address"),h=!1),(!l||!l.value.trim())&&(m.push("House/Flat Number is required"),h=!1),(!i||!i.value.trim())&&(m.push("Address Line 1 is required"),h=!1),e&&(!e.value||e.value.length!==6||!/^[0-9]{6}$/.test(e.value))){const b=document.getElementById("pincode-error");b&&(b.classList.remove("hidden"),b.textContent="Pincode must be exactly 6 digits"),m.push("Pincode must be exactly 6 digits"),h=!1}if(t&&(!t.value||!ae.includes(t.value))){const b=document.getElementById("city-error");b&&(b.classList.remove("hidden"),b.textContent="Please select a valid city"),m.push("Please select a valid city"),h=!1}if(o&&(!o.value||!re.includes(o.value))){const b=document.getElementById("state-error");b&&(b.classList.remove("hidden"),b.textContent="Please select a valid state"),m.push("Please select a valid state"),h=!1}if((!g||!g.value)&&(m.push("Country is required"),h=!1),r&&(!r.value||!(/^[0-9]{10}$/.test(r.value)||/^\+91[0-9]{10}$/.test(r.value)))){const b=document.getElementById("phone-error");b&&(b.classList.remove("hidden"),b.textContent="Phone number must be 10 digits or +91 followed by 10 digits"),m.push("Phone number must be 10 digits or +91 followed by 10 digits"),h=!1}if(h)console.log("✅ Form validation passed - all required fields are filled");else{console.log("❌ Form validation failed with errors:",m);const b=document.getElementById("validation-errors");b&&(b.classList.remove("hidden"),b.innerHTML='<div class="bg-red-50 border border-red-200 rounded-lg p-4"><h4 class="text-red-800 font-semibold mb-2">Please fix the following errors:</h4><ul class="list-disc list-inside text-red-700 space-y-1">'+m.map(x=>`<li>${x}</li>`).join("")+"</ul></div>");const S=document.getElementById("order-menu-form");S&&S.scrollIntoView({behavior:"smooth",block:"start"})}return console.log("🔍 validateFormFields() returning:",h),h}function Ie(){const e=document.getElementById("order-menu-form");console.log("handleOrderMenuForm called - form found:",e);const t=document.getElementById("close-order-menu-form"),o=document.getElementById("cancel-order-menu");console.log("🔍 Close button found:",t),console.log("🔍 Cancel button found:",o);const r=document.getElementById("order-menu-logo-upload"),a=document.getElementById("order-menu-logo-upload-area"),n=document.getElementById("order-menu-logo-preview"),s=document.getElementById("order-menu-logo-preview-img"),c=document.getElementById("order-menu-logo-filename"),d=document.getElementById("order-menu-logo-remove"),l=document.getElementById("menu-photos-upload"),i=document.getElementById("menu-photos-upload-area"),g=document.getElementById("menu-photos-preview"),h=document.getElementById("menu-photos-grid");if(console.log("menuPhotosPreview element found:",g),console.log("menuPhotosGrid element found:",h),console.log("menuPhotosUpload element found:",l),l)console.log("File input element found successfully");else{console.error("CRITICAL: File input element not found! Creating fallback...");const u=document.createElement("input");u.type="file",u.name="menuPhotos",u.accept="image/*",u.multiple=!0,u.className="hidden",u.id="menu-photos-upload";const y=document.getElementById("order-menu-form");y&&(y.appendChild(u),console.log("Fallback file input created and added to form"))}document.getElementById("remove-all-menu-photos"),i&&l&&(i.addEventListener("click",()=>{l.click()}),l.addEventListener("change",u=>{const y=Array.from(u.target.files);if(y.length>0){const v=y.filter(p=>p.size/1048576<=5);if(v.length!==y.length){const p=document.getElementById("file-size-error");p&&(p.classList.remove("hidden"),p.textContent=`Some files were too large. Only files under 5MB are allowed. ${v.length}/${y.length} files uploaded.`)}E=[...E,...v],m(),i.classList.remove("border-red-300","bg-red-50"),i.classList.add("border-gray-300","bg-gray-50"),i.innerHTML=`
            <div class="flex flex-col items-center">
              <svg class="w-16 h-16 text-green-500 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M5 13l4 4L19 7"></path>
              </svg>
              <p class="text-green-600 mb-2 font-medium">${v.length} photo(s) uploaded successfully</p>
              <p class="text-sm text-gray-500">Total: ${E.length} photos uploaded</p>
              <button type="button" onclick="document.getElementById('menu-photos-upload').click()" class="mt-4 px-6 py-3 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg transition-all transform hover:scale-105 shadow-lg">
                <svg class="w-5 h-5 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                </svg>
                Add More Photos
              </button>
            </div>
          `,l.value=""}}));function m(){if(E.length>0){g.classList.remove("hidden"),h.innerHTML="";const u=document.createElement("div");u.className="col-span-full mb-4 p-4 bg-green-50 border border-green-200 rounded-lg",u.innerHTML=`
          <div class="flex items-center justify-between">
            <div class="flex items-center">
              <svg class="w-6 h-6 text-green-600 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
              </svg>
              <div>
                <span class="text-green-800 font-semibold text-lg">${E.length} Photo(s) Uploaded</span>
                <p class="text-sm text-green-600">Menu photos ready for your order system</p>
              </div>
            </div>
            <button type="button" onclick="removeAllMenuPhotos()" class="px-4 py-2 bg-red-500 hover:bg-red-600 text-white text-sm font-medium rounded-lg transition-colors">
              <svg class="w-4 h-4 mr-1 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
              </svg>
              Remove All
            </button>
          </div>
        `,h.appendChild(u),E.forEach((y,v)=>{const p=new FileReader;p.onload=_=>{const B=document.createElement("div");B.className="relative group bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm hover:shadow-md transition-shadow",B.innerHTML=`
              <div class="relative">
                <img src="${_.target.result}" alt="Menu photo ${v+1}" class="w-full h-32 object-cover">
                <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-all duration-200 flex items-center justify-center">
                  <button type="button" class="opacity-0 group-hover:opacity-100 bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm hover:bg-red-600 transition-all duration-200 shadow-lg" onclick="removeMenuPhoto(${v})">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                  </button>
                </div>
              </div>
              <div class="p-3">
                <p class="text-sm text-gray-700 font-medium truncate">${y.name}</p>
                <p class="text-xs text-gray-500">${(y.size/1024/1024).toFixed(2)} MB</p>
              </div>
            `,h.appendChild(B)},p.readAsDataURL(y)})}else g.classList.add("hidden")}window.removeMenuPhoto=u=>{console.log("removeMenuPhoto called, index:",u),console.log("Before removal - menuPhotos length:",E.length),E.splice(u,1),console.log("After removal - menuPhotos length:",E.length),m(),E.length===0&&(i.innerHTML=`
          <div class="flex flex-col items-center">
            <svg class="w-16 h-16 text-red-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
            </svg>
            <p class="text-red-600 mb-2 font-medium">Menu photos required!</p>
            <p class="text-sm text-gray-500 mb-2">Please upload at least one menu photo to continue</p>
            <div class="mt-3 flex items-center text-xs text-red-500 font-medium">
              <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              This field is mandatory
            </div>
          </div>
        `,i.classList.add("border-red-300","bg-red-50"),i.classList.remove("border-gray-300","bg-gray-50"))},window.removeAllMenuPhotos=()=>{console.log("removeAllMenuPhotos called"),console.log("Before removal - menuPhotos length:",E.length),E=[],console.log("After removal - menuPhotos length:",E.length),m(),l.value="",i.innerHTML=`
        <div class="flex flex-col items-center">
          <svg class="w-16 h-16 text-red-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
          </svg>
          <p class="text-red-600 mb-2 font-medium">Menu photos required!</p>
          <p class="text-sm text-gray-500 mb-2">Please upload at least one menu photo to continue</p>
          <div class="mt-3 flex items-center text-xs text-red-500 font-medium">
            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            This field is mandatory
          </div>
        </div>
      `,i.classList.add("border-red-300","bg-red-50"),i.classList.remove("border-gray-300","bg-gray-50")};const b=document.getElementById("add-menu-item"),S=document.getElementById("menu-items-container"),x=document.getElementById("oms-category-input"),z=document.getElementById("oms-add-category-btn"),M=document.getElementById("oms-clear-all-categories-btn"),C=document.getElementById("oms-category-pills"),j=document.getElementById("oms-current-category"),G=document.getElementById("oms-prev-page"),V=document.getElementById("oms-next-page"),W=document.getElementById("oms-page-indicator"),N=[];let A=-1;const D=6;let L=1;function I(){C.innerHTML="",N.forEach((u,y)=>{const v=document.createElement("button");v.type="button",v.className=`px-3 py-1 rounded-full text-sm ${y===A?"bg-amber-600 text-white":"bg-gray-100"} flex items-center`;const p=document.createElement("span");p.textContent=u,p.className="mr-2",v.appendChild(p);const _=document.createElement("span");_.textContent="✕",_.className="text-xs opacity-70 hover:opacity-100 ml-1",_.addEventListener("click",B=>{B.stopPropagation();const w=N.splice(y,1)[0];A>=N.length&&(A=N.length-1),S.querySelectorAll(".menu-item-row").forEach(te=>{const U=te.querySelector(".oms-category-field");U&&U.value===w&&(U.value="")}),j.textContent=N[A]||"Uncategorized",I(),k()}),v.appendChild(_),v.addEventListener("click",()=>{A=y,j.textContent=u,I(),k()}),C.appendChild(v)})}M?.addEventListener("click",()=>{N.splice(0,N.length),A=-1,j.textContent="Uncategorized",I(),k(),S.querySelectorAll(".oms-category-field").forEach(u=>u.value="")}),z?.addEventListener("click",()=>{const u=x.value.trim();u&&(N.includes(u)||(N.push(u),A=N.length-1,j.textContent=u,I(),S.querySelectorAll(".oms-category-field").forEach(y=>{y.value||(y.value=u)}),x.value=""))});function k(){const u=Array.from(S.querySelectorAll(".menu-item-row"));if(u.forEach(p=>p.style.display=""),A>=0){const p=N[A];u.forEach(_=>{const B=_.querySelector(".oms-category-field");B&&B.value&&B.value!==p&&(_.style.display="none")})}const y=u.filter(p=>p.style.display!=="none"),v=Math.max(1,Math.ceil(y.length/D));L=Math.min(L,v),W.textContent=`Page ${L} / ${v}`,y.forEach((p,_)=>{const B=Math.floor(_/D)+1;p.style.display=B===L?"":"none"})}G?.addEventListener("click",()=>{L>1&&(L-=1,k())}),V?.addEventListener("click",()=>{L+=1,k()}),r?.addEventListener("change",u=>{const y=u.target.files[0];if(y){const v=y.name,p=(y.size/1024/1024).toFixed(2);a.innerHTML=`
          <div class="flex flex-col items-center">
            <svg class="w-12 h-12 text-green-500 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
            <p class="text-green-600 mb-1 font-medium">Logo uploaded successfully</p>
            <p class="text-sm text-gray-500">${v} (${p} MB)</p>
          </div>
        `}});const Q=document.querySelectorAll(".menu-style-option");Q.forEach(u=>{u.addEventListener("click",()=>{Q.forEach(v=>{v.classList.remove("border-primary-500","bg-primary-50"),v.classList.add("border-gray-200")}),u.classList.remove("border-gray-200"),u.classList.add("border-primary-500","bg-primary-50");const y=u.querySelector('input[type="radio"]');y&&(y.checked=!0)})});function H(){const u=e?.querySelectorAll('input[type="color"]'),y=e?.querySelectorAll('input[name$="ColorText"]');u?.forEach((v,p)=>{const _=y?.[p];_&&(v.addEventListener("input",()=>{_.value=v.value}),_.addEventListener("input",()=>{/^#[0-9A-F]{6}$/i.test(_.value)&&(v.value=_.value)}))})}H();let K=1;if(b?.addEventListener("click",()=>{const u=document.createElement("div");if(u.className="menu-item-row grid grid-cols-1 md:grid-cols-4 gap-4 mb-4 p-4 border border-gray-200 rounded-lg",u.innerHTML=`
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Item Name</label>
          <input type="text" name="menuItems[${K}][item_name]" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500" placeholder="e.g., Margherita Pizza" required>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Price (₹)</label>
          <input type="number" name="menuItems[${K}][price]" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500" placeholder="299" step="0.01" required>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Category</label>
          <input type="text" name="menuItems[${K}][item_category]" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 oms-category-field" placeholder="Type or pick from pills" required>
        </div>
        <div class="flex items-end">
          <button type="button" class="remove-menu-item px-3 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 text-sm">
            Remove
          </button>
        </div>
      `,S?.appendChild(u),K++,A>=0){const y=N[A],v=u.querySelector(".oms-category-field");v&&!v.value&&(v.value=y)}k()}),S?.addEventListener("click",u=>{u.target.classList.contains("remove-menu-item")&&(u.target.closest(".menu-item-row").remove(),k())}),k(),t?.addEventListener("click",()=>{O=!0,q(),F(),window.history.replaceState({},document.title,window.location.pathname)}),o?.addEventListener("click",()=>{O=!0,q(),F(),window.history.replaceState({},document.title,window.location.pathname)}),console.log("Adding form submission event listener to form:",e),e){let u=function(){const p=document.getElementById("order-menu-logo-upload"),_=document.getElementById("order-menu-logo-upload-area");console.log("Setting up logo upload - elements found:",{logoUpload:!!p,logoUploadArea:!!_}),p&&_?(_.replaceWith(_.cloneNode(!0)),document.getElementById("order-menu-logo-upload-area").addEventListener("click",w=>{console.log("Logo upload area clicked!"),w.preventDefault(),w.stopPropagation(),console.log("Triggering file input click..."),p.click(),console.log("File input click triggered")}),console.log("Logo upload click handler attached successfully")):console.error("Logo upload elements not found!")};e.addEventListener("submit",async p=>{console.log("Form submit event triggered!"),p.preventDefault();const _=window.globalAuthManager||window.simpleAuthManager;if(!_||!_.isUserLoggedIn()){alert("❌ Please log in to submit this form. You must be authenticated to place an order.");return}const B=new FormData(e),w=Object.fromEntries(B);if(console.log("Form submission - menuPhotos length:",E.length),E.length===0){const f=document.getElementById("menu-photos-error");f&&(f.classList.remove("hidden"),f.textContent="Please upload at least one menu photo. This field is required for Order Menu System."),console.log("Form submission blocked - no menu photos");return}if(console.log("Form submission allowed - menu photos present"),!w.phone||w.phone.trim()===""){const f=document.getElementById("phone-validation-error");f&&(f.classList.remove("hidden"),f.textContent="Please enter your phone number. This field is required.");return}if(!w.houseNumber||w.houseNumber.trim()===""){const f=document.getElementById("address-validation-error");f&&(f.classList.remove("hidden"),f.textContent="Please enter house/flat number. This field is required.");return}if(!w.addressLine1||w.addressLine1.trim()===""){const f=document.getElementById("address-validation-error");f&&(f.classList.remove("hidden"),f.textContent="Please enter address line 1. This field is required.");return}if(!w.city||w.city.trim()===""){const f=document.getElementById("address-validation-error");f&&(f.classList.remove("hidden"),f.textContent="Please enter city. This field is required.");return}if(!w.state||w.state.trim()===""){const f=document.getElementById("address-validation-error");f&&(f.classList.remove("hidden"),f.textContent="Please enter state. This field is required.");return}if(!w.pincode||w.pincode.trim()===""){const f=document.getElementById("address-validation-error");f&&(f.classList.remove("hidden"),f.textContent="Please enter pincode. This field is required.");return}if(!w.email||w.email.trim()===""){const f=document.getElementById("email-validation-error");f&&(f.classList.remove("hidden"),f.textContent="Please enter your email address. This field is required.");return}console.log("📝 Order Menu requirements saved:",w),["validation-errors","menu-photos-error","phone-validation-error","address-validation-error","email-validation-error","file-size-error","warning-message","popup-message","error-message"].forEach(f=>{const T=document.getElementById(f);T&&T.classList.add("hidden")});const U={productId:"5",productName:"Order Menu System",productDescription:"Complete order management system with digital menu integration, real-time order tracking, and payment processing. Perfect for restaurants looking to streamline their ordering process.",productPrice:"₹1,179",projectName:w.projectName,restaurantName:w.restaurantName,ownerName:w.ownerName,houseNumber:w.houseNumber,addressLine1:w.addressLine1,city:w.city,state:w.state,pincode:w.pincode,country:w.country,contactPerson:w.contactPerson,email:w.email,phone:w.phone,additionalRequirements:w.additionalRequirements,restaurantLogo:w.restaurantLogo,menuPhotos:E||[],timestamp:new Date().toISOString()};try{console.log("💾 Saving OMS data to Supabase...");const{supabase:f}=await Y(async()=>{const{supabase:T}=await import("./supabase.DO6XXPT9.js");return{supabase:T}},__vite__mapDeps([0,1]));if(f){const{data:T,error:X}=await f.rpc("upsert_oms_customization",{p_user_email:data.email,p_project_name:data.projectName,p_restaurant_name:data.restaurantName,p_owner_name:data.ownerName,p_restaurant_address:`${data.houseNumber}, ${data.addressLine1}, ${data.city}, ${data.state} ${data.pincode}, ${data.country}`,p_contact_person:data.contactPerson,p_phone_number:data.phone,p_house_number:data.houseNumber,p_address_line1:data.addressLine1,p_city:data.city,p_state:data.state,p_pincode:data.pincode,p_country:data.country,p_contact_person:data.contactPerson,p_phone_number:data.phone,p_user_id:null,p_logo_url:null,p_logo_filename:null,p_logo_size:null,p_additional_requirements:data.additionalRequirements||""});if(X){console.error("❌ Error saving to Supabase:",X);const R=JSON.parse(localStorage.getItem("order-menu-requirements")||"[]");R.push(U),localStorage.setItem("order-menu-requirements",JSON.stringify(R));const P=document.getElementById("success-message");P&&(P.classList.remove("hidden"),P.textContent="Order Menu requirements saved locally! Our team will contact you soon.")}else if(T&&T.length>0){const R=T[0];if(R.is_duplicate){let P="";R.duplicate_type==="exact"?P="This exact data has already been submitted. Please check your existing orders or contact support if you need to make changes.":R.duplicate_type==="contact"?P="Data with the same contact person and phone number already exists. The existing record has been updated with your new project information.":R.duplicate_type==="restaurant"?P="A restaurant with this name already exists, but your project name is different. A new record has been created.":P="This data has already been submitted. Please check your existing orders or contact support if you need to make changes.";const oe=document.getElementById("warning-message");oe&&(oe.classList.remove("hidden"),oe.textContent=`⚠️ ${P}`)}else{console.log("✅ OMS data saved to Supabase with ID:",R.data_id);const P=document.getElementById("success-message");if(P&&(P.classList.remove("hidden"),P.textContent="Order Menu requirements saved successfully! Opening payment page..."),setTimeout(()=>{ce()},1e3),window.open("https://payments.pabbly.com/subscribe/68c084369dbcfe4b619b80ce/six-months-inr","_blank"))setTimeout(()=>{window.location.href="/orders?order=success&product=order-menu-system"},2e3);else{const se=document.getElementById("popup-message");se&&(se.classList.remove("hidden"),se.textContent="Please allow popups for this site to proceed with payment, or click the payment link manually.");const de=document.createElement("div");de.innerHTML=`
                  <div style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
                              background: white; padding: 20px; border: 2px solid #4CAF50; 
                              border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 9999;">
                    <h3 style="color: #4CAF50; margin-bottom: 15px;">Payment Required</h3>
                    <p style="margin-bottom: 15px;">Please complete your payment to proceed:</p>
                    <a href="https://payments.pabbly.com/subscribe/68c084369dbcfe4b619b80ce/six-months-inr" 
                       target="_blank" style="display: inline-block; padding: 10px 20px; 
                       background: #4CAF50; color: white; text-decoration: none; border-radius: 5px;">
                      Open Payment Page
                    </a>
                    <button onclick="this.parentElement.remove()" style="margin-left: 10px; padding: 10px 15px; 
                            background: #f44336; color: white; border: none; border-radius: 5px; cursor: pointer;">
                      Close
                    </button>
                  </div>
                `,document.body.appendChild(de)}}}else{console.error("❌ No data returned from OMS function");const R=JSON.parse(localStorage.getItem("order-menu-requirements")||"[]");R.push(U),localStorage.setItem("order-menu-requirements",JSON.stringify(R));const P=document.getElementById("success-message");P&&(P.classList.remove("hidden"),P.textContent="Order Menu requirements saved locally! Our team will contact you soon.")}}else{console.error("❌ Supabase not available, saving locally only");const T=JSON.parse(localStorage.getItem("order-menu-requirements")||"[]");T.push(U),localStorage.setItem("order-menu-requirements",JSON.stringify(T));const X=document.getElementById("success-message");X&&(X.classList.remove("hidden"),X.textContent="Order Menu requirements saved locally! Our team will contact you soon.")}window.history.replaceState({},document.title,window.location.pathname),q(),e.reset()}catch(f){console.error("Error saving order menu requirements:",f);const T=document.getElementById("error-message");T&&(T.classList.remove("hidden"),T.textContent="Error saving order menu requirements. Please try again.")}}),console.log("OMS Logo upload elements:",{logoUpload:!!r,logoUploadArea:!!a,logoPreview:!!n,logoPreviewImg:!!s,logoFilename:!!c,logoRemoveBtn:!!d}),u();const y=new MutationObserver(p=>{p.forEach(_=>{if(_.type==="attributes"&&_.attributeName==="class"){const B=document.getElementById("order-menu-customization-form");B&&!B.classList.contains("hidden")&&(console.log("Order menu form is now visible, setting up logo upload..."),u())}})}),v=document.getElementById("order-menu-customization-form");v&&y.observe(v,{attributes:!0,attributeFilter:["class"]}),r&&(r.addEventListener("change",p=>{console.log("OMS Logo upload change event triggered");const _=p.target.files[0];if(_){console.log("File selected:",_.name);const B=new FileReader;B.onload=w=>{console.log("File reader onload triggered"),s.src=w.target.result,c.textContent=_.name,n.classList.remove("hidden"),console.log("Updating logoUploadArea innerHTML"),a.innerHTML=`
              <div class="flex flex-col items-center">
                <svg class="w-12 h-12 text-green-500 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                <p class="text-green-600 mb-1 font-medium">Logo uploaded successfully</p>
                <p class="text-sm text-gray-500">${_.name}</p>
                <button type="button" id="change-logo-btn-oms" class="mt-2 text-sm text-blue-600 hover:text-blue-800 underline" style="display: block !important; visibility: visible !important;">Change Logo</button>
              </div>
            `;const te=document.getElementById("change-logo-btn-oms");te&&te.addEventListener("click",U=>{U.preventDefault(),U.stopPropagation();const f=document.getElementById("order-menu-logo-upload");f?f.click():console.error("order-menu-logo-upload element not found when clicking change logo button")}),console.log("LogoUploadArea innerHTML updated")},B.readAsDataURL(_)}}),d?.addEventListener("click",p=>{p.preventDefault(),p.stopPropagation(),r.value="",n.classList.add("hidden"),a.innerHTML=`
          <div class="flex flex-col items-center">
            <svg class="w-12 h-12 text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
            </svg>
            <p class="text-gray-600 mb-2">Click to upload restaurant logo</p>
            <p class="text-sm text-gray-500">PNG, JPG, SVG up to 10MB</p>
          </div>
        `})),console.log("Setting up Order Menu form event listeners..."),console.log("Close button found:",t),console.log("Cancel button found:",o),document.addEventListener("click",p=>{p.target&&p.target.id==="close-order-menu-form"&&(console.log("Close button clicked via delegation!"),p.preventDefault(),document.getElementById("order-menu-customization-form").classList.add("hidden"),window.history.replaceState({},document.title,window.location.pathname),O=!0,q(),F()),p.target&&p.target.id==="cancel-order-menu"&&(console.log("Cancel button clicked via delegation!"),p.preventDefault(),document.getElementById("order-menu-customization-form").classList.add("hidden"),window.history.replaceState({},document.title,window.location.pathname),O=!0,q(),F())}),t?(console.log("✅ Adding direct event listener to close button"),t.addEventListener("click",p=>{console.log("Close button clicked via direct listener!"),p.preventDefault(),document.getElementById("order-menu-customization-form").classList.add("hidden"),window.history.replaceState({},document.title,window.location.pathname),O=!0,q(),F()})):console.log("❌ Close button not found for direct event listener"),o?(console.log("✅ Adding direct event listener to cancel button"),o.addEventListener("click",p=>{console.log("Cancel button clicked via direct listener!"),p.preventDefault(),document.getElementById("order-menu-customization-form").classList.add("hidden"),window.history.replaceState({},document.title,window.location.pathname),O=!0,q(),F()})):console.log("❌ Cancel button not found for direct event listener")}else console.error("Form not found - cannot add event listener");xe(),Le(),e?e.addEventListener("submit",u=>{if(console.log("Form submit event triggered!"),u.preventDefault(),u.stopPropagation(),E.length===0){console.log("❌ Menu photos validation failed - no photos uploaded");const y=document.getElementById("menu-photos-error");y&&(y.classList.remove("hidden"),y.innerHTML='<div class="bg-red-50 border border-red-200 rounded-lg p-3"><p class="text-red-700 font-medium">Please upload at least one menu photo. This field is required for Order Menu System.</p></div>');const v=document.getElementById("validation-errors");v&&(v.classList.remove("hidden"),v.innerHTML='<div class="bg-red-50 border border-red-200 rounded-lg p-4"><h4 class="text-red-800 font-semibold mb-2">Please fix the following errors:</h4><ul class="list-disc list-inside text-red-700 space-y-1"><li>Please upload at least one menu photo. This field is required for Order Menu System.</li></ul></div>');const p=document.getElementById("menu-photos-upload-area");return p&&p.scrollIntoView({behavior:"smooth",block:"center"}),!1}if(!pe())return console.log("❌ Form validation failed - required fields missing"),!1;console.log("✅ All validations passed, proceeding with form submission"),ge()}):console.error("Form not found for submit event listener")}async function ge(){console.log("🚀 Handling Order Menu Form submission...");const e=document.getElementById("order-menu-form");if(!e){console.error("Order menu form not found");return}const t=window.globalAuthManager||window.simpleAuthManager;if(!t||!t.isUserLoggedIn()){alert("❌ Please log in to submit this form. You must be authenticated to place an order.");return}const o=new FormData(e),r=Object.fromEntries(o);console.log("📝 Form data collected:",r);try{const a={product_name:"Order Menu System",project_name:r.projectName,owner_name:r.ownerName,contact_person:r.contactPerson,email:r.email,phone_number:r.phone,house_flat_number:r.houseNumber,address_line_1:r.addressLine1,city:r.city,state:r.state,pincode:r.pincode,country:r.country,restaurant_name:r.restaurantName,restaurant_logo_url:null,menu_photos_urls:[],additional_requirements:r.additionalRequirements||"",total_amount:1179,status:"pending_payment"};console.log("💾 Saving order customization data:",a);const{data:n,error:s}=await supabase.from("order_customizations").insert([a]).select();if(s){console.error("❌ Error saving order customization:",s),alert("❌ Error saving your order. Please try again.");return}console.log("✅ Order customization saved successfully:",n);const c=document.getElementById("validation-errors");c&&(c.classList.remove("hidden"),c.innerHTML='<div class="bg-green-50 border border-green-200 rounded-lg p-4"><h4 class="text-green-800 font-semibold mb-2">✅ Order Submitted Successfully!</h4><p class="text-green-700">Your order has been saved. You will be redirected to the payment page.</p></div>'),setTimeout(()=>{window.location.href="https://payments.pabbly.com/subscribe/68c084369dbcfe4b619b80ce/six-months-inr"},2e3)}catch(a){console.error("❌ Error in form submission:",a),alert("❌ An error occurred while submitting your order. Please try again.")}}function Be(){const e=document.getElementById("customization-form"),t=document.getElementById("close-customization-form"),o=document.getElementById("cancel-customization"),r=document.getElementById("restaurant-logo-upload"),a=document.getElementById("restaurant-logo-upload-area"),n=document.getElementById("restaurant-logo-preview"),s=document.getElementById("restaurant-logo-preview-img"),c=document.getElementById("restaurant-logo-filename"),d=document.getElementById("restaurant-logo-remove");a&&(a.onclick=()=>{const i=document.getElementById("restaurant-logo-upload");i?i.click():console.error("restaurant-logo-upload element not found in initial handler")}),r?.addEventListener("change",i=>{const g=i.target.files[0];if(g){const h=new FileReader;h.onload=m=>{s.src=m.target.result,c.textContent=g.name,n.classList.remove("hidden"),a.innerHTML=`
            <div class="flex flex-col items-center">
              <svg class="w-12 h-12 text-green-500 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
              </svg>
              <p class="text-green-600 mb-1 font-medium">Logo uploaded successfully</p>
              <p class="text-sm text-gray-500">${g.name}</p>
              <button type="button" onclick="const el = document.getElementById('restaurant-logo-upload'); if(el) el.click(); else console.error('restaurant-logo-upload element not found in button onclick');" class="mt-2 text-sm text-blue-600 hover:text-blue-800">Change Logo</button>
            </div>
          `},h.readAsDataURL(g)}}),d?.addEventListener("click",i=>{i.preventDefault(),i.stopPropagation(),r.value="",n.classList.add("hidden"),a.innerHTML=`
        <div class="flex flex-col items-center">
          <svg class="w-12 h-12 text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
          </svg>
          <p class="text-gray-600 mb-2">Click to upload logo</p>
          <p class="text-sm text-gray-500">PNG, JPG, SVG up to 10MB</p>
        </div>
      `,a.onclick=()=>{const g=document.getElementById("restaurant-logo-upload");g?g.click():console.error("restaurant-logo-upload element not found in reset handler")}});function l(){const i=e?.querySelectorAll('input[type="color"]'),g=e?.querySelectorAll('input[name$="ColorText"]');i?.forEach((h,m)=>{const b=g?.[m];b&&(h.addEventListener("input",()=>{b.value=h.value}),b.addEventListener("input",()=>{/^#[0-9A-F]{6}$/i.test(b.value)&&(h.value=b.value)}))})}l(),t?.addEventListener("click",()=>{O=!0,q(),F(),window.history.replaceState({},document.title,window.location.pathname)}),o?.addEventListener("click",()=>{O=!0,q(),F(),window.history.replaceState({},document.title,window.location.pathname)}),e?.addEventListener("submit",async i=>{i.preventDefault(),console.log("🚀 FORM SUBMIT EVENT TRIGGERED!"),console.log("🚀 Form element:",e),console.log("🚀 Event target:",i.target);const g=window.globalAuthManager||window.simpleAuthManager;if(!g||!g.isUserLoggedIn()){alert("❌ Please log in to submit this form. You must be authenticated to place an order.");return}const h=new FormData(e),m=Object.fromEntries(h);console.log("📝 Project requirements saved:",m),console.log("📝 Form data keys:",Object.keys(m)),console.log("📝 Form data values:",Object.values(m));const b=document.getElementById("selected-product-name").textContent,S=document.getElementById("selected-product-price").textContent;if(b&&b.toLowerCase().includes("order menu")){console.log("🧪 Order Menu System detected, saving to database...");const z={project_name:m.projectName||"Form Submit Project",restaurant_name:m.restaurantName||"Form Submit Restaurant",owner_name:m.ownerName||"Form Submit Owner",contact_person:m.contactPerson||"Form Submit Contact",email:m.email||"form@submit.com",phone_number:m.phone||"1234567890",house_flat_number:m.houseNumber||"123",address_line_1:m.addressLine1||"Form Submit Address",city:m.city||"Form Submit City",state:m.state||"Form Submit State",pincode:m.pincode||"123456",country:m.country||"India",restaurant_logo_url:null,menu_photos_urls:[],additional_requirements:m.additionalRequirements||"Form submit requirements",base_package_cost:999,gst_amount:180,total_amount:1179,status:"pending",payment_status:"pending"};console.log("🧪 Insert data prepared:",z);try{console.log("🧪 Saving to Supabase...");const{data:M,error:C}=await window.supabase.from("order_customizations").insert(z).select();C?(console.error("❌ Form submit save failed:",C),alert("❌ Form submit save failed: "+C.message)):(console.log("✅ Form submit save successful!",M),alert("✅ Data saved successfully to Supabase!"))}catch(M){console.error("❌ Form submit save error:",M),alert("❌ Form submit save error: "+M.message)}}else console.log("🧪 Not Order Menu System, skipping database save"),console.log("🧪 Product name was:",b);const x={productId:new URLSearchParams(window.location.search).get("product")||"1",productName:b,productPrice:S,projectName:m.projectName,appName:m.appName,contactPerson:m.contactPerson,productDescriptionCustom:m.productDescription,email:m.email,phone:m.phone,additionalRequirements:m.additionalRequirements,restaurantLogo:m.restaurantLogo,timestamp:new Date().toISOString()};x.restaurantName=m.restaurantName||x.restaurantName||"",x.cuisineType=m.cuisineType||x.cuisineType||"";try{console.log("💾 Saving project form to database...");const M=(L=>(L||"").toLowerCase())(b);let C="restaurant-website";M.includes("order menu")?C="restaurant-menu-system":M.includes("restaurant website")?C="restaurant-website":M.includes("android tv")?C="android-tv-app":M.includes("streaming")&&(C="streaming-mobile-app");let j=x.logoUrl||null,G=x.logoFilename||null,V=x.logoMimeType||null,W=x.logoSize||null;try{const I=e.querySelector('input[name="restaurantLogo"]')?.files?.[0];if(I){const{supabase:k}=await Y(async()=>{const{supabase:y}=await import("./supabase.DO6XXPT9.js");return{supabase:y}},__vite__mapDeps([0,1])),Q=I.name.replace(/\s+/g,"_");if(I.size>10*1024*1024)throw new Error("Logo file exceeds 10MB limit");const H=`${Date.now()}_${Q}`,K=await I.arrayBuffer(),{error:u}=await k.storage.from("logos").upload(H,K,{upsert:!0,contentType:I.type,cacheControl:"3600"});if(!u){const{data:y}=k.storage.from("logos").getPublicUrl(H);if(j=y?.publicUrl||null,!j){const{data:v,error:p}=await k.storage.from("logos").createSignedUrl(H,31536e3);p||(j=v?.signedUrl||null)}G=I.name,V=I.type,W=I.size}}}catch(L){console.warn("Logo upload skipped:",L)}let N=[];if(M.includes("order menu")&&E.length>0)try{const{supabase:L}=await Y(async()=>{const{supabase:I}=await import("./supabase.DO6XXPT9.js");return{supabase:I}},__vite__mapDeps([0,1]));for(let I=0;I<E.length;I++){const k=E[I],Q=k.name.replace(/\s+/g,"_"),H=`menu_photos/${Date.now()}_${I}_${Q}`,K=await k.arrayBuffer(),{error:u}=await L.storage.from("logos").upload(H,K,{upsert:!0,contentType:k.type,cacheControl:"3600"});if(!u){const{data:y}=L.storage.from("logos").getPublicUrl(H);N.push({url:y?.publicUrl||null,filename:k.name,mimeType:k.type,size:k.size})}}}catch(L){console.warn("Menu photos upload skipped:",L)}const A={productName:b,productPrice:S,projectName:x.projectName,contactPerson:x.contactPerson,appName:x.appName,productDescription:x.productDescriptionCustom,restaurantName:x.restaurantName,cuisineType:x.cuisineType,email:x.email,phone:x.phone,primaryColor:x.primaryColor,secondaryColor:x.secondaryColor,accentColor:x.accentColor,textColor:x.textColor,additionalRequirements:x.additionalRequirements,logoUrl:j,logoFilename:G,logoMimeType:V,logoSize:W,menuPhotosUrls:JSON.stringify(N)},D=await be(A,C);if(D.success)console.log("✅ Project form saved to Supabase database:",D.data),alert(`✅ Project requirements saved to database successfully!

Record ID: ${D.data.id}
Project: ${D.data.project_name}
Restaurant: ${D.data.restaurant_name||"N/A"}
Cuisine: ${D.data.cuisine_type||"N/A"}

Our team will contact you soon!`);else{console.error("❌ Error saving to database:",D.error);const L=JSON.parse(localStorage.getItem("project-requirements")||"[]");L.push(x),localStorage.setItem("project-requirements",JSON.stringify(L)),alert(`❌ Database save failed: ${D.error}

Data saved locally as backup. Our team will contact you soon.`)}window.history.replaceState({},document.title,window.location.pathname),q(),e.reset(),a&&(a.innerHTML=`
            <div class="flex flex-col items-center">
              <svg class="w-12 h-12 text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
              </svg>
              <p class="text-gray-600 mb-2">Click to upload restaurant logo</p>
              <p class="text-sm text-gray-500">PNG, JPG, SVG up to 10MB</p>
            </div>
          `)}catch(z){console.error("Error saving requirements:",z),alert("Error saving project requirements. Please try again.")}})}function q(){console.log("🔄 Showing browse products section...");const e=document.getElementById("product-customization-form"),t=document.getElementById("order-menu-customization-form"),o=document.getElementById("recent-activity");console.log("Recent activity element found:",o),e&&!e.classList.contains("hidden")&&(console.log("Hiding product form..."),e.style.transition="opacity 0.3s ease-in-out, transform 0.3s ease-in-out",e.style.opacity="0",e.style.transform="translateY(-10px)",setTimeout(()=>e.classList.add("hidden"),300)),t&&!t.classList.contains("hidden")&&(console.log("Hiding order menu form..."),t.style.transition="opacity 0.3s ease-in-out, transform 0.3s ease-in-out",t.style.opacity="0",t.style.transform="translateY(-10px)",setTimeout(()=>t.classList.add("hidden"),300)),setTimeout(()=>{o?(console.log("Showing recent activity section..."),o.style.display="block",o.classList.remove("hidden"),o.style.transition="opacity 0.3s ease-in-out, transform 0.3s ease-in-out",o.style.opacity="0",o.style.transform="translateY(10px)",setTimeout(()=>{o.style.opacity="1",o.style.transform="translateY(0)",console.log("✅ Browse products section is now visible"),console.log("Recent activity display style:",o.style.display),console.log("Recent activity class list:",o.classList.toString())},50)):console.error("❌ Recent activity element not found!")},350)}window.showBrowseProductsSection=q;document.addEventListener("submit",e=>{if(console.log("🚫 FORM SUBMISSION EVENT DETECTED!"),console.log("🚫 Event target:",e.target),console.log("🚫 Event target ID:",e.target.id),console.log("🚫 Event target tagName:",e.target.tagName),console.log("🚫 Global form submission intercepted:",e.target.id),console.log("🚫 Current menuPhotos length:",typeof E<"u"?E.length:"undefined"),e.target.id==="order-menu-form"){e.preventDefault(),e.stopPropagation(),console.log("🔍 Validating order-menu-form submission..."),console.log("🔍 menuPhotos variable:",E),console.log("🔍 menuPhotos type:",typeof E),console.log("🔍 menuPhotos length:",E?E.length:"undefined");const t=document.getElementById("menu-photos-upload"),o=E&&E.length>0||t&&t.files&&t.files.length>0;if(console.log("🔍 menuPhotos array length:",E?E.length:"undefined"),console.log("🔍 menuPhotosInput files length:",t?t.files.length:"undefined"),console.log("🔍 hasMenuPhotos:",o),!o){console.log("❌ Menu photos validation failed - no photos uploaded");const a=document.getElementById("menu-photos-error");a&&(a.classList.remove("hidden"),a.innerHTML='<div class="bg-red-50 border border-red-200 rounded-lg p-3"><p class="text-red-700 font-medium">Please upload at least one menu photo. This field is required for Order Menu System.</p></div>');const n=document.getElementById("validation-errors");n&&(n.classList.remove("hidden"),n.innerHTML='<div class="bg-red-50 border border-red-200 rounded-lg p-4"><h4 class="text-red-800 font-semibold mb-2">Please fix the following errors:</h4><ul class="list-disc list-inside text-red-700 space-y-1"><li>Please upload at least one menu photo. This field is required for Order Menu System.</li></ul></div>');const s=document.getElementById("menu-photos-upload-area");return s&&s.scrollIntoView({behavior:"smooth",block:"center"}),!1}console.log("🔍 Running form field validation...");const r=pe();if(console.log("🔍 Form validation result:",r),!r)return console.log("❌ Form validation failed - required fields missing"),!1;console.log("✅ All validations passed, proceeding with form submission"),ge()}else e.preventDefault(),e.stopPropagation(),console.log("❌ Form submission blocked - only order-menu-form is allowed"),alert("❌ Form submission is not allowed. Please use the Order Menu System form.")});document.addEventListener("click",e=>{if(e.target.type==="submit"||e.target.getAttribute("type")==="submit"){if(console.log("🚫 SUBMIT BUTTON CLICKED!"),console.log("🚫 Button element:",e.target),console.log("🚫 Button form:",e.target.form),console.log("🚫 Form ID:",e.target.form?e.target.form.id:"no form"),e.target.form&&e.target.form.id==="order-menu-form"){console.log("🚫 Order menu form submit button clicked - letting submit event handle it");return}e.preventDefault(),e.stopPropagation(),console.log("❌ Submit button click blocked - only order-menu-form is allowed"),alert("❌ Form submission is not allowed. Please use the Order Menu System form.")}});document.addEventListener("DOMContentLoaded",()=>{console.log("🔧 Setting up global event listeners for order menu form buttons");const e=document.getElementById("close-order-menu-form");e?(console.log("✅ Global close button found, adding event listener"),e.addEventListener("click",o=>{console.log("🚀 Global close button clicked!"),o.preventDefault(),o.stopPropagation();const r=document.getElementById("order-menu-customization-form");r&&r.classList.add("hidden"),window.history.replaceState({},document.title,window.location.pathname),O=!0,q(),F()})):console.log("❌ Global close button not found");const t=document.getElementById("cancel-order-menu");t?(console.log("✅ Global cancel button found, adding event listener"),t.addEventListener("click",o=>{console.log("🚀 Global cancel button clicked!"),o.preventDefault(),o.stopPropagation();const r=document.getElementById("order-menu-customization-form");r&&r.classList.add("hidden"),window.history.replaceState({},document.title,window.location.pathname),O=!0,q(),F()})):console.log("❌ Global cancel button not found")});function Z(){console.log("🔄 Attempting to auto-fill user details...");const e=()=>{const t=window.globalAuthManager||window.simpleAuthManager;if(!t||!t.isUserLoggedIn())return console.log("❌ User not logged in - skipping auto-fill"),!1;const o=t.getCurrentUser();return console.log("👤 Current user from auth manager:",o),!o||!o.email?(console.log("❌ No valid user data found - skipping auto-fill"),!1):!o.id&&!o.user_id?(console.log("❌ User lacks proper authentication ID - skipping auto-fill"),!1):(console.log("✅ User is properly authenticated - proceeding with auto-fill"),o&&o.email&&(console.log("📧 Auto-filling email:",o.email),document.querySelectorAll('input[name="email"], input[type="email"]').forEach(a=>{a.value=o.email,a.dispatchEvent(new Event("input",{bubbles:!0})),a.dispatchEvent(new Event("change",{bubbles:!0})),console.log("✅ Filled email field:",a)})),o&&o.phone&&(console.log("📱 Auto-filling phone:",o.phone),document.querySelectorAll('input[name="phone"], input[type="tel"]').forEach(a=>{a.value=o.phone,a.dispatchEvent(new Event("input",{bubbles:!0})),a.dispatchEvent(new Event("change",{bubbles:!0})),console.log("✅ Filled phone field:",a)})),o&&o.full_name&&(console.log("👤 Auto-filling contact person:",o.full_name),document.querySelectorAll('input[name="contactPerson"]').forEach(a=>{a.value=o.full_name,a.dispatchEvent(new Event("input",{bubbles:!0})),a.dispatchEvent(new Event("change",{bubbles:!0})),console.log("✅ Filled contact person field:",a)})),console.log("✅ Auto-fill completed with auth manager data"),!0)};if(!e()){let t=0;const o=50,r=setInterval(()=>{if(t++,(e()||t>=o)&&(clearInterval(r),t>=o)){console.log("⏰ Auth manager timeout - user appears to be not logged in"),console.log("❌ No authenticated user found - forms will remain empty");return}},100)}}let O=!1;async function ce(){if(console.log("🔄 Loading recent activity..."),!document.getElementById("activity-content")){console.error("Activity content element not found");return}try{const{supabase:t}=await Y(async()=>{const{supabase:s}=await import("./supabase.DO6XXPT9.js");return{supabase:s}},__vite__mapDeps([0,1])),{data:{user:o},error:r}=await t.auth.getUser();if(r||!o){console.error("Error getting user:",r),F();return}const{data:a,error:n}=await t.from("order_customizations").select("*").eq("email",o.email).order("created_at",{ascending:!1}).limit(10);if(n){console.error("Error loading customizations:",n),F();return}if(console.log("📋 Loaded customizations:",a?.length||0),!a||a.length===0){F();return}ke(a)}catch(t){console.error("Error loading recent activity:",t),F()}}function ke(e){const t=document.getElementById("activity-content");t&&(t.innerHTML=`
      <div class="space-y-4">
        ${e.map(o=>`
          <div class="border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors">
            <div class="flex items-start justify-between">
              <div class="flex-1">
                <div class="flex items-center space-x-3">
                  <div class="flex-shrink-0">
                    <div class="w-10 h-10 bg-amber-100 rounded-lg flex items-center justify-center">
                      <svg class="w-5 h-5 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                      </svg>
                    </div>
                  </div>
                  <div class="flex-1 min-w-0">
                    <h4 class="text-sm font-medium text-gray-900">${o.project_name||"Unnamed Project"}</h4>
                    <p class="text-sm text-gray-500">${o.restaurant_name||"Restaurant Name Not Provided"}</p>
                    <div class="mt-1 flex items-center space-x-4 text-xs text-gray-500">
                      <span>Order Menu System</span>
                      <span>•</span>
                      <span>₹${(o.total_amount||0).toLocaleString("en-IN")}</span>
                      <span>•</span>
                      <span>${new Date(o.created_at).toLocaleDateString()}</span>
                    </div>
                  </div>
                </div>
                <div class="mt-3 flex items-center justify-between">
                  <div class="flex items-center space-x-2">
                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                      Submitted
                    </span>
                    ${o.additional_requirements?`
                      <span class="text-xs text-gray-500 truncate max-w-xs">
                        ${o.additional_requirements.substring(0,50)}${o.additional_requirements.length>50?"...":""}
                      </span>
                    `:""}
                  </div>
                  <button onclick="viewOrderDetails('${o.id}')" class="text-sm text-primary-600 hover:text-primary-700 font-medium">
                    View Details
                  </button>
                </div>
              </div>
            </div>
          </div>
        `).join("")}
      </div>
    `)}function F(){const e=document.getElementById("activity-content");e&&(e.innerHTML=`
      <div class="text-center py-8">
        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
        </svg>
        <h3 class="mt-2 text-sm font-medium text-gray-900">No recent activity</h3>
        <p class="mt-1 text-sm text-gray-500">Start by browsing our products and placing your first order.</p>
        <div class="mt-6">
          <a href="/products" class="inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700">
            Browse Products
          </a>
        </div>
      </div>
    `)}window.viewOrderDetails=async function(e){console.log("🔄 Loading order details for:",e);try{const{supabase:t}=await Y(async()=>{const{supabase:n}=await import("./supabase.DO6XXPT9.js");return{supabase:n}},__vite__mapDeps([0,1])),{data:o,error:r}=await t.from("order_customizations").select("*").eq("id",e).single();if(r){console.error("Error loading customization details:",r),alert("Error loading order details: "+r.message);return}const a=`
Order Menu System Details:
=========================

Project Information:
-------------------
Project Name: ${o.project_name||"Not provided"}
Restaurant Name: ${o.restaurant_name||"Not provided"}
Owner Name: ${o.owner_name||"Not provided"}
Contact Person: ${o.contact_person||"Not provided"}

Contact Information:
-------------------
Email: ${o.email||"Not provided"}
Phone: ${o.phone_number||"Not provided"}

Address Information:
------------------
House/Flat Number: ${o.house_flat_number||"Not provided"}
Address: ${o.address_line_1||"Not provided"}
City: ${o.city||"Not provided"}
State: ${o.state||"Not provided"}
Pincode: ${o.pincode||"Not provided"}
Country: ${o.country||"Not provided"}

Additional Requirements:
-----------------------
${o.additional_requirements||"No additional requirements provided"}

Order Details:
-------------
Price: ₹${(o.total_amount||0).toLocaleString("en-IN")}
Submitted: ${new Date(o.created_at).toLocaleString()}
Status: Submitted
      `;alert(a)}catch(t){console.error("Error viewing order details:",t),alert("Error viewing order details: "+t.message)}};document.addEventListener("DOMContentLoaded",()=>{console.log("Dashboard DOM loaded - initializing with global auth manager");const e=new URLSearchParams(window.location.search),t=e.get("product"),o=e.get("price"),r=document.getElementById("recent-activity");if(!t||!o){r&&(r.style.display="block",r.classList.remove("hidden"),console.log("✅ Showing browse products section - no product selected"),O?(F(),O=!1):ce());const c=document.getElementById("product-customization-form"),d=document.getElementById("order-menu-customization-form");c&&c.classList.add("hidden"),d&&d.classList.add("hidden")}else r&&(r.style.display="none",r.classList.add("hidden"),console.log("✅ Hiding browse products section - product selected"));if(document.body.style.opacity="1",t&&o){console.log("URL parameters detected - showing form for product:",t);const d=[{id:"1",name:"Restaurant Menu System",description:"Digital menu system with QR code integration, online ordering, and real-time updates. Perfect for restaurants looking to modernize their customer experience.",price:25e3,type:"restaurant"},{id:"2",name:"Android TV App",description:"Custom Android TV applications with beautiful UI, content management, and remote control support. Perfect for streaming services and media companies.",price:55e3,type:"non-restaurant"},{id:"3",name:"Streaming Mobile App",description:"Mobile streaming applications for iOS and Android with custom features, user authentication, and content management.",price:35e3,type:"non-restaurant"},{id:"4",name:"Restaurant Website",description:"Professional restaurant website with online ordering, menu display, and customer management features.",price:2e4,type:"restaurant"},{id:"5",name:"Order Menu System",description:"Complete order management system with digital menu integration, real-time order tracking, and payment processing. Perfect for restaurants looking to streamline their ordering process.",price:999,type:"order-menu"}].find(l=>l.id===t);if(d){document.getElementById("selected-product-name").textContent=d.name,document.getElementById("selected-product-price").textContent=`₹${d.price.toLocaleString()}`,document.getElementById("order-menu-product-name").textContent=d.name;const l=document.getElementById("recent-activity"),i=document.getElementById("product-customization-form"),g=document.getElementById("order-menu-customization-form");l&&(l.style.transition="opacity 0.3s ease-in-out, transform 0.3s ease-in-out",l.style.opacity="0",l.style.transform="translateY(-10px)",setTimeout(()=>{l.classList.add("hidden")},300)),setTimeout(()=>{if(d.type==="order-menu")g&&(g.classList.remove("hidden"),g.style.transition="opacity 0.3s ease-in-out, transform 0.3s ease-in-out",g.style.opacity="0",g.style.transform="translateY(10px)",setTimeout(()=>{g.style.opacity="1",g.style.transform="translateY(0)"},50));else{i&&(i.classList.remove("hidden"),i.style.transition="opacity 0.3s ease-in-out, transform 0.3s ease-in-out",i.style.opacity="0",i.style.transform="translateY(10px)",setTimeout(()=>{i.style.opacity="1",i.style.transform="translateY(0)"},50));const h=document.getElementById("cuisine-type-field"),m=document.getElementById("restaurant-name-field");d.type==="restaurant"?(h.classList.remove("hidden"),h.querySelector("select").setAttribute("required","required"),m.classList.remove("hidden"),m.querySelector("input").setAttribute("required","required")):(h.classList.add("hidden"),h.querySelector("select").removeAttribute("required"),m.classList.add("hidden"),m.querySelector("input").removeAttribute("required"))}},300),setTimeout(()=>Z(),500)}}Ee(),Be(),Ie(),Z(),setTimeout(()=>Z(),1e3),setTimeout(()=>Z(),2e3);const a=new MutationObserver(c=>{c.forEach(d=>{if(d.type==="attributes"&&d.attributeName==="class"){const l=d.target;(l.id==="product-customization-form"||l.id==="order-menu-customization-form")&&(l.classList.contains("hidden")||(console.log("👁️ Form became visible, auto-filling..."),setTimeout(()=>Z(),100)))}})}),n=document.getElementById("product-customization-form"),s=document.getElementById("order-menu-customization-form");n&&a.observe(n,{attributes:!0,attributeFilter:["class"]}),s&&a.observe(s,{attributes:!0,attributeFilter:["class"]}),$(),setTimeout(()=>$(),100),setTimeout(()=>$(),500),setTimeout(()=>$(),1e3),setTimeout(()=>$(),2e3),setTimeout(()=>{const c=new URLSearchParams(window.location.search),d=c.get("product"),l=c.get("price"),i=document.getElementById("recent-activity");!d||!l?i&&(i.style.display="block",i.classList.remove("hidden"),console.log("✅ Browse products section confirmed visible - no product selected")):i&&(i.style.display="none",console.log("✅ Browse products section confirmed hidden - product selected"))},1e3)});window.addEventListener("load",()=>{console.log("Window loaded - trying again"),$()});let le=0;const Se=5,Pe=setInterval(()=>{le++,console.log(`Attempt ${le} to load user data...`),$(),le>=Se&&(clearInterval(Pe),console.log("Max attempts reached"))},2e3);window.addEventListener("user-logged-in",()=>{console.log("User logged in event received in dashboard"),$()});window.addEventListener("user-logged-out",()=>{console.log("User logged out event received in dashboard"),$()});console.log("✅ Dashboard script initialized with global auth manager");const ne={400001:{city:"Mumbai",state:"Maharashtra"},400002:{city:"Mumbai",state:"Maharashtra"},400003:{city:"Mumbai",state:"Maharashtra"},400004:{city:"Mumbai",state:"Maharashtra"},400005:{city:"Mumbai",state:"Maharashtra"},400006:{city:"Mumbai",state:"Maharashtra"},400007:{city:"Mumbai",state:"Maharashtra"},400008:{city:"Mumbai",state:"Maharashtra"},400009:{city:"Mumbai",state:"Maharashtra"},400010:{city:"Mumbai",state:"Maharashtra"},110001:{city:"New Delhi",state:"Delhi"},110002:{city:"New Delhi",state:"Delhi"},110003:{city:"New Delhi",state:"Delhi"},110004:{city:"New Delhi",state:"Delhi"},110005:{city:"New Delhi",state:"Delhi"},110006:{city:"New Delhi",state:"Delhi"},110007:{city:"New Delhi",state:"Delhi"},110008:{city:"New Delhi",state:"Delhi"},110009:{city:"New Delhi",state:"Delhi"},110010:{city:"New Delhi",state:"Delhi"},560001:{city:"Bangalore",state:"Karnataka"},560002:{city:"Bangalore",state:"Karnataka"},560003:{city:"Bangalore",state:"Karnataka"},560004:{city:"Bangalore",state:"Karnataka"},560005:{city:"Bangalore",state:"Karnataka"},560006:{city:"Bangalore",state:"Karnataka"},560007:{city:"Bangalore",state:"Karnataka"},560008:{city:"Bangalore",state:"Karnataka"},560009:{city:"Bangalore",state:"Karnataka"},560010:{city:"Bangalore",state:"Karnataka"},600001:{city:"Chennai",state:"Tamil Nadu"},600002:{city:"Chennai",state:"Tamil Nadu"},600003:{city:"Chennai",state:"Tamil Nadu"},600004:{city:"Chennai",state:"Tamil Nadu"},600005:{city:"Chennai",state:"Tamil Nadu"},600006:{city:"Chennai",state:"Tamil Nadu"},600007:{city:"Chennai",state:"Tamil Nadu"},600008:{city:"Chennai",state:"Tamil Nadu"},600009:{city:"Chennai",state:"Tamil Nadu"},600010:{city:"Chennai",state:"Tamil Nadu"},700001:{city:"Kolkata",state:"West Bengal"},700002:{city:"Kolkata",state:"West Bengal"},700003:{city:"Kolkata",state:"West Bengal"},700004:{city:"Kolkata",state:"West Bengal"},700005:{city:"Kolkata",state:"West Bengal"},700006:{city:"Kolkata",state:"West Bengal"},700007:{city:"Kolkata",state:"West Bengal"},700008:{city:"Kolkata",state:"West Bengal"},700009:{city:"Kolkata",state:"West Bengal"},700010:{city:"Kolkata",state:"West Bengal"},380001:{city:"Ahmedabad",state:"Gujarat"},380002:{city:"Ahmedabad",state:"Gujarat"},380003:{city:"Ahmedabad",state:"Gujarat"},380004:{city:"Ahmedabad",state:"Gujarat"},380005:{city:"Ahmedabad",state:"Gujarat"},380006:{city:"Ahmedabad",state:"Gujarat"},380007:{city:"Ahmedabad",state:"Gujarat"},380008:{city:"Ahmedabad",state:"Gujarat"},380009:{city:"Ahmedabad",state:"Gujarat"},380010:{city:"Ahmedabad",state:"Gujarat"},411001:{city:"Pune",state:"Maharashtra"},411002:{city:"Pune",state:"Maharashtra"},411003:{city:"Pune",state:"Maharashtra"},411004:{city:"Pune",state:"Maharashtra"},411005:{city:"Pune",state:"Maharashtra"},411006:{city:"Pune",state:"Maharashtra"},411007:{city:"Pune",state:"Maharashtra"},411008:{city:"Pune",state:"Maharashtra"},411009:{city:"Pune",state:"Maharashtra"},411010:{city:"Pune",state:"Maharashtra"},302001:{city:"Jaipur",state:"Rajasthan"},302002:{city:"Jaipur",state:"Rajasthan"},302003:{city:"Jaipur",state:"Rajasthan"},302004:{city:"Jaipur",state:"Rajasthan"},302005:{city:"Jaipur",state:"Rajasthan"},302006:{city:"Jaipur",state:"Rajasthan"},302007:{city:"Jaipur",state:"Rajasthan"},302008:{city:"Jaipur",state:"Rajasthan"},302009:{city:"Jaipur",state:"Rajasthan"},302010:{city:"Jaipur",state:"Rajasthan"},641001:{city:"Coimbatore",state:"Tamil Nadu"},641002:{city:"Coimbatore",state:"Tamil Nadu"},641003:{city:"Coimbatore",state:"Tamil Nadu"},641004:{city:"Coimbatore",state:"Tamil Nadu"},641005:{city:"Coimbatore",state:"Tamil Nadu"},625001:{city:"Madurai",state:"Tamil Nadu"},625002:{city:"Madurai",state:"Tamil Nadu"},625003:{city:"Madurai",state:"Tamil Nadu"},625004:{city:"Madurai",state:"Tamil Nadu"},625005:{city:"Madurai",state:"Tamil Nadu"},570001:{city:"Mysore",state:"Karnataka"},570002:{city:"Mysore",state:"Karnataka"},570003:{city:"Mysore",state:"Karnataka"},570004:{city:"Mysore",state:"Karnataka"},570005:{city:"Mysore",state:"Karnataka"},580001:{city:"Hubli",state:"Karnataka"},580002:{city:"Hubli",state:"Karnataka"},580003:{city:"Hubli",state:"Karnataka"},580004:{city:"Hubli",state:"Karnataka"},580005:{city:"Hubli",state:"Karnataka"},500001:{city:"Hyderabad",state:"Telangana"},500002:{city:"Hyderabad",state:"Telangana"},500003:{city:"Hyderabad",state:"Telangana"},500004:{city:"Hyderabad",state:"Telangana"},500005:{city:"Hyderabad",state:"Telangana"},500006:{city:"Hyderabad",state:"Telangana"},500007:{city:"Hyderabad",state:"Telangana"},500008:{city:"Hyderabad",state:"Telangana"},500009:{city:"Hyderabad",state:"Telangana"},500010:{city:"Hyderabad",state:"Telangana"},110001:{city:"Delhi",state:"Delhi"},110002:{city:"Delhi",state:"Delhi"},110003:{city:"Delhi",state:"Delhi"},110004:{city:"Delhi",state:"Delhi"},110005:{city:"Delhi",state:"Delhi"},110006:{city:"Delhi",state:"Delhi"},110007:{city:"Delhi",state:"Delhi"},110008:{city:"Delhi",state:"Delhi"},110009:{city:"Delhi",state:"Delhi"},110010:{city:"Delhi",state:"Delhi"},560001:{city:"Bangalore",state:"Karnataka"},560002:{city:"Bangalore",state:"Karnataka"},560003:{city:"Bangalore",state:"Karnataka"},560004:{city:"Bangalore",state:"Karnataka"},560005:{city:"Bangalore",state:"Karnataka"},560006:{city:"Bangalore",state:"Karnataka"},560007:{city:"Bangalore",state:"Karnataka"},560008:{city:"Bangalore",state:"Karnataka"},560009:{city:"Bangalore",state:"Karnataka"},560010:{city:"Bangalore",state:"Karnataka"},600001:{city:"Chennai",state:"Tamil Nadu"},600002:{city:"Chennai",state:"Tamil Nadu"},600003:{city:"Chennai",state:"Tamil Nadu"},600004:{city:"Chennai",state:"Tamil Nadu"},600005:{city:"Chennai",state:"Tamil Nadu"},600006:{city:"Chennai",state:"Tamil Nadu"},600007:{city:"Chennai",state:"Tamil Nadu"},600008:{city:"Chennai",state:"Tamil Nadu"},600009:{city:"Chennai",state:"Tamil Nadu"},600010:{city:"Chennai",state:"Tamil Nadu"},700001:{city:"Kolkata",state:"West Bengal"},700002:{city:"Kolkata",state:"West Bengal"},700003:{city:"Kolkata",state:"West Bengal"},700004:{city:"Kolkata",state:"West Bengal"},700005:{city:"Kolkata",state:"West Bengal"},700006:{city:"Kolkata",state:"West Bengal"},700007:{city:"Kolkata",state:"West Bengal"},700008:{city:"Kolkata",state:"West Bengal"},700009:{city:"Kolkata",state:"West Bengal"},700010:{city:"Kolkata",state:"West Bengal"}};function J(){const e=document.getElementById("pincode-input"),t=document.getElementById("city-input"),o=document.getElementById("state-input"),r=document.getElementById("city-suggestions"),a=document.getElementById("state-suggestions");e&&t&&o&&(console.log("Initializing pincode autocomplete..."),e.addEventListener("input",function(){const n=this.value.trim();if(console.log("Pincode entered:",n),n.length===6&&ne[n]){console.log("Found pincode data:",ne[n]),t.value=ne[n].city,o.value=ne[n].state;const s=document.getElementById("country-select");s&&(s.value="India")}}),t.addEventListener("input",function(){const n=this.value.toLowerCase();if(n.length>0){const s=ae.filter(c=>c.toLowerCase().includes(n));ue(r,s,t)}else ee(r)}),o.addEventListener("input",function(){const n=this.value.toLowerCase();if(n.length>0){const s=re.filter(c=>c.toLowerCase().includes(n));ue(a,s,o)}else ee(a)}),document.addEventListener("click",function(n){!t.contains(n.target)&&!r.contains(n.target)&&ee(r),!o.contains(n.target)&&!a.contains(n.target)&&ee(a)}))}document.addEventListener("DOMContentLoaded",function(){J(),setTimeout(J,500),setTimeout(J,1e3),setTimeout(J,2e3)});setTimeout(J,3e3);setTimeout(J,5e3);function Me(){console.log("Reinitializing pincode autocomplete..."),J()}window.reinitializePincodeAutocomplete=Me;document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("test-save");e&&e.addEventListener("click",async function(){console.log("🧪 Test save button clicked!");const s=document.getElementById("requirements-form");if(s){const c=new FormData(s),d=Object.fromEntries(c);console.log("🧪 Test save - Form data:",d),await Ce(d)}else console.error("❌ Form not found for test save")});const t=document.getElementById("simple-test");t&&t.addEventListener("click",async function(){console.log("🔵 Simple test button clicked!"),alert("🔵 Simple test button works!");const s={project_name:"Simple Test Project",restaurant_name:"Simple Test Restaurant",owner_name:"Simple Test Owner",contact_person:"Simple Test Contact",email:"test@example.com",phone_number:"1234567890",house_flat_number:"123",address_line_1:"Test Address",city:"Test City",state:"Test State",pincode:"123456",country:"India",restaurant_logo_url:null,menu_photos_urls:[],additional_requirements:"Simple test requirements",base_package_cost:999,gst_amount:180,total_amount:1179,status:"pending",payment_status:"pending"};console.log("🔵 Simple test data:",s);try{const{data:c,error:d}=await window.supabase.from("order_customizations").insert(s).select();d?(console.error("❌ Simple test failed:",d),alert("❌ Simple test failed: "+d.message)):(console.log("✅ Simple test successful!",c),alert("✅ Simple test successful! Data saved to database."))}catch(c){console.error("❌ Simple test error:",c),alert("❌ Simple test error: "+c.message)}});function o(){const s=document.getElementById("requirements-form");return console.log("🔍 Form found:",!!s),console.log("🔍 Form element:",s),s?(console.log("✅ Form found, adding event listener..."),s.addEventListener("submit",async function(c){c.preventDefault(),console.log("🚀 FORCE FORM SUBMISSION TRIGGERED!"),alert("🚀 Form submission detected!");const d=new FormData(s),l=Object.fromEntries(d);console.log("🚀 Form data collected:",l);try{const i={project_name:l.projectName||"Manual Test Project",restaurant_name:l.restaurantName||"Manual Test Restaurant",owner_name:l.ownerName||"Manual Test Owner",contact_person:l.contactPerson||"Manual Test Contact",email:l.email||"manual@test.com",phone_number:l.phone||"1234567890",house_flat_number:l.houseNumber||"123",address_line_1:l.addressLine1||"Manual Test Address",city:l.city||"Manual Test City",state:l.state||"Manual Test State",pincode:l.pincode||"123456",country:l.country||"India",restaurant_logo_url:null,menu_photos_urls:[],additional_requirements:l.additionalRequirements||"Manual test requirements",base_package_cost:999,gst_amount:180,total_amount:1179,status:"pending",payment_status:"pending"};console.log("🚀 Insert data prepared:",i);const{data:g,error:h}=await window.supabase.from("order_customizations").insert(i).select();h?(console.error("❌ Force save failed:",h),alert("❌ Save failed: "+h.message)):(console.log("✅ Force save successful!",g),alert("✅ Data saved successfully to order_customizations table!"))}catch(i){console.error("❌ Force save error:",i),alert("❌ Save error: "+i.message)}}),!0):(console.log("⏳ Form not found yet, will retry..."),!1)}o()||setTimeout(()=>{console.log("🔄 Retrying form setup after 1 second..."),o()||setTimeout(()=>{console.log("🔄 Retrying form setup after 3 seconds..."),o()||setTimeout(()=>{console.log("🔄 Retrying form setup after 5 seconds..."),o()},5e3)},3e3)},1e3),document.addEventListener("submit",function(s){console.log("🌍 Global form submission detected!"),console.log("🌍 Form element:",s.target),console.log("🌍 Form ID:",s.target.id),s.target.id==="requirements-form"&&(console.log("🌍 Requirements form submitted globally!"),alert("🌍 Global form submission detected!"))}),console.log("🔍 Looking for save button...");const r=document.getElementById("order-menu-form");let a=null;if(r&&(console.log("🔍 Order menu form found:",r),a=r.querySelector('button[type="submit"]'),console.log("🔍 Save button in order menu form:",a)),!a){const s=document.querySelectorAll("button");console.log("🔍 All buttons found:",s.length);for(let c of s)if(c.textContent.includes("Save and Make Payment")&&r&&r.contains(c)){a=c,console.log("🔍 Found save button by text in order menu form:",a);break}}if(a){console.log("🔴 Save button found:",a);let s=!1;a.addEventListener("click",async function(c){if(console.log("🔴 Save button clicked directly!"),c.preventDefault(),s){console.log("⚠️ Save already in progress, ignoring duplicate click");return}s=!0;const d=document.getElementById("order-menu-form");if(!d){console.error("❌ Order menu form not found for save button"),alert("❌ Form not found!");return}const l=new FormData(d),i=Object.fromEntries(l);if(console.log("🔴 Save button - Form data:",i),Object.keys(i).length===0){console.error("❌ No form data found for save button"),alert("❌ No form data found! Please fill out the form first.");return}const g={project_name:i.projectName||"Save Button Project",restaurant_name:i.restaurantName||"Save Button Restaurant",owner_name:i.ownerName||"Save Button Owner",contact_person:i.contactPerson||"Save Button Contact",email:i.email||"save@button.com",phone_number:i.phone||"1234567890",house_flat_number:i.houseNumber||"123",address_line_1:i.addressLine1||"Save Button Address",city:i.city||"Save Button City",state:i.state||"Save Button State",pincode:i.pincode||"123456",country:i.country||"India",restaurant_logo_url:null,menu_photos_urls:[],additional_requirements:i.additionalRequirements||"Save button requirements",base_package_cost:999,gst_amount:180,total_amount:1179,status:"pending",payment_status:"pending"};console.log("🔴 Save button - Insert data:",g);try{console.log("🔴 Save button - Saving to Supabase...");const{supabase:h}=await Y(async()=>{const{supabase:S}=await import("./supabase.DO6XXPT9.js");return{supabase:S}},__vite__mapDeps([0,1]));if(!h){console.error("❌ Supabase client not available"),alert("❌ Form submission error: Supabase client not loaded. Please refresh the page and try again.");return}const{data:m,error:b}=await h.from("order_customizations").insert(g).select();if(b)console.error("❌ Save button save failed:",b),alert("❌ Form submission failed: "+b.message);else{console.log("✅ Save button save successful!",m),d.reset();const S=d.querySelector('input[name="restaurantLogo"]'),x=d.querySelector('input[name="menuPhotos"]');S&&(S.value="",console.log("✅ Logo input cleared")),x&&(x.value="",console.log("✅ Menu photos input cleared"));const z=document.getElementById("order-menu-logo-preview"),M=document.getElementById("order-menu-logo-preview-img"),C=document.getElementById("order-menu-logo-filename"),j=document.getElementById("menu-photos-preview"),G=document.getElementById("menu-photos-grid");z&&(z.classList.add("hidden"),console.log("✅ Order menu logo preview hidden")),M&&(M.src="",console.log("✅ Order menu logo preview image cleared")),C&&(C.textContent="",console.log("✅ Order menu logo filename cleared")),j&&(j.classList.add("hidden"),console.log("✅ Menu photos preview hidden")),G&&(G.innerHTML="",console.log("✅ Menu photos grid cleared"));const V=document.getElementById("order-menu-logo-upload-area"),W=document.getElementById("menu-photos-upload-area");V&&(V.innerHTML=`
                <div class="flex flex-col items-center">
                  <svg class="w-12 h-12 text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                  </svg>
                  <p class="text-gray-600 mb-2">Click to upload logo</p>
                  <p class="text-sm text-gray-500">PNG, JPG, GIF up to 10MB</p>
                </div>
              `,console.log("✅ Logo upload area reset to original state")),W&&(W.innerHTML=`
                <div class="flex flex-col items-center">
                  <svg class="w-16 h-16 text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                  </svg>
                  <p class="text-gray-600 mb-2">Click to upload photos</p>
                  <p class="text-sm text-gray-500">PNG, JPG, GIF up to 5MB each</p>
                </div>
              `,console.log("✅ Menu photos upload area reset to original state")),typeof E<"u"&&(E=[],console.log("✅ Menu photos array cleared")),alert("✅ Form submitted successfully!"),setTimeout(()=>{ce()},1e3)}}catch(h){console.error("❌ Save button save error:",h),alert("❌ Form submission error: "+h.message)}finally{s=!1}})}else console.error("❌ Save button not found!");const n=document.getElementById("direct-save");n&&n.addEventListener("click",async function(){console.log("🔴 Direct save button clicked!"),alert("🔴 Direct save button clicked!");const s=document.getElementById("requirements-form");if(console.log("🔴 Direct save - Form found:",!!s),!s){console.error("❌ Form not found for direct save"),alert("❌ Form not found! Please make sure the form is visible.");const i=document.querySelectorAll("form");console.log("🔴 All forms on page:",i),console.log("🔴 Form IDs:",Array.from(i).map(g=>g.id));return}const c=new FormData(s),d=Object.fromEntries(c);console.log("🔴 Direct save - Form data:",d);const l={project_name:d.projectName||"Direct Save Project",restaurant_name:d.restaurantName||"Direct Save Restaurant",owner_name:d.ownerName||"Direct Save Owner",contact_person:d.contactPerson||"Direct Save Contact",email:d.email||"direct@save.com",phone_number:d.phone||"1234567890",house_flat_number:d.houseNumber||"123",address_line_1:d.addressLine1||"Direct Save Address",city:d.city||"Direct Save City",state:d.state||"Direct Save State",pincode:d.pincode||"123456",country:d.country||"India",restaurant_logo_url:null,menu_photos_urls:[],additional_requirements:d.additionalRequirements||"Direct save requirements",base_package_cost:999,gst_amount:180,total_amount:1179,status:"pending",payment_status:"pending"};console.log("🔴 Direct save - Insert data:",l);try{const{data:i,error:g}=await window.supabase.from("order_customizations").insert(l).select();g?(console.error("❌ Direct save failed:",g),alert("❌ Direct save failed: "+g.message)):(console.log("✅ Direct save successful!",i),alert("✅ Direct save successful! Data saved to database."))}catch(i){console.error("❌ Direct save error:",i),alert("❌ Direct save error: "+i.message)}})});function ue(e,t,o){if(t.length===0){ee(e);return}e.innerHTML="",t.slice(0,5).forEach(r=>{const a=document.createElement("div");a.className="px-4 py-2 hover:bg-gray-100 cursor-pointer border-b border-gray-200",a.textContent=r,a.addEventListener("click",function(){o.value=r,ee(e)}),e.appendChild(a)}),e.classList.remove("hidden"),e.style.position="absolute",e.style.zIndex="10",e.style.width=o.offsetWidth+"px",e.style.top=o.offsetTop+o.offsetHeight+"px",e.style.left=o.offsetLeft+"px"}function ee(e){e.classList.add("hidden")}async function Ce(e){try{console.log("🧪 Starting direct save test..."),console.log("🧪 Form data received:",e),console.log("🧪 Form data keys:",Object.keys(e)),console.log("🧪 Form data values:",Object.values(e));const o=(window.globalAuthManager||window.simpleAuthManager)?.getCurrentUser();if(console.log("🧪 Current user:",o),!o){console.error("❌ No user found for direct save test");return}if(!window.supabase){console.error("❌ Supabase not available for direct save test"),alert("❌ Supabase not available! Check console for details.");return}console.log("🧪 Testing Supabase connection...");try{const{data:s,error:c}=await window.supabase.from("order_customizations").select("count").limit(1);if(c){console.error("❌ Supabase connection test failed:",c),alert("❌ Supabase connection failed: "+c.message);return}else console.log("✅ Supabase connection test successful")}catch(s){console.error("❌ Supabase connection error:",s),alert("❌ Supabase connection error: "+s.message);return}const r={project_name:e.projectName||"Test Project",restaurant_name:e.restaurantName||"Test Restaurant",owner_name:e.ownerName||"Test Owner",contact_person:e.contactPerson||"Test Contact",email:e.email||o.email,phone_number:e.phone||"1234567890",house_flat_number:e.houseNumber||"123",address_line_1:e.addressLine1||"Test Address",city:e.city||"Test City",state:e.state||"Test State",pincode:e.pincode||"123456",country:e.country||"India",restaurant_logo_url:null,menu_photos_urls:[],additional_requirements:e.additionalRequirements||"Test requirements",base_package_cost:999,gst_amount:180,total_amount:1179,status:"pending",payment_status:"pending"};console.log("🧪 Insert data prepared:",r);const{data:a,error:n}=await window.supabase.from("order_customizations").insert(r).select();n?(console.error("❌ Direct save test failed:",n),console.error("❌ Error details:",JSON.stringify(n,null,2))):(console.log("✅ Direct save test successful!",a),alert("✅ Data saved successfully to order_customizations table!"))}catch(t){console.error("❌ Direct save test error:",t)}}
