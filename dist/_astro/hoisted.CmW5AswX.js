import"./Footer.astro_astro_type_script_index_0_lang.BdsyaBYv.js";import"https://unpkg.com/@supabase/supabase-js@2";console.log("Test fix page loaded");function e(t){const o=document.getElementById("console-logs");if(o){const a=document.createElement("p");a.textContent=`[${new Date().toLocaleTimeString()}] ${t}`,o.appendChild(a),o.scrollTop=o.scrollHeight}}function s(){const t=document.getElementById("status-text"),o=document.getElementById("user-info"),a=document.getElementById("session-storage"),i=document.getElementById("local-storage"),l=window.globalAuthManager||window.simpleAuthManager;if(l)if(l.isUserLoggedIn()){const d=l.getCurrentUser();t.textContent="✅ Authenticated",o.textContent=d?`${d.email} (${d.full_name||"No name"})`:"User data missing";try{const n=window.sessionStorage.getItem("simple-auth-session");if(n){const r=JSON.parse(n);a.textContent=`Active (${new Date(r.timestamp).toLocaleString()})`}else a.textContent="No session data"}catch(n){a.textContent="Session error: "+n.message}try{const n=window.localStorage.getItem("simple-auth-user");if(n){const r=JSON.parse(n);i.textContent=`Active (${r.email})`}else i.textContent="No local data"}catch(n){i.textContent="Local error: "+n.message}}else t.textContent="❌ Not authenticated",o.textContent="No user logged in",a.textContent="No active session",i.textContent="No local data";else t.textContent="⚠️ Auth manager not available",o.textContent="Manager not loaded",a.textContent="Manager not loaded",i.textContent="Manager not loaded"}document.getElementById("check-auth-btn")?.addEventListener("click",()=>{e("Checking authentication..."),s(),e("Authentication check complete")});document.getElementById("test-login-btn")?.addEventListener("click",()=>{e("Testing login event...");const t={id:"test-user-123",email:"test@example.com",full_name:"Test User",phone:"123-456-7890",company_name:"Test Company",role:"customer"};window.dispatchEvent(new CustomEvent("user-logged-in",{detail:t})),e("Login event triggered for: "+t.email),setTimeout(()=>{s(),e("Status updated after login event")},100)});document.getElementById("test-profile-update-btn")?.addEventListener("click",()=>{e("Testing profile update...");const t=window.globalAuthManager||window.simpleAuthManager;t&&t.isUserLoggedIn()?(t.updateProfile({full_name:"Updated Test User",phone:"987-654-3210",company_name:"Updated Company"}),e("Profile update triggered"),setTimeout(()=>{s(),e("Status updated after profile update")},100)):e("Cannot test profile update - user not logged in")});document.getElementById("clear-session-btn")?.addEventListener("click",()=>{e("Clearing session..."),window.sessionStorage.removeItem("simple-auth-session"),window.localStorage.removeItem("simple-auth-user"),e("Session cleared from storage"),s()});document.addEventListener("DOMContentLoaded",()=>{e("Page loaded, checking authentication..."),setTimeout(()=>{s(),e("Initial authentication check complete")},500)});window.addEventListener("user-logged-in",t=>{e("User logged in event received: "+t.detail.email),s()});window.addEventListener("user-logged-out",()=>{e("User logged out event received"),s()});e("Test fix page script initialized");
