<!DOCTYPE html>
<html>
<head>
    <title>Test Database Connection</title>
</head>
<body>
    <h1>Test Supabase Database Connection</h1>
    <button onclick="testConnection()">Test Connection</button>
    <div id="result"></div>

    <script type="module">
        import { createClient } from 'https://cdn.skypack.dev/@supabase/supabase-js@2';
        
        const SUPABASE_URL = 'https://lmrrdcaavwwletcjcpqv.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxtcnJkY2Fhdnd3bGV0Y2pjcHF2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU1MDQ0ODgsImV4cCI6MjA3MTA4MDQ4OH0.AU59Qfr6K9i880Gcn5y-3pjCf8PXsDIq4OI0-lPQVuQ';
        
        const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        
        window.testConnection = async function() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = 'Testing connection...';
            
            try {
                // Test 1: Check if table exists
                const { data, error } = await supabase
                    .from('customization_forms')
                    .select('count')
                    .limit(1);
                
                if (error) {
                    resultDiv.innerHTML = `
                        <h3 style="color: red;">❌ Error: ${error.message}</h3>
                        <p><strong>Solution:</strong> Run the SQL schema in Supabase dashboard first!</p>
                        <p>Go to: Supabase Dashboard → SQL Editor → Copy/paste customization_forms_complete_schema.sql → Run</p>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <h3 style="color: green;">✅ Database connection successful!</h3>
                        <p>Table 'customization_forms' exists and is accessible.</p>
                        <p>Your form should now save to Supabase instead of localStorage.</p>
                    `;
                }
            } catch (err) {
                resultDiv.innerHTML = `
                    <h3 style="color: red;">❌ Connection failed: ${err.message}</h3>
                    <p>Check your internet connection and Supabase configuration.</p>
                `;
            }
        };
    </script>
</body>
</html>
